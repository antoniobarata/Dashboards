{
    "DashboardDefinitionRoles": [],
    "Id": "68ffccfb-8fed-45b2-a4ea-5e1d895fb649",
    "Name": "Proofing",
    "Active": true,
    "Location": 1,
    "DocumentId": "00000000-0000-0000-0000-000000000000",
    "DocumentName": "",
    "DocumentTypeName": "project",
    "DocumentsConfiguration": "[{\"entity\":\"\",\"operations\":{\"read\":{\"endpoint\":\"\"},\"update\":{\"endpoint\":\"\",\"model\":{}},\"create\":{\"endpoint\":\"\",\"model\":{}},\"patch\":{\"endpoint\":\"\",\"model\":[{\"field\":\"\",\"caption\":\"\",\"type\":\"\"}]},\"remove\":{\"endpoint\":\"\"},\"lookup\":{\"endpoint\":\"\"},\"lookupById\":{\"endpoint\":\"\"}},\"layout\":{\"create\":{},\"read\":{},\"patch\":{}},\"customDocument\":{\"useCustomStyle\":false,\"mainColor\":\"\",\"secondaryColor\":\"\",\"imageClass\":\"\",\"namePlural\":\"\",\"name\":\"\",\"systemName\":\"\"},\"availableOptions\":{\"feed\":false,\"info\":true,\"files\":false,\"userfields\":false,\"workspaces\":false},\"fields\":[]}]",
    "Templates": [],
    "DashboardDefinitionComponents": [
        {
            "Id": "3d5a6412-8a08-4b8a-88ea-07c16ea4a485",
            "Name": "",
            "Active": true,
            "UseQuery": false,
            "Query": "",
            "Size": 12,
            "Order": 0,
            "Parameters": "[{\"WidgetSubTitle\":\"\",\"WidgetType\":\"grid\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"\",\"WidgetFrameStyle\":{},\"WidgetXPosition\":0,\"WidgetYPosition\":0,\"WidgetRows\":24,\"WidgetColumns\":48,\"WidgetHeader\":{\"showTitle\":false,\"showSubTitle\":false,\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[]},\"WidgetPeriodChooser\":{\"visible\":false,\"type\":\"\",\"startDate\":null,\"endDate\":null}},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"select \\n        dj.Oid as oid,\\n        dj.Number as [number],\\n        dj.Name as [name],\\n        FORMAT(dj.EndDateAndTime, 'dd MMMM yyyy, HH:mm') as endDateAndTime,\\n        ISNULL(dj.StateTypeColor, dj.StateColor) as statusColor,\\n        dj.state as status\\n\\n        \\nfrom Deliverable d, Analytics.DatamartJob dj\\n\\nwhere dj.ProjectId = @ProjectId \\nand d.Oid = dj.Oid\\nand dj.Number != ''\\nand dj.state != 'Canceled'\\nand d.IsDeliverable = 1\\norder by dj.Number asc\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"PreviousPeriod\":{\"Show\":false,\"KeyFieldName\":\"\",\"Type\":0},\"RequiredFilters\":[]}}]",
            "DashboardComponentType": {
                "Id": "be9c4895-90b8-4755-9054-caa7770b6a09",
                "Name": "Generic Dashboard",
                "ComponentTypeNumber": 42
            },
            "AnalyticsApiUrl": "",
            "Configuration": "{\"columns\":[{\"caption\":\"Status\",\"dataField\":\"status\",\"visible\":true,\"groupCellTemplate\":\"function(e, i) {  var color=i.component.option().dataSource.find(row=> row.status==i.text).statusColor;       var h=document.createElement('span');        h.style.backgroundColor = color;         h.classList.add('documentStageColor');        e.append(h);        h=document.createElement('span');    var ht=' ' + i.text + ' ('+i.summaryItems[0].value+')';         h.innerHTML = ht;        e.append(h);}\",\"cellTemplate\":\"function template(itemElement, rowInfo){     SW.showStage(itemElement, rowInfo.data.statusColor, rowInfo.data.status, true)}\"},{\"caption\":\"Name\",\"dataField\":\"name\",\"visible\":true},{\"caption\":\"Number\",\"dataField\":\"number\",\"visible\":true},{\"caption\":\"End Date\",\"dataField\":\"endDateAndTime\",\"visible\":true},{\"caption\":\"Deliverable\",\"dataField\":\"oid\",\"visible\":false,\"cellTemplate\":\"function rowTemplate(itemElement, rowInfo){                    var itemData = rowInfo.data;                   SW.setAttribute(itemElement,            null, 'style', 'height: 50px;width: 100%;', false);    var h = document.createElement('div');    SW.setAttribute(h,            null, 'style', 'font-size: 12px;font-weight: 600;width: calc(100% - 41px);float: left;margin-top: 4px;', false);        var h1 = document.createElement('span');    SW.setAttribute(h1,            null, 'class', 'ellipsis', false);    SW.setAttribute(h1,            null, 'style', 'float: left;width: 60%;', false);    var h2 = document.createElement('span');    SW.setAttribute(h2,            null, 'class', 'ellipsis', false);    SW.setAttribute(h2,            null, 'style', 'float: right;width: 33%;text-align: right;margin-right: 10px;', false);        h.append(h1);    h.append(h2);    itemElement.append(h);    h1.textContent = itemData.name;    h2.textContent = itemData.number;    var j = document.createElement('div');    SW.setAttribute(j,            null, 'style', 'font-size: 11px;font-weight: 300;width: calc(100% - 41px);float: left;', false);       var j1 = document.createElement('div');    var j2 = document.createElement('span');    SW.setAttribute(j1,            null, 'style', 'margin-left: -3px;float: left;', false);    SW.setAttribute(j2,            null, 'style', 'float: right;width: 33%;text-align: right;margin-right: 10px;', false);    SW.setAttribute(j2,            null, 'class', 'ellipsis', false);        j.append(j1);    j.append(j2);    itemElement.append(j);    j2.textContent = itemData.endDateAndTime;    var j1_1 = document.createElement('span');    SW.setAttribute(j1_1,            null, 'class', 'documentStageColor', false);    SW.setAttribute(j1_1,            null, 'style', 'background-color:'+itemData.statusColor, false);    var j1_2 = document.createElement('span');        SW.setAttribute(j1_2,            null, 'class', 'documentStageName', false);    SW.setAttribute(j1_2,            null, 'style', 'margin-left: 0px; color:'+itemData.statusColor, false);    j1.append(j1_1);    j1.append(j1_2);    j1_2.textContent = itemData.status;    }\"}],\"focusStateEnabled\":false,\"hoverStateEnabled\":false,\"masterDetail\":{\"template\":\"function template(itemEl, detailInfo){\\n\\n    var itemData = detailInfo.data;\\n    var itemElement = document.createElement('div');\\n    SW.setAttribute(itemElement, null, 'style', 'display:flex;  overflow: auto;', false);\\n\\n    itemEl.append(itemElement);\\n\\n    getJobIdProofs(itemData.number);\\n    async function getJobIdProofs(jobNumber) {\\n        // Automation workflow id to Ziflow - Get proofs\\n        let response = await SW.executeAPI('POST', 'integration-workflows/866157ff-a54e-4da4-b345-d6e0a977379f/execute', null, '{\\\\\\\"jobNumber\\\\\\\":\\\\\\\"' + jobNumber + '\\\\\\\"}');\\n        var proofs = response.proofs;\\n        if (proofs.length > 0) {\\n            return proofs.forEach(p => getTileItem(p));\\n        }\\n        else {\\n\\n            var h = document.createElement('div');\\n            itemElement.append(h);\\n            h.textContent = 'No proofs to be shown.'\\n\\n        }\\n    }\\n\\n    function getTileItem(itemData) {\\n\\n\\n        if (itemData != null) {\\n\\n            var h = document.createElement('div');\\n            itemElement.append(h);\\n            SW.setAttribute(h, null, 'class', 'file-container', false);\\n            SW.setAttribute(h, null, 'style', 'text-align: center;width: 135px; margin-right: 20px;', false);\\n\\n            var h1 = document.createElement('div');\\n            h.append(h1);\\n\\n            SW.saveComponent(itemData,'proofData');\\n            h1.proofId = itemData.id;\\n            h1.stageId = itemData.stages[0].id;\\n\\n            var userEmail = SW.getComponent('userEmail');\\n\\n            if (!userEmail) {\\n                if (itemElement.textContent == ''){\\n                    itemElement.textContent = 'Your e-mail is currently missing. Please complete your profile to preview proofs.'\\n              }\\n                return SW.Toastr.toastr_Error('Your e-mail is currently missing. Please complete your profile to preview proofs.') }\\n            \\n            // Automation workflow id to Ziflow - Get One Time Url\\n            SW.executeAPI('POST', 'integration-workflows/e2721d86-82d4-4b04-9be2-afb9b5570eca/execute', null, '{\\\\\\\"stageId\\\\\\\":\\\\\\\"' + itemData.stages[0].id + '\\\\\\\",\\\\\\\"email\\\\\\\":\\\\\\\"' + userEmail + '\\\\\\\", \\\\\\\"proofId\\\\\\\":\\\\\\\"' + itemData.id + '\\\\\\\"}').then(x => { \\n                h1.proofLink = x.public_link;            \\n            });\\n\\n            h1.onclick = function (e) {\\n               \\n                var proofLink = this.proofLink; \\n                var proof = proofLink;\\n                var id = 'b70e1a00-3f43-45ab-bb04-04ba1e34e254';\\n                SW.genericPopup('automation', [{ Id: id, Title: 'Proofing' }], proof, '90%', '90%', false);\\n            };\\n            h1.oncontextmenu = function (e) {\\n                var proofId = this.proofId;\\n                var userEmail = SW.getComponent('userEmail');\\n                var stageId = this.stageId;\\n\\n                if (!userEmail){return SW.Toastr.toastr_Error('Your e-mail is currently missing. Please complete your profile before request an One Time URL.')}\\n                SW.Toastr.toastr_Info('Generating One Time URL'); \\n                // Automation workflow id to Ziflow - Get One Time Url\\n               SW.executeAPI('POST', 'integration-workflows/e2721d86-82d4-4b04-9be2-afb9b5570eca/execute', null, '{\\\\\\\"stageId\\\\\\\":\\\\\\\"' + stageId + '\\\\\\\",\\\\\\\"email\\\\\\\":\\\\\\\"' + userEmail+'\\\\\\\", \\\\\\\"proofId\\\\\\\":\\\\\\\"' + proofId + '\\\\\\\"}').then(x => {\\n                    if (x.status != null && x.status != 200) {\\n                        SW.Toastr.toastr_Error(x.error + ' - ' + x.message)\\n                    }\\n                    else {\\n\\n                        var aux = document.createElement(\\\"textarea\\\");\\n                        document.body.appendChild(aux);\\n                        aux.value = x.proof_url;\\n                        aux.select();\\n                        document.execCommand(\\\"copy\\\");\\n                        document.body.removeChild(aux);\\n                        SW.Toastr.toastr_Success('One-Time URL copied successfully.')\\n                    }\\n                });\\n            }\\n            SW.setAttribute(h1, null, 'style', 'background-color: #e0e0e0; border-radius: 4px; height:100px; display: flex; align-items : center; justify-content: center;', false);\\n            var g1 = document.createElement('div');\\n\\n            h.append(g1);\\n            SW.setAttribute(g1, null, 'style', 'color: #acacac; text-align: left;', false);\\n            SW.setAttribute(g1, null, 'class', 'ellipsis', false);\\n            g1.innerHTML = itemData.name;\\n            var h2 = document.createElement('img');\\n            h2.src = itemData.thumbnail_link;\\n            h1.appendChild(h2);\\n            SW.setAttribute(h2, null, 'style', 'max-width: 100%;max-height:100%', false);\\n            var j1 = document.createElement('div');\\n            SW.setAttribute(j1, null, 'style', 'display: flex; justify-content: space-between;', false);\\n            h.append(j1);\\n            var j3 = document.createElement('div');\\n            j1.append(j3);\\n            j3.innerHTML = 'v' + itemData.version;\\n            SW.setAttribute(j3, null, 'style', 'color: #acacac;', false);\\n\\n            var j4 = document.createElement('div');\\n            j1.append(j4);\\n            SW.setAttribute(j4, null, 'style', 'display:flex', false);\\n            SW.setAttribute(j4, null, 'id', 'image-thumbnail', false);\\n            var jh1 = document.createElement('div');\\n            j4.append(jh1);\\n            var jh2 = document.createElement('div');\\n            j4.append(jh2);\\n            SW.setAttribute(jh2, null, 'style', 'margin: -2px 0px 0px 5px;', false);\\n            var jh3 = document.createElement('span');\\n            SW.setAttribute(jh3, null, 'style', 'margin: -2px 0px 0px 5px;', false);\\n            if (itemData.decision_status == 'approved_with_changes') {\\n                h2.innerHTML = ' Approved with changes';\\n                SW.setAttribute(jh1, null, 'class', 'fa fa-check-circle text-success', false);\\n            } else {\\n                if (itemData.status == 'in_progress') {\\n                    jh2.innerHTML = ' In Progress';\\n                    SW.setAttribute(jh1, null, 'class', 'fa fa-clock-o text-warning', false);\\n                }\\n                if (itemData.status == 'completed') {\\n                    jh2.innerHTML = ' Completed';\\n                    SW.setAttribute(jh1, null, 'class', 'fa fa-flag-checkered', false);\\n                }\\n            }\\n            var a = itemData.stages;\\n            a.forEach(function (entry) {\\n                var deadline = '';\\n                if (entry.deadline != null && new Date(entry.deadline) < new Date() && deadline == '') {\\n\\n                    deadline = entry.deadline;\\n                    jh3.innerHTML = 'LATE';\\n                    SW.setAttribute(jh3, null, 'class', 'module-tags module-tags-dot module-tags-text', false);\\n                    SW.setAttribute(jh3, null, 'style', 'margin: -8px 0px 0px 5px;background: #FF605C;', false)\\n                }\\n            });\\n            var j5 = document.createElement('span');\\n            j1.append(j5);\\n\\n        };\\n    }\\n\\n}\",\"enabled\":\"true\"},\"selection\":{\"mode\":\"none\"},\"height\":\"100%\",\"summary\":{\"groupItems\":[{\"column\":\"Name\",\"summaryType\":\"count\",\"valueFormat\":\"#,##0\",\"displayFormat\":\"{0}\",\"alignment\":\"left\"}]},\"stateStoring\":{\"enabled\":false},\"onContentReady\":\"function() {\\n    var user = SW.executeAPI('GET', 'users/' + SW.getCurrentUserInfo().currentUserId).then(u => {if (u.Mail) {SW.saveComponent(u.Mail, 'userEmail')}});\\n}\"}",
            "DashboardDefinitionId": "68ffccfb-8fed-45b2-a4ea-5e1d895fb649"
        }
    ],
    "QueryText": "",
    "UseStore": false,
    "StoreEntity": null,
    "Version": 3,
    "Default": false
}
