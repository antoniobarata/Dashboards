{
  "DashboardDefinitionRoles": [],
  "Id": "0b10195f-3434-40d3-8126-d4f267a55a9d",
  "Name": "Rentabilidade",
  "Active": true,
  "Location": 0,
  "DocumentId": "00000000-0000-0000-0000-000000000000",
  "DocumentName": "",
  "DocumentTypeName": null,
  "DocumentsConfiguration": "{\n    \"entity\": \"\",\n    \"operations\": {\n        \"read\": {\n            \"endpoint\": \"\"\n        },\n        \"update\": {\n            \"endpoint\": \"\",\n            \"model\": {}\n        },\n        \"create\": {\n            \"endpoint\": \"\",\n            \"model\": {}\n        },\n        \"patch\": {\n            \"endpoint\": \"\",\n            \"model\": [\n                {\n                    \"field\": \"\",\n                    \"caption\": \"\",\n                    \"type\": \"\"\n                }\n            ]\n        },\n        \"remove\": {\n            \"endpoint\": \"\"\n        },\n        \"lookup\": {\n            \"endpoint\": \"\"\n        },\n        \"lookupById\": {\n            \"endpoint\": \"\"\n        }\n    },\n    \"layout\": {\n        \"create\": {},\n        \"read\": {},\n        \"patch\": {}\n    },\n    \"customDocument\": {\n        \"useCustomStyle\": false,\n        \"mainColor\": \"\",\n        \"secondaryColor\": \"\",\n        \"imageClass\": \"\",\n        \"namePlural\": \"\",\n        \"name\": \"\",\n        \"systemName\": \"\"\n    },\n    \"availableOptions\": {\n        \"feed\": false,\n        \"info\": true,\n        \"files\": false,\n        \"userfields\": false,\n        \"dashboard\": false\n    }\n}",
  "Templates": [

  ],
  "DashboardDefinitionComponents": [
    {
      "Id": "6c789cd6-2717-4022-a1e0-c0581552b072",
      "Name": "Month",
      "Active": true,
      "UseQuery": false,
      "Query": "",
      "Size": 12,
      "Order": 0,
      "Parameters": "[{\"WidgetSubTitle\":\"Closed and In Progress Tickets\",\"WidgetType\":\"rangeselector\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#e0e0e0\",\"WidgetFrameStyle\":{},\"WidgetXPosition\":0,\"WidgetYPosition\":0,\"WidgetRows\":3,\"WidgetColumns\":48,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"startDate\":\"2019/11/01\",\"endDate\":\"2019/12/30\",\"type\":\"year\",\"visible\":false},\"showSubTitle\":false,\"showTitle\":false},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"select\\tmin(bil.Date) as Week,\\n\\t\\tsum(elg.ValueWithoutVatIncome) as Billed,\\n\\t\\tsum(iif(sup.Company is not null, elg.ValueWithoutVatCost, 0)) as PurchasedInternal,\\n\\t\\tsum(iif(sup.Company is null, elg.ValueWithoutVatCost, 0)) as PurchasedExternal,\\n\\t\\tsum(elg.ValueWithoutVatIncome - elg.ValueWithoutVatCost) as Margin\\nfrom\\tEstimateLog elg, Bill bil, Supplier sup\\nwhere\\tbil.Oid = elg.Bill and\\n\\t\\tsup.Oid = elg.SupplierCost\\ngroup by datepart(year, bil.Date),\\n        datepart(week, bil.Date)\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":null}]",
      "DashboardComponentType": {
        "Id": "a31684a8-554d-4182-82f4-03fadda0c7b6",
        "Name": "Generic Dashboard",
        "ComponentTypeNumber": 42
      },
      "AnalyticsApiUrl": "",
      "Configuration": "{\n    \"onDrawn\": \"function(s) {        var today = new Date();        var month = new Date(today.getFullYear(), today.getMonth(), 1);        var nextMonth = new Date(today.getFullYear(), today.getMonth() + 1, 1);         month.setHours(0,    0,    0,    0);        nextMonth.setHours(23,    59,    59,    0);        s.component.option('value',    [month, nextMonth]);}\",\n    \"size\": {\n        \"height\": 70\n    },\n    \"containerBackgroundColor\": \"#e0e0e0\",\n    \"selectedRangeColor\": \"#f5564a\",\n    \"chart\": {\n        \"commonSeriesSettings\": {\n            \"argumentField\": \"Week\"\n        },\n        \"series\": [\n            {\n                \"valueField\": \"Billed\",\n                \"color\": \"green\",\n                \"type\": \"area\"\n            },\n            {\n                \"valueField\": \"PurchasedExternal\",\n                \"color\": \"red\",\n                \"type\": \"area\"\n            },\n            {\n                \"valueField\": \"Margin\",\n                \"color\": \"orange\",\n                \"type\": \"line\"\n            }\n        ]\n    },\n    \"scale\": {\n        \"minorTickInterval\": \"week\",\n        \"tickInterval\": \"month\",\n        \"valueType\": \"datetime\",\n        \"marker\": {\n            \"separatorHeight\": 10,\n            \"textTopIndent\": 0,\n            \"topIndent\": 0\n        }\n    },\n    \"sliderMarker\": {\n        \"format\": \"monthAndDay\",\n        \"color\": \"#da5859\",\n        \"font\": {\n            \"family\": \"Varela Round\",\n            \"weight\": 800\n        }\n    },\n    \"value\": {\n        \"length\": {\n            \"weeks\": 1\n        }\n    }\n}",
      "DashboardDefinitionId": "0b10195f-3434-40d3-8126-d4f267a55a9d"
    },
    {
      "Id": "f3f77b00-64a2-49f7-bd65-c6cd1167dae7",
      "Name": "Rentabilidade",
      "Active": true,
      "UseQuery": false,
      "Query": null,
      "Size": 12,
      "Order": 5,
      "Parameters": "[{\"WidgetSubTitle\":\"\",\"WidgetType\":\"grid\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"\",\"WidgetFrameStyle\":{},\"WidgetXPosition\":0,\"WidgetYPosition\":3,\"WidgetRows\":33,\"WidgetColumns\":48,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":true,\"metricName\":\"# Delayed Under Development\",\"metricFieldValue\":\"DelayedUnderDevelopmentJobsGrandTotal\"}]},\"showSubTitle\":false,\"showTitle\":false},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"with\\tt as \\n\\t\\t(\\n\\t\\tselect\\tbil.Company,\\n\\t\\t\\t\\tbil.Client,\\n                bil.Contract,\\n                bil.Project,\\n\\t\\t\\t\\tsum(bil.ValueWithoutVat) as Billed,\\n\\t\\t\\t\\tmax(est.ValueWithoutVatIncome) as Estimated,\\n\\t\\t\\t\\t0 as PurchasedInternal,\\n\\t\\t\\t\\t0 as PurchasedResources,\\n\\t\\t\\t\\t0 as PurchasedThirdParty\\n\\t\\tfrom\\tBill bil,\\n                Estimate est\\n\\t\\twhere\\test.Oid = bil.Estimate and\\n                bil.[External] is not null and\\n\\t\\t\\t\\tbil.Date between @FromDate and @ToDate\\n        group by bil.Company, bil.Client, bil.Contract, bil.Project, est.Oid\\n\\t\\tunion all\\n\\t\\tselect\\tbil.Company,\\n\\t\\t\\t\\tbil.Client,\\n                bil.Contract,\\n                bil.Project,\\n\\t\\t\\t\\t0 as Billed,\\n\\t\\t\\t\\t0 as Estimated,\\n\\t\\t\\t\\tsum(iif(eid.Type = 0 and sup.Company is not null, iif(est.ValueWithoutVatIncome != 0, bil.ValueWithoutVat / est.ValueWithoutVatIncome, 0) * eid.ValueWithoutVatCost, 0)) as PurchasedInternal,\\n\\t\\t\\t\\tsum(iif(eid.Type = 2, iif(est.ValueWithoutVatIncome != 0, bil.ValueWithoutVat / est.ValueWithoutVatIncome, 0) * eid.ValueWithoutVatCost, 0)) as PurchasedResources,\\n\\t\\t\\t\\tsum(iif(eid.Type = 0 and sup.Company is null, iif(est.ValueWithoutVatIncome != 0, bil.ValueWithoutVat / est.ValueWithoutVatIncome, 0) * eid.ValueWithoutVatCost, 0)) as PurchasedThirdParty\\n\\t\\tfrom\\tBill bil,\\n\\t\\t\\t\\tEstimate est,\\n\\t\\t\\t\\tEstimateItem eit,\\n\\t\\t\\t\\tEstimateItemDetail eid left join Supplier sup on sup.Oid = eid.SupplierCost\\n\\t\\twhere\\test.Oid = bil.Estimate and\\n\\t\\t\\t\\teit.Estimate = est.Oid and\\n\\t\\t\\t\\teid.EstimateItem = eit.Oid and\\n\\t\\t\\t\\tbil.[External] is not null and\\n\\t\\t\\t\\tbil.Date between @FromDate and @ToDate\\n        group by bil.Company, bil.Client, bil.Contract, bil.Project\\n\\t\\t)\\nselect\\tcom.Name as Company,\\n\\t\\tcom.Oid as CompanyId,\\n\\t\\tcom.HasImage as CompanyHasImage,\\n\\t\\t'Project' as WorkOrderType,\\n\\t\\tprj.Oid as WorkOrderId,\\n\\t\\tprj.Number as WorkOrderNumber,\\n\\t\\tprj.Name as WorkOrder,\\n\\t\\tstg.Name as Stage,\\n        isnull(stg.Color, wst.Color) as StageColor,\\n\\t\\tcli.Name as Client,\\n        cli.Oid as ClientId,\\n        cli.HasImage as ClientHasImage,\\n\\t\\tsum(t.Billed) as Billed,\\n        sum(t.Estimated - t.Billed) as Unbilled,\\n\\t\\tsum(t.PurchasedInternal) as PurchasedInternal,\\n\\t\\tsum(t.PurchasedThirdParty) as PurchasedThirdParty,\\n\\t\\tsum(t.PurchasedResources) as PurchasedResources,\\n\\t\\tiif(sum(t.Billed) != 0, sum(t.Billed - t.PurchasedThirdParty) / sum(t.Billed), 0) as Margin,\\n\\t\\tiif(sum(t.Estimated) != 0, sum(t.Billed) / sum(t.Estimated), 0) as BilledPercentage\\nfrom\\tt, Project prj, WorkflowState stg, WorkflowStateType wst, Company com, CommercialClient cli\\nwhere\\tprj.Oid = t.Project and\\n\\t\\tstg.Oid = prj.WorkflowState and\\n        wst.Oid = stg.WorkflowStateType and\\n\\t\\tcom.Oid = t.Company and\\n\\t\\tcli.Oid = t.Client \\ngroup by com.Name, com.Oid, com.HasImage, prj.Oid, prj.Number, prj.Name, stg.Name, stg.Color, wst.Color, cli.Name, cli.Oid, cli.HasImage\\nunion all\\nselect\\tcom.Name as Company,\\n\\t\\tcom.Oid as CompanyId,\\n\\t\\tcom.HasImage as CompanyHasImage,\\n\\t\\t'Contract' as WorkOrderType,\\n\\t\\tcnt.Oid as WorkOrderId,\\n\\t\\tcnt.Number as WorkOrderNmuber,\\n\\t\\tcnt.Name as WorkOrder,\\n\\t\\tstg.Name as Stage,\\n\\t\\tisnull(stg.Color, wst.Color) as StageColor,\\n\\t\\tcli.Name as Client,\\n        cli.Oid as ClientId,\\n        cli.HasImage as ClientHasImage,\\n\\t\\tsum(t.Billed) as Billed,\\n        sum(t.Estimated - t.Billed) as Unbilled,\\n\\t\\tsum(t.PurchasedInternal) as PurchasedInternal,\\n\\t\\tsum(t.PurchasedThirdParty) as PurchasedThirdParty,\\n\\t\\tsum(t.PurchasedResources) as PurchasedResources,\\n\\t\\tiif(sum(t.Billed) != 0, sum(t.Billed - t.PurchasedThirdParty) / sum(t.Billed), 0) as Margin,\\n\\t\\tiif(sum(t.Estimated) != 0, sum(t.Billed) / sum(t.Estimated), 0) as BilledPercentage\\nfrom\\tt, Contract cnt, WorkflowState stg, WorkflowStateType wst, Company com, CommercialClient cli\\nwhere\\tcnt.Oid = t.Contract and\\n\\t\\tstg.Oid = cnt.WorkflowState and\\n        wst.Oid = stg.WorkflowStateType and\\n        t.Project is null and\\n\\t\\tcom.Oid = t.Company and\\n\\t\\tcli.Oid = t.Client \\ngroup by com.Name, com.Oid, com.HasImage, cnt.Oid, cnt.Number, cnt.Name, stg.Name, stg.Color, wst.Color, cli.Name, cli.Oid, cli.HasImage\\n\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\"]}}]",
      "DashboardComponentType": {
        "Id": "a31684a8-554d-4182-82f4-03fadda0c7b6",
        "Name": "Generic Dashboard",
        "ComponentTypeNumber": 42
      },
      "AnalyticsApiUrl": "globalQuery/Development - Current development/execute",
      "Configuration": "{\n    \"keyExpr\": \"WorkOrderId\",\n    \"onRowClick\": \"function(e) {\\n    if (e.rowType == 'data')\\n      SW.preview(e.key, (e.data.WorkOrderType == 'Project') ? 'project' : 'fee');\\n}\",\n    \"selection\": {\n        \"mode\": \"none\"\n    },\n    \"stateStoring\": {\n        \"enabled\": \"false\"\n    },\n    \"height\": \"700\",\n    \"searchPanel\": {\n        \"visible\": true\n    },\n    \"scrolling\": {\n        \"mode\": \"virtual\"\n    },\n    \"grouping\": {\n        \"autoExpandAll\": true\n    },\n    \"columns\": [\n        {\n            \"caption\": \"\",\n            \"alignment\": \"center\",\n            \"width\": 50,\n            \"format\": {\n                \"image\": {\n                    \"mapping\": {\n                        \"id\": \"CompanyId\",\n                        \"name\": \"CompanyName\",\n                        \"hasImage\": \"CompanyHasImage\"\n                    },\n                    \"size\": \"small\"\n                }\n            },\n            \"entity\": \"company\"\n        },\n        {\n            \"dataField\": \"Company\",\n            \"caption\": \"?rea\",\n            \"groupIndex\": 1\n        },\n        {\n            \"dataField\": \"WorkOrderNumber\",\n            \"caption\": \"N?mero\",\n            \"width\": 100\n        },\n        {\n            \"dataField\": \"WorkOrder\",\n            \"caption\": \"Projeto / Contrato\"\n        },\n        {\n            \"dataField\": \"Stage\",\n            \"caption\": \"Etapa\",\n            \"alignment\": \"left\",\n            \"format\": \"#,##0\",\n            \"width\": 150,\n            \"cellTemplate\": \"function(e, i) {         var h=document.createElement('span');        h.style.backgroundColor = i.data.StageColor;         h.classList.add('documentStageColor');        e.append(h);        h=document.createElement('span');        h.innerHTML = ' ' + i.text;        e.append(h);}\",\n            \"groupCellTemplate\": \"function(e, i) {        var color=i.component.option().dataSource.find(row=>row.Stage==i.text).StageColor;        var h=document.createElement('span');        h.style.backgroundColor = color;         h.classList.add('documentStageColor');        e.append(h);        h=document.createElement('span');        var ht=' ' + i.text + ' ('+i.summaryItems[0].value+')';         h.innerHTML = ht;        e.append(h);}\"\n        },\n        {\n            \"caption\": \"\",\n            \"alignment\": \"center\",\n            \"width\": 50,\n            \"format\": {\n                \"image\": {\n                    \"mapping\": {\n                        \"id\": \"ClientId\",\n                        \"name\": \"Client\",\n                        \"hasImage\": \"ClientHasImage\"\n                    },\n                    \"size\": \"small\"\n                }\n            },\n            \"entity\": \"client\"\n        },\n        {\n            \"dataField\": \"Client\",\n            \"caption\": \"Cliente\"\n        },\n        {\n            \"dataField\": \"Billed\",\n            \"caption\": \"Faturado\",\n            \"alignment\": \"right\",\n            \"format\": {\n                \"type\": \"currency\",\n                \"precision\": 2\n            },\n            \"width\": 120\n        },\n        {\n            \"dataField\": \"Margin\",\n            \"caption\": \"Margem\",\n            \"alignment\": \"center\",\n            \"format\": \"percent\",\n            \"width\": 70,\n            \"cellTemplate\": \"function(e, i) { SW.setRAG(e, i.text, i.value < 0.01, i.value >= 0.01 && i.value < 0.05, i.value > 0.05);}\"\n        },\n        {\n            \"dataField\": \"PurchasedInternal\",\n            \"caption\": \"Custo Interno\",\n            \"alignment\": \"right\",\n            \"format\": {\n                \"type\": \"currency\",\n                \"precision\": 2\n            },\n            \"width\": 120\n        },\n        {\n            \"dataField\": \"PurchasedResources\",\n            \"caption\": \"Custo Horas\",\n            \"alignment\": \"right\",\n            \"format\": {\n                \"type\": \"currency\",\n                \"precision\": 2\n            },\n            \"width\": 120\n        },\n        {\n            \"dataField\": \"PurchasedThirdParty\",\n            \"caption\": \"Custo Externo\",\n            \"alignment\": \"right\",\n            \"format\": {\n                \"type\": \"currency\",\n                \"precision\": 2\n            },\n            \"width\": 120\n        },\n        {\n            \"dataField\": \"BilledPercentage\",\n            \"caption\": \"Faturado\",\n            \"alignment\": \"center\",\n            \"format\": \"percent\",\n            \"width\": 70,\n            \"cellTemplate\": \"function(e, i) { SW.setRAG(e, i.text, i.value < 0.01, i.value >= 0.01 && i.value < 0.99, i.value >= 0.99);}\"\n        },\n        {\n            \"dataField\": \"Unbilled\",\n            \"caption\": \"Por Faturar\",\n            \"alignment\": \"right\",\n            \"format\": {\n                \"type\": \"currency\",\n                \"precision\": 2\n            },\n            \"width\": 120\n        }\n    ],\n    \"sortByGroupSummaryInfo\": [\n        {\n            \"summaryItem\": \"count\"\n        }\n    ],\n    \"summary\": {\n        \"groupItems\": [\n            {\n                \"column\": \"Company\",\n                \"summaryType\": \"count\",\n                \"valueFormat\": \"#,##0\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"left\"\n            },\n            {\n                \"column\": \"Billed\",\n                \"summaryType\": \"sum\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"right\",\n                \"alignByColumn\": true,\n                \"showInGroupFooter\": false,\n                \"valueFormat\": {\n                    \"type\": \"currency\",\n                    \"precision\": 2\n                }\n            },\n            {\n                \"column\": \"Unbilled\",\n                \"summaryType\": \"sum\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"right\",\n                \"alignByColumn\": true,\n                \"showInGroupFooter\": false,\n                \"valueFormat\": {\n                    \"type\": \"currency\",\n                    \"precision\": 2\n                }\n            },\n            {\n                \"column\": \"PurchasedInternal\",\n                \"summaryType\": \"sum\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"right\",\n                \"alignByColumn\": true,\n                \"showInGroupFooter\": false,\n                \"valueFormat\": {\n                    \"type\": \"currency\",\n                    \"precision\": 2\n                }\n            },\n            {\n                \"column\": \"PurchasedThirdParty\",\n                \"summaryType\": \"sum\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"right\",\n                \"alignByColumn\": true,\n                \"showInGroupFooter\": false,\n                \"valueFormat\": {\n                    \"type\": \"currency\",\n                    \"precision\": 2\n                }\n            },\n            {\n                \"column\": \"PurchasedResources\",\n                \"summaryType\": \"sum\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"right\",\n                \"alignByColumn\": true,\n                \"showInGroupFooter\": false,\n                \"valueFormat\": {\n                    \"type\": \"currency\",\n                    \"precision\": 2\n                }\n            }\n        ],\n        \"totalItems\": [\n            {\n                \"column\": \"Company\",\n                \"summaryType\": \"count\",\n                \"valueFormat\": \"#,##0\",\n                \"displayFormat\": \"Total: {0}\",\n                \"alignment\": \"left\"\n            },\n            {\n                \"column\": \"Billed\",\n                \"summaryType\": \"sum\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"right\",\n                \"valueFormat\": {\n                    \"type\": \"currency\",\n                    \"precision\": 2\n                }\n            },\n            {\n                \"column\": \"Unbilled\",\n                \"summaryType\": \"sum\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"right\",\n                \"valueFormat\": {\n                    \"type\": \"currency\",\n                    \"precision\": 2\n                }\n            },\n            {\n                \"column\": \"PurchasedInternal\",\n                \"summaryType\": \"sum\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"right\",\n                \"valueFormat\": {\n                    \"type\": \"currency\",\n                    \"precision\": 2\n                }\n            },\n            {\n                \"column\": \"PurchasedResources\",\n                \"summaryType\": \"sum\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"right\",\n                \"valueFormat\": {\n                    \"type\": \"currency\",\n                    \"precision\": 2\n                }\n            },\n            {\n                \"column\": \"PurchasedThirdParty\",\n                \"summaryType\": \"sum\",\n                \"displayFormat\": \"{0}\",\n                \"alignment\": \"right\",\n                \"valueFormat\": {\n                    \"type\": \"currency\",\n                    \"precision\": 2\n                }\n            }\n        ]\n    }\n}",
      "DashboardDefinitionId": "0b10195f-3434-40d3-8126-d4f267a55a9d"
    }
  ],
  "QueryText": "",
  "UseStore": false,
  "StoreEntity": null,
  "Version": 1,
  "Default": false
}
