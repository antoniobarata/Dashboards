{"DashboardDefinitionRoles":[{"AccessRoleId":"5c2e7024-eaf4-43fa-96d3-9ad61b011657","DashboardDefinitionId":"6029b6f7-68c4-433c-ad80-1c57f6b8c53d","AccessRoleName":"Finance Profile"},{"AccessRoleId":"4a6dc5d0-7bc1-4501-9cf3-e49288a8e5f1","DashboardDefinitionId":"6029b6f7-68c4-433c-ad80-1c57f6b8c53d","AccessRoleName":"Finance Confidential Profile"}],"Id":"6029b6f7-68c4-433c-ad80-1c57f6b8c53d","Name":"Dynamics Reconciliation","Active":true,"Location":0,"DocumentId":"00000000-0000-0000-0000-000000000000","DocumentName":"","DocumentsConfiguration":"{\"type\":\"\",\"operations\":{\"read\":{\"endpoint\":\"\"},\"update\":{\"endpoint\":\"\",\"model\":{}},\"create\":{\"endpoint\":\"\",\"model\":{}},\"remove\":{\"endpoint\":\"\"}},\"layout\":{\"create\":{},\"read\":{}},\"customDocument\":{\"mainColor\":\"\",\"secondaryColor\":\"\",\"imageClass\":\"\",\"namePlural\":\"\",\"name\":\"\",\"systemNames\":\"\"},\"availableOptions\":{\"feed\":false,\"info\":true,\"files\":false,\"userfields\":false,\"dashboard\":true}}","Templates":[],"DashboardDefinitionComponents":[{"Id":"7ceac703-0338-4e05-b91a-318add3bb9d9","Name":"Time Sheet for Selected Period","Active":true,"UseQuery":false,"Query":null,"Size":12,"Order":3,"Parameters":"[{\"WidgetSubTitle\":\"Click on Time to mark it as keyed-in Dynamics\",\"WidgetType\":\"grid\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"\",\"WidgetHeight\":\"400\",\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"SET DATEFIRST 1;\\n\\nselect t.*, cat.Category from ( \\n\\tSELECT\\tt.Company , t.ProductExternalId , [User], ut.Name as UserType, MAX(IIF(DATEPART(WEEKDAY, [Date]) = 1, [Date], NULL)) AS Monday , \\n\\t\\t\\tMAX(IIF(DATEPART(WEEKDAY, [Date]) = 2, [Date], NULL)) AS Tuesday , \\n\\t\\t\\tMAX(IIF(DATEPART(WEEKDAY, [Date]) = 3, [Date], NULL)) AS Wednesday , \\n\\t\\t\\tMAX(IIF(DATEPART(WEEKDAY, [Date]) = 4, [Date], NULL)) AS Thursday , \\n\\t\\t\\tMAX(IIF(DATEPART(WEEKDAY, [Date]) = 5, [Date], NULL)) AS Friday , \\n\\t\\t\\tMAX(IIF(DATEPART(WEEKDAY, [Date]) = 6, [Date], NULL)) AS Saturday , \\n\\t\\t\\tMAX(IIF(DATEPART(WEEKDAY, [Date]) = 7, [Date], NULL)) AS Sunday , \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 1, [Hours], NULL)) AS MondayHours, \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 2, [Hours], NULL)) AS TuesdayHours , \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 3, [Hours], NULL)) AS WednesdayHours , \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 4, [Hours], NULL)) AS ThursdayHours , \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 5, [Hours], NULL)) AS FridayHours , \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 6, [Hours], NULL)) AS SaturdayHours , \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 7, [Hours], NULL)) AS SundayHours , \\n\\t\\t\\tSUM(SUM([Hours])) OVER (PARTITION BY [User]) AS WeekHours, \\n\\t\\t\\tSUM(SUM([DynamicsHours])) OVER (PARTITION BY [User]) - SUM(SUM([Hours])) OVER (PARTITION BY [User]) AS WeekVariance, \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 1, [DynamicsHours], NULL)) - SUM(IIF(DATEPART(WEEKDAY, [Date]) = 1, [Hours], NULL)) AS MondayVariance, \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 2, [DynamicsHours], NULL)) - SUM(IIF(DATEPART(WEEKDAY, [Date]) = 2, [Hours], NULL)) AS TuesdayVariance, \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 3, [DynamicsHours], NULL)) - SUM(IIF(DATEPART(WEEKDAY, [Date]) = 3, [Hours], NULL)) AS WednesdayVariance, \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 4, [DynamicsHours], NULL)) - SUM(IIF(DATEPART(WEEKDAY, [Date]) = 4, [Hours], NULL)) AS ThursdayVariance, \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 5, [DynamicsHours], NULL)) - SUM(IIF(DATEPART(WEEKDAY, [Date]) = 5, [Hours], NULL)) AS FridayVariance, \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 6, [DynamicsHours], NULL)) - SUM(IIF(DATEPART(WEEKDAY, [Date]) = 6, [Hours], NULL)) AS SaturdayVariance, \\n\\t\\t\\tSUM(IIF(DATEPART(WEEKDAY, [Date]) = 7, [DynamicsHours], NULL)) - SUM(IIF(DATEPART(WEEKDAY, [Date]) = 7, [Hours], NULL)) AS SundayVariance,\\n\\t\\t\\tSUM(SUM(IIF(DATEPART(WEEKDAY, [Date]) = 1, [Hours], NULL))) OVER (PARTITION BY [User]) as MondayTotal,\\n\\t\\t\\tSUM(SUM(IIF(DATEPART(WEEKDAY, [Date]) = 2, [Hours], NULL))) OVER (PARTITION BY [User]) as TuesdayTotal,\\n\\t\\t\\tSUM(SUM(IIF(DATEPART(WEEKDAY, [Date]) = 3, [Hours], NULL))) OVER (PARTITION BY [User]) as WednesdayTotal,\\n\\t\\t\\tSUM(SUM(IIF(DATEPART(WEEKDAY, [Date]) = 4, [Hours], NULL))) OVER (PARTITION BY [User]) as ThursdayTotal,\\n\\t\\t\\tSUM(SUM(IIF(DATEPART(WEEKDAY, [Date]) = 5, [Hours], NULL))) OVER (PARTITION BY [User]) as FridayTotal,\\n\\t\\t\\tSUM(SUM(IIF(DATEPART(WEEKDAY, [Date]) = 6, [Hours], NULL))) OVER (PARTITION BY [User]) as SaturdayTotal,\\n\\t\\t\\tSUM(SUM(IIF(DATEPART(WEEKDAY, [Date]) = 7, [Hours], NULL))) OVER (PARTITION BY [User]) as SundayTotal\\n\\tFROM\\t( \\n\\t\\tSELECT\\t'Actual Time' AS [Type] ,atim.Company ,pro.ExternalId AS ProductExternalId ,tim.CreatedBy as UserId, atim.[User] ,atim.[Date] , \\n\\t\\t\\t\\tDATEPART(WEEKDAY, atim.[Date]) AS Weekday ,SUM(atim.ActualTime) AS Hours, NULL AS LeaveType ,0 AS IsInDynamics , \\n\\t\\t\\t\\tMAX(IIF(tim.Accommodation = 1, 1, 0)) AS IsKeyedInDynamics, 0 as DynamicsHours \\n\\t\\tFROM\\tTimesheet tim LEFT OUTER JOIN CommercialClientProduct pro ON pro.Oid = tim.Product ,\\n\\t\\t\\t\\tAnalytics.DatamartTimesheet atim \\n\\t\\tWHERE\\ttim.Oid = atim.Oid AND atim.AdministrativeTime = 0 AND atim.[Date] >= @FromDate and atim.[Date] < @ToDate \\n\\t\\tGROUP BY atim.Company ,pro.ExternalId ,tim.CreatedBy, atim.[User] ,atim.[Date] \\n\\t\\tUNION ALL \\n\\t\\tselect\\t'Actual Time' AS [Type], c.name as Company, dyn.Project_ID as ProductExternalId, u.Oid as Userid, \\n\\t\\t\\t\\tssu.UserName as [User], dyn.Transaction_date as [Date], DATEPART(WEEKDAY, dyn.Transaction_date) AS Weekday, \\n\\t\\t\\t\\t0 as Hours, null as LeaveType, 1 as IsInDynamics, 0 as IsKeyedInDynamics, \\n\\t\\t\\t\\tsum(dyn.Hours) as DynamicHours \\n\\t\\tfrom\\t[CustomTables].[GSPATimesheet] dyn, [User] u, Company c, SecuritySystemUser ssu \\n\\t\\twhere\\t(dyn.E_mail+'_invalid') = u.Mail and \\n\\t\\t\\t\\tu.Company = c.Oid and dyn.Project_ID <> 'HOUSE-ADMIN' \\n\\t\\t\\t\\tand u.Oid = ssu.Oid and dyn.Transaction_date >= @FromDate and dyn.Transaction_date < @ToDate \\n\\t\\tgroup by c.Name, dyn.Project_ID, u.Oid, ssu.UserName, dyn.Transaction_date \\n\\t\\tUNION ALL \\n\\t\\tSELECT\\t'Administrative' AS [Type] ,atim.Company ,'HOUSE-ADMIN' AS ProductExternalId , tim.CreatedBy as UserId, atim.[User] , atim.[Date] ,\\n\\t\\t\\t\\tDATEPART(WEEKDAY, atim.[Date]) AS [Weekday] ,SUM(atim.AdministrativeTime) AS [Hours] ,NULL AS LeaveType , \\n\\t\\t\\t\\t0 AS IsInDynamics ,MAX(IIF(tim.Accommodation = 1, 1, 0)) AS IsKeyedInDynamics, 0 as DynamicHours \\n\\t\\tFROM\\tTimesheet tim ,Analytics.DatamartTimesheet atim \\n\\t\\tWHERE\\ttim.Oid = atim.Oid AND atim.AdministrativeTime != 0 AND atim.[Date] >= @FromDate and atim.[Date] < @ToDate \\n\\t\\tGROUP BY atim.Company ,tim.CreatedBy, atim.[User] ,atim.[Date] \\n\\t\\tUNION ALL \\n\\t\\tselect\\t'Administrative' AS [Type], c.name as Company, dyn.Project_ID as ProductExternalId, u.Oid as Userid, ssu.UserName as [User], \\n\\t\\t\\t\\tdyn.Transaction_date as [Date], DATEPART(WEEKDAY, dyn.Transaction_date) AS Weekday, 0 as Hours, null as LeaveType, \\n\\t\\t\\t\\t1 as IsInDynamics, 0 as IsKeyedInDynamics, sum(dyn.Hours) as DynamicHours \\n\\t\\tfrom\\t[CustomTables].[GSPATimesheet] dyn, [User] u, Company c, SecuritySystemUser ssu \\n\\t\\twhere\\t(dyn.E_mail+'_invalid') = u.Mail and u.Company = c.Oid and dyn.Project_ID = 'HOUSE-ADMIN' and u.Oid = ssu.Oid and dyn.Transaction_date >= @FromDate and dyn.Transaction_date < @ToDate \\n\\t\\tgroup by c.Name, dyn.Project_ID, u.Oid, ssu.UserName, dyn.Transaction_date \\n\\t\\tUNION ALL \\n\\t\\tSELECT\\t'Holiday' AS [Type] ,com.[Name] AS Company ,'HOUSE-ADMIN' AS ProductExternalId, u.Oid as UserId, ssu.[UserName] AS [User] ,hld.[Date] ,\\n\\t\\t\\t\\tDATEPART(WEEKDAY, hld.[Date]) AS Weekday ,\\n\\t\\t\\t\\tSUM(u.RequiredHours) - isnull((select sum((t.DurationHours + (t.DurationMinutes / cast(60 as float)))) from Timesheet t where t.CreatedBy = u.Oid and t.[Date] = hld.[Date]), 0) AS Hours, \\n\\t\\t\\t\\tNULL AS LeaveType ,1 AS IsInDynamics ,1 AS IsKeyedInDynamics, \\n\\t\\t\\t\\t0 as DynamicHours \\n\\t\\tFROM\\tHoliday hld, [User] u, SecuritySystemUser ssu, Company com \\n\\t\\tWHERE\\tu.Company = com.Oid AND hld.[Date] >= @FromDate AND hld.[Date] < @ToDate AND ssu.Oid = u.Oid\\n\\t\\tGROUP BY com.[Name] ,u.Oid, ssu.[UserName] ,hld.[Date] \\n\\t\\tUNION ALL \\n\\t\\tSELECT\\t'Leave' AS [Type] ,com.[Name] AS Company ,'HOUSE-ADMIN' AS ProductExternalId ,u.Oid as UserId, u.[Name] AS [User] , lvs.[Day] AS [Date] ,\\n\\t\\t\\t\\tDATEPART(WEEKDAY, lvs.[Day]) AS Weekday ,SUM(lvs.TotalMinutes / 60.0) AS Hours ,\\n\\t\\t\\t\\tuvt.[Name] AS LeaveType , 1 AS IsInDynamics ,1 AS IsKeyedInDynamics, 0 as DynamicHours \\n\\t\\tFROM\\tUserVacation lvs ,UserInfoVacation uiv ,UserVacationType uvt ,[User] u ,Company com \\n\\t\\tWHERE\\tu.Company = com.Oid AND u.Oid = lvs.[User] AND uiv.Oid = lvs.UserInfoVacation AND uvt.Oid = uiv.UserVacationType AND lvs.[Day] >= @FromDate AND lvs.[Day] < @ToDate \\n\\t\\tGROUP BY com.[Name] ,u.Oid, u.[Name] ,uvt.[Name] ,lvs.[Day] ) t left join [User] u on (t.UserId = u.Oid) left outer join UserType ut on (u.UserType = ut.Oid)\\n\\t\\tGROUP BY t.Company ,t.ProductExternalId ,[User], ut.Name)t \\n\\t\\tleft outer join (\\n\\t\\t\\tselect distinct ccp.ExternalId, Convert(nvarchar(500), ccu.[Dynamics Category]) as Category from CommercialClientProduct ccp, CommercialClientProduct_UserFields ccu \\n\\t\\t\\twhere\\tccp.Active=1 and ccp.Oid = ccu.Oid)cat on cat.ExternalId = t.ProductExternalId\",\"mapping\":\"\"}},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\"]}}]","DashboardComponentType":{"Id":"c666ba5e-8578-4132-86a5-0f96c665000d","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Overitme - Weekly/execute","Configuration":"{\n  \"height\": 400,\n  \"grouping\": {\n    \"autoExpandAll\": true\n  },\n  \"columns\": [\n    {\n      \"dataField\": \"User\"\n    },\n    {\n      \"dataField\": \"UserType\",\n      \"caption\": \"Type\"\n    },\n    {\n      \"caption\": \"Code\",\n      \"dataField\": \"ProductExternalId\"\n    },\n    {\n      \"dataField\": \"Category\"\n    },\n    {\n      \"caption\": \"Week Total\",\n      \"alignment\": \"center\",\n      \"dataField\": \"WeekHours\",\n      \"cellTemplate\": \"function(e, i) {\n        if (i.text == '')\n          return;\n        var h = document.createElement('DIV'); \n        e.appendChild(h);\n        h.innerHTML = i.text; \n        h.style['min-width'\n      ] = '70px'; \n        h.style['padding'\n      ] = '3px 0px'; \n        h.style['color'\n      ] = i.value < 40 ? '#f5564a' : '#333'; \n        h.style['border-radius'\n      ] = '3px'; \n        h.style['text-align'\n      ] = 'right'; \n        h.style['font-weight'\n      ] = '700'; \n        h.style['white-space'\n      ] = 'nowrap'; \n        h.style['display'\n      ] = 'inline-block';\n        h.style['background-color_'\n      ] = i.value < 40 ? '#f5564a' : '#446fd2';\n    }\"\n  },\n  {\n    \"caption\": \"Variance Total\",\n    \"alignment\": \"center\",\n    \"dataField\": \"WeekVariance\",\n    \"cellTemplate\": \"function(e, i) {\n        if (i.text == '')\n          return;\n        var h = document.createElement('DIV'); \n        e.appendChild(h);\n        h.innerHTML = i.text; \n        h.style['min-width'\n    ] = '70px'; \n        h.style['padding'\n    ] = '3px 0px'; \n        h.style['color'\n    ] = i.data.WeekHours < 40 ? '#f5564a' : '#333'; \n        h.style['border-radius'\n    ] = '3px'; \n        h.style['text-align'\n    ] = 'right'; \n        h.style['font-weight'\n    ] = '700'; \n        h.style['white-space'\n    ] = 'nowrap'; \n        h.style['display'\n    ] = 'inline-block';\n    if(i.value != 0)\n      h.style['color'] = '#f5564a';\n  }\"\n},\n  {\n    \"caption\": \"Monday\",\n    \"alignment\": \"center\",\n    \"dataField\": \"MondayHours\",\n    \"dataType\": \"number\",\n    \"cellTemplate\": \"function(e, i) {\n            if (i.text == '')\n              return;\n            var h = document.createElement('DIV'); \n            e.appendChild(h);\n            h.innerHTML = i.text; \n            h.style['min-width'\n    ] = '35px'; \n            h.style['padding'\n    ] = '3px 0px'; \n            h.style['color'\n    ] = (i.data.MondayTotal >= 8) ? '#333' : '#f5564a'; \n            h.style['border-radius'\n    ] = '3px'; \n            h.style['text-align'\n    ] = 'right'; \n            h.style['font-weight'\n    ] = '700'; \n            h.style['white-space'\n    ] = 'nowrap'; \n            h.style['display'\n    ] = 'inline-block';\n            h.style['background-color_'\n    ] = '#446fd2';\n          if(i.data.MondayVariance){\n            h.innerHTML += i.data.MondayVariance == 0 ? ('<span> ('+i.data.MondayVariance+')</span>') : \n              ('<span style=\\\"color:#f5564a\\\"> ('+i.data.MondayVariance+')</span>');\n    }\n  }\"\n},\n{\n  \"caption\": \"Tuesday\",\n  \"alignment\": \"center\",\n  \"dataField\": \"TuesdayHours\",\n  \"dataType\": \"number\",\n  \"cellTemplate\": \"function(e, i) {\n            if (i.text == '')\n              return;\n            var h = document.createElement('DIV'); \n            e.appendChild(h);\n            h.innerHTML = i.text; \n            h.style['min-width'\n  ] = '35px'; \n            h.style['padding'\n  ] = '3px 0px'; \n            h.style['color'\n  ] = (i.data.TuesdayTotal >= 8) ? '#333' : '#f5564a'; \n            h.style['border-radius'\n  ] = '3px'; \n            h.style['text-align'\n  ] = 'right'; \n            h.style['font-weight'\n  ] = '700'; \n            h.style['white-space'\n  ] = 'nowrap'; \n            h.style['display'\n  ] = 'inline-block';\n            h.style['background-color_'\n  ] = '#446fd2';\n          if(i.data.TuesdayVariance){\n            h.innerHTML += i.data.TuesdayVariance == 0 ? ('<span> ('+i.data.TuesdayVariance+')</span>') : \n              ('<span style=\\\"color:#f5564a\\\"> ('+i.data.TuesdayVariance+')</span>');\n  }\n}\"\n},\n{\n\"caption\": \"Wednesday\",\n\"alignment\": \"center\",\n\"dataField\": \"WednesdayHours\",\n\"dataType\": \"number\",\n\"cellTemplate\": \"function(e, i) {\n            if (i.text == '')\n              return;\n            var h = document.createElement('DIV'); \n            e.appendChild(h);\n            h.innerHTML = i.text; \n            h.style['min-width'\n] = '35px'; \n            h.style['padding'\n] = '3px 0px'; \n            h.style['color'\n] = (i.data.WednesdayTotal >= 8) ? '#333' : '#f5564a'; \n            h.style['border-radius'\n] = '3px'; \n            h.style['text-align'\n] = 'right'; \n            h.style['font-weight'\n] = '700'; \n            h.style['white-space'\n] = 'nowrap'; \n            h.style['display'\n] = 'inline-block';\n            h.style['background-color_'\n] = '#446fd2';\n      if(i.data.WednesdayVariance){\n            h.innerHTML += i.data.WednesdayVariance == 0 ? ('<span> ('+i.data.WednesdayVariance+')</span>') : \n              ('<span style=\\\"color:#f5564a\\\"> ('+i.data.WednesdayVariance+')</span>');\n}\n}\"    \n},\n{\n\"caption\": \"Thursday\",\n\"alignment\": \"center\",\n\"dataField\": \"ThursdayHours\",\n\"dataType\": \"number\",\n\"cellTemplate\": \"function(e, i) {\n            if (i.text == '')\n              return;\n            var h = document.createElement('DIV'); \n            e.appendChild(h);\n            h.innerHTML = i.text; \n            h.style['min-width'\n] = '35px'; \n            h.style['padding'\n] = '3px 0px'; \n            h.style['color'\n] = (i.data.ThursdayTotal >= 8) ? '#333' : '#f5564a'; \n            h.style['border-radius'\n] = '3px'; \n            h.style['text-align'\n] = 'right'; \n            h.style['font-weight'\n] = '700'; \n            h.style['white-space'\n] = 'nowrap'; \n            h.style['display'\n] = 'inline-block';\n            h.style['background-color_'\n] = '#446fd2';\n      if(i.data.ThursdayVariance){\n            h.innerHTML += i.data.ThursdayVariance == 0 ? ('<span> ('+i.data.ThursdayVariance+')</span>') : \n              ('<span style=\\\"color:#f5564a\\\"> ('+i.data.ThursdayVariance+')</span>');\n}\n}\"\n},\n{\n\"caption\": \"Friday\",\n\"alignment\": \"center\",\n\"dataField\": \"FridayHours\",\n\"dataType\": \"number\",\n\"cellTemplate\": \"function(e, i) {\n            if (i.text == '')\n              return;\n            var h = document.createElement('DIV'); \n            e.appendChild(h);\n            h.innerHTML = i.text; \n            h.style['min-width'\n] = '35px'; \n            h.style['padding'\n] = '3px 0px'; \n            h.style['color'\n] = (i.data.FridayTotal >= 8) ? '#333' : '#f5564a'; \n            h.style['border-radius'\n] = '3px'; \n            h.style['text-align'\n] = 'right'; \n            h.style['font-weight'\n] = '700'; \n            h.style['white-space'\n] = 'nowrap'; \n            h.style['display'\n] = 'inline-block';\n            h.style['background-color_'\n] = '#446fd2';\n      if(i.data.FridayVariance){\n            h.innerHTML += i.data.FridayVariance == 0 ? ('<span> ('+i.data.FridayVariance+')</span>') : \n              ('<span style=\\\"color:#f5564a\\\"> ('+i.data.FridayVariance+')</span>');\n}\n}\"\n},\n{\n\"caption\": \"Saturday\",\n\"dataField\": \"SaturdayHours\",\n\"dataType\": \"number\",\n\"alignment\": \"center\",\n\"cellTemplate\": \"function(e, i) {\n            if (i.text == '')\n              return;\n            var h = document.createElement('DIV'); \n            e.appendChild(h);\n            h.innerHTML = i.text; \n            h.style['min-width'\n] = '35px'; \n            h.style['padding'\n] = '3px 0px'; \n            h.style['color'\n] = (i.data.SaturdayTotal >= 8) ? '#333' : '#f5564a'; \n            h.style['border-radius'\n] = '3px'; \n            h.style['text-align'\n] = 'right'; \n            h.style['font-weight'\n] = '700'; \n            h.style['white-space'\n] = 'nowrap'; \n            h.style['display'\n] = 'inline-block';\n            h.style['background-color_'\n] = '#446fd2';\n    if(i.data.SaturdayVariance){\n            h.innerHTML += i.data.SaturdayVariance == 0 ? ('<span> ('+i.data.SaturdayVariance+')</span>') : \n              ('<span style=\\\"color:#f5564a\\\"> ('+i.data.SaturdayVariance+')</span>');\n}\n}\"\n},\n{\n\"caption\": \"Sunday\",\n\"dataField\": \"SundayHours\",\n\"dataType\": \"number\",\n\"alignment\": \"center\",\n\"cellTemplate\": \"function(e, i) {\n            if (i.text == '')\n              return;\n            var h = document.createElement('DIV'); \n            e.appendChild(h);\n            h.innerHTML = i.text; \n            h.style['min-width'\n] = '35px'; \n            h.style['padding'\n] = '3px 0px'; \n            h.style['color'\n] = (i.data.SundayTotal >= 8) ? '#333' : '#f5564a'; \n            h.style['border-radius'\n] = '3px'; \n            h.style['text-align'\n] = 'right'; \n            h.style['font-weight'\n] = '700'; \n            h.style['white-space'\n] = 'nowrap'; \n            h.style['display'\n] = 'inline-block';\n            h.style['background-color_'\n] = '#446fd2';\n        if(i.data.SundayVariance){\n            h.innerHTML += i.data.SundayVariance == 0 ? ('<span> ('+i.data.SundayVariance+')</span>') : \n              ('<span style=\\\"color:#f5564a\\\"> ('+i.data.SundayVariance+')</span>');\n}\n}\"\n}\n],\n\"summary\": {\n\"groupItems\": [\n{\n\"column\": \"User\",\n\"summaryType\": \"count\",\n\"valueFormat\": \"#,##0\",\n\"displayFormat\": \"{0}\",\n\"alignment\": \"left\"\n}\n],\n\"totalItems\": [\n{\n\"column\": \"User\",\n\"summaryType\": \"count\",\n\"valueFormat\": \"#,##0\",\n\"displayFormat\": \"Total: {0}\",\n\"alignment\": \"left\"\n},\n{\n\"column\": \"Hours\",\n\"summaryType\": \"sum\",\n\"valueFormat\": \"#,##0\",\n\"displayFormat\": \"{0}\",\n\"alignment\": \"center\"\n}\n]\n}\n}","DashboardDefinitionId":"6029b6f7-68c4-433c-ad80-1c57f6b8c53d"},{"Id":"f6693697-3f64-45d9-a6ec-337f0d6718f1","Name":"Overall Status","Active":true,"UseQuery":false,"Query":null,"Size":3,"Order":1,"Parameters":"[{\"WidgetSubTitle\":\"Time in Dynamics vs Keyed in Dynamics vs not in Dynamics\",\"WidgetType\":\"chart\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#ffffff\",\"WidgetHeight\":\"135\",\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"queryText\",\"value\":\" select 'Not in Dynamics' as NotInDynamics, 'In Dynamics' as InDynamics, 'Keyed in Dynamics' as KeyedInDynamics, sum(iif(tim.Accommodation = 0, atim.ActualTime, 0)) as IsNotInDynamics, sum(iif(tim.Accommodation = 1, atim.ActualTime, 0)) as IsInDynamics, sum(iif(tim.Accommodation = 1, atim.ActualTime, 0)) as IsKeyedInDynamics from Timesheet tim, analytics.datamartTimesheet atim where tim.Oid = atim.Oid\",\"mapping\":\"\"}},\"QueryConfiguration\":{\"RequiredFilters\":[]}}]","DashboardComponentType":{"Id":"c666ba5e-8578-4132-86a5-0f96c665000d","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Overtime - Exception/execute","Configuration":"{\n  \"height\": 190,\n  \"size\":{\n    \"height\":190\n  },\n  \"commonSeriesSettings\": {\n    \"ignoreEmptyPoints\": true,\n    \"type\": \"bar\",\n    \"cornerRadius\": 2\n  },\n  \"argumentAxis\": {\n    \"label\": {\n      \"overlappingBehavior\": \"stagger\",\n      \"font\": {\n        \"size\": 10\n      }\n    }\n  },\n  \"series\": [\n    {\n      \"argumentField\": \"InDynamics\",\n      \"valueField\": \"IsInDynamics\",\n      \"name\": \"Total\",\n      \"barWidth\": 80\n    },\n    {\n      \"argumentField\": \"NotInDynamics\",\n      \"valueField\": \"IsNotInDynamics\",\n      \"name\": \"Total\",\n      \"barWidth\": 80,\n      \"color\": \"#f5564a\"\n    },\n    {\n      \"argumentField\": \"KeyedInDynamics\",\n      \"valueField\": \"IsKeyedInDynamics\",\n      \"name\": \"Total\",\n      \"barWidth\": 80,\n      \"color\": \"#446fd2\",\n      \"visible\": false\n    }\n  ]\n}","DashboardDefinitionId":"6029b6f7-68c4-433c-ad80-1c57f6b8c53d"},{"Id":"b06e172e-a9c1-45b7-9702-3cd6e6d11512","Name":"Time Sheet","Active":true,"UseQuery":false,"Query":null,"Size":9,"Order":2,"Parameters":"[\r\n    {\r\n        \"WidgetSubTitle\": \"Red is time that has not been set as keyed in Dynamics\",\r\n        \"WidgetType\": \"rangeselector\",\r\n        \"WidgetFilterField\": \"\",\r\n        \"WidgetColor\": \"#ffffff\",\r\n        \"WidgetHeight\": \"135\",\r\n        \"WidgetHeader\": {\r\n            \"showContextInfo\": false,\r\n            \"WidgetPeriodChooser\": {\r\n                \"startDate\": \"2019/07/01\",\r\n                \"endDate\": \"2019/12/31\",\r\n                \"type\": \"year\",\r\n                \"visible\": false\r\n            },\r\n            \"showSubTitle\": true,\r\n            \"showTitle\": true\r\n        },\r\n        \"WidgetDataSources\": {\r\n            \"main\": {\r\n                \"type\": \"queryText\",\r\n                \"value\": \"select atim.[Date], sum(iif(tim.Accommodation = 0, atim.ActualTime, 0)) as IsNotInDynamics, sum(iif(tim.Accommodation = 1, atim.ActualTime, 0)) as IsInDynamics from Timesheet tim, analytics.datamartTimesheet atim where tim.Oid = atim.Oid and atim.[Date] between @FromDate and @ToDate group by atim.[Date]\",\r\n                \"mapping\": \"\"\r\n            }\r\n        },\r\n        \"QueryConfiguration\": null\r\n    }\r\n]","DashboardComponentType":{"Id":"c666ba5e-8578-4132-86a5-0f96c665000d","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Overtime - Overview/execute","Configuration":"{\n  \"height\": \"190\",\n  \"size\": {\n    \"height\": \"190\"\n  },\n  \"containerBackgroundColor\": \"#ffffff\",\n  \"selectedRangeColor\": \"#f5564a\",\n  \"chart\": {\n    \"commonSeriesSettings\": {\n      \"type\": \"steparea\",\n      \"argumentField\": \"Date\"\n    },\n    \"series\": [\n      {\n        \"valueField\": \"IsInDynamics\"\n      },\n      {\n        \"valueField\": \"IsNotInDynamics\"\n      }\n    ]\n  },\n  \"scale\": {\n    \"minorTickInterval\": \"week\",\n    \"tickInterval\": {\"weeks\":1},\n    \"valueType\": \"datetime\",\n    \"maxRange\": {\"weeks\": 1},\n    \"minRange\": {\"weeks\": 1},\n    \"endOnTick\": \"true\"\n  },\n  \"sliderMarker\": {\n    \"format\": \"monthAndDay\",\n    \"color\": \"#da5859\"\n  },\n  \"value\": {\n    \"length\": {\n      \"weeks\": 1\n    }\n  }\n}","DashboardDefinitionId":"6029b6f7-68c4-433c-ad80-1c57f6b8c53d"}]}