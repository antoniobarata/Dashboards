{"DashboardDefinitionRoles":[{"AccessRoleId":"37bb1c74-f352-4a97-a363-b442659a92b7","DashboardDefinitionId":"8f1b9b6c-1245-41f7-9064-f45e8a94d2b8","AccessRoleName":"Administrator"}],"Id":"8f1b9b6c-1245-41f7-9064-f45e8a94d2b8","Name":"Consolidated Utilization","Active":true,"Location":0,"DocumentId":"00000000-0000-0000-0000-000000000000","DocumentName":"","DocumentTypeName":null,"DocumentsConfiguration":"{\"type\":\"\",\"operations\":{\"read\":{\"endpoint\":\"\"},\"update\":{\"endpoint\":\"\",\"model\":{}},\"create\":{\"endpoint\":\"\",\"model\":{}},\"remove\":{\"endpoint\":\"\"}},\"layout\":{\"create\":{},\"read\":{}},\"customDocument\":{\"mainColor\":\"\",\"secondaryColor\":\"\",\"imageClass\":\"\",\"namePlural\":\"\",\"name\":\"\",\"systemNames\":\"\"},\"availableOptions\":{\"feed\":false,\"info\":true,\"files\":false,\"userfields\":false,\"dashboard\":false}}","Templates":[],"DashboardDefinitionComponents":[{"Id":"843ce7e6-539a-4a92-9ef3-06a76202c470","Name":"Utilization by Department","Active":true,"UseQuery":false,"Query":"","Size":12,"Order":0,"Parameters":"[{\"WidgetSubTitle\":\"\",\"WidgetType\":\"chart\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#e0e0e0\",\"WidgetXPosition\":30,\"WidgetYPosition\":6,\"WidgetRows\":12,\"WidgetColumns\":18,\"WidgetHeader\":{\"showTitle\":true,\"showSubTitle\":false,\"WidgetMetrics\":{\"visible\":true,\"Metrics\":[{\"visible\":true,\"metricName\":\"Company Total Hours\",\"metricFieldValue\":\"TotalHours\"}]},\"WidgetPeriodChooser\":{\"visible\":false,\"type\":\"\",\"startDate\":null,\"endDate\":null}},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"select\\r\\n\\t\\tv.Department,\\r\\n\\t\\tround((v.NewBussinessTimeHours / IIF(v.TotalHours > 0, v.TotalHours, 1.0)) * 100, 0) as NonBillablePercentage,\\r\\n\\t\\tround((v.BillableHours / IIF(v.TotalHours > 0, v.TotalHours, 1.0)) * 100, 0) as BillablePercentage,\\r\\n\\t\\tv.TotalHours\\r\\nfrom (\\r\\n\\tselect \\r\\n\\t\\t\\tv.Department, \\r\\n\\t\\t\\tsum(v.NewBusinessTime) as NewBussinessTimeHours,\\r\\n\\t\\t\\tsum(v.BillableTime) as BillableHours,\\r\\n\\t\\t\\tsum(sum(v.ActualTime)) OVER () as TotalHours\\r\\n\\tfrom\\r\\n\\t\\t\\tAnalytics.Timesheet(@CurrentUserId) v, Project prj, CommercialClientProduct_UserFields pro\\r\\n\\twhere\\r\\n\\t\\t\\tprj.Oid = v.ProjectId and\\r\\n\\t\\t\\tpro.Oid = prj.Product and\\r\\n            (cast(LongviewCode as nvarchar) = @ProductCode or @ProductCode = '') and \\r\\n\\t\\t\\t(v.CompanyId = @Company or @Company = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\t\\t/*[DateFilter]*/ AND v.[Date] between @FromDate and @ToDate  /*[/DateFilter]*/\\r\\n\\t\\t\\t\\r\\n\\tgroup by \\r\\n\\t\\t\\tv.Department\\r\\n\\t) v\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"PreviousPeriod\":{\"Show\":false,\"KeyFieldName\":\"\",\"Type\":0},\"RequiredFilters\":[\"startDate\",\"endDate\",\"Company\",\"ProductCode\"]}}]","DashboardComponentType":{"Id":"3c1da83b-efe9-4b70-87d0-c3813a512774","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"","Configuration":"{\r\n    \"commonSeriesSettings\": {\r\n        \"barWidth\": 25,\r\n        \"type\": \"stackedBar\",\r\n        \"cornerRadius\": \"2px\",\r\n        \"label\": {\r\n            \"showForZeroValues\": false,\r\n            \"visible\": true,\r\n            \"customizeText\": \"function (info) { return info.valueText + '%'; }\",\r\n            \"font\": {\r\n                \"size\": 10,\r\n                \"family\": \"Varela Round\",\r\n                \"weight\": 800\r\n            },\r\n            \"backgroundColor\": \"#00000000\"\r\n        },\r\n        \"argumentField\": \"Department\"\r\n    },\r\n    \"barWidth\": 0.3,\r\n    \"argumentAxis\": {\r\n        \"label\": {\r\n            \"font\": {\r\n                \"family\": \"Varela Round\",\r\n                \"size\": 10,\r\n                \"weight\": 800\r\n            }\r\n        }\r\n    },\r\n    \"series\": [\r\n        {\r\n            \"valueField\": \"NonBillablePercentage\",\r\n            \"name\": \"Non Billable\"\r\n        },\r\n        {\r\n            \"valueField\": \"BillablePercentage\",\r\n            \"name\": \"Billable\"\r\n        }\r\n    ],\r\n    \"legend\": {\r\n        \"visible\": true,\r\n        \"horizontalAlignment\": \"center\",\r\n        \"verticalAlignment\": \"bottom\",\r\n        \"columnCount\": 2,\r\n        \"font\": {\r\n            \"family\": \"Varela Round\",\r\n            \"size\": 10,\r\n            \"weight\": 800\r\n        }\r\n    }\r\n}","DashboardDefinitionId":"8f1b9b6c-1245-41f7-9064-f45e8a94d2b8"},{"Id":"c5a03080-01a1-4e24-bc86-2db82a966545","Name":"Utilization by User","Active":true,"UseQuery":false,"Query":null,"Size":6,"Order":6,"Parameters":"[{\"WidgetSubTitle\":\"Client, Admin and Internal Time spent per User\",\"WidgetType\":\"grid\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"\",\"WidgetXPosition\":0,\"WidgetYPosition\":18,\"WidgetRows\":16,\"WidgetColumns\":24,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":false,\"metricName\":\"# Forecast\",\"metricFieldValue\":\"TimeGrandTotal\"},{\"visible\":false,\"metricName\":\"# Actual\",\"metricFieldValue\":\"UtilizationPercentGrandTotal\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"WITH UsersCapacity AS\\n(\\n\\tSELECT \\n\\t\\tu.Oid AS UserId,\\n\\t\\t(\\n\\t\\t\\t(\\n\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\t(DATEDIFF(dd, @FromDate, @ToDate) + 1)\\n\\t\\t\\t\\t\\t-(DATEDIFF(wk, @FromDate, @ToDate) * 2)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @FromDate) = 'Sunday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @ToDate) = 'Saturday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t) + 1 \\n\\t\\t\\t)\\n\\t\\t\\t-\\n\\t\\t\\t(\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t\\t+\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t)\\n\\t\\t) * u.RequiredHours AS WorkingHours,\\n\\t\\t(SELECT ISNULL(SUM(dl.[Hours]), 0.0) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate) AS Leaves,\\n\\t\\t(SELECT ISNULL(SUM(dh.[Hours]), 0.0) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate) as Holidays\\n\\tFROM\\n\\t\\t[User] u\\n\\tWHERE\\n\\t\\t(u.Company = @Company or @Company = '00000000-0000-0000-0000-000000000000')\\n),\\nUsersHours AS\\n(\\n\\tSELECT\\n\\t\\tdt.Department,\\n\\t\\tdt.UserTypologyGroup,\\t\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User],\\n\\t\\tdt.Company,\\n\\t\\tSUM(dt.ActualTime) AS [Hours],\\n\\t\\tSUM(dt.AdministrativeTime) AS [AdministrativeHours],\\n\\t\\tSUM(ISNULL(dt.InternalWorkTime, 0.0)) AS [InternalWorkHours],\\n\\t\\tSUM(dt.NewBusinessTime) AS [NewBusinessHours],\\n\\t\\tSUM(dt.BillableTime) AS [BillableHours],\\n\\t\\tSUM(ISNULL(dt.BillableTime, 0.0) - ISNULL(dt.[InternalWorkTime], 0.0)) as [ClientHours],\\n\\t\\tSUM(ISNULL(dt.[ActualTime] - (dt.[AdministrativeTime] + dt.[NewBusinessTime] + dt.[BillableTime]), 0.0)) as [NonWorkedHours]\\n\\tfrom\\tAnalytics.Timesheet(@CurrentUserId) dt, Project prj, CommercialClientProduct_UserFields pro\\n\\twhere\\tprj.Oid = dt.ProjectId and\\n\\t\\t\\tpro.Oid = prj.Product and\\n\\t\\t\\tdt.[Date] BETWEEN @FromDate AND @ToDate and\\n\\t\\t\\t(dt.CompanyId = @Company or @Company = '00000000-0000-0000-0000-000000000000')\\n\\tGROUP BY\\n\\t\\tdt.Company,\\n\\t\\tdt.Department,\\n\\t\\tdt.UserTypologyGroup,\\t\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User]\\n)\\nSELECT \\n\\tuh.Company,\\n\\tuh.Department,\\n\\tuh.UserTypologyGroup,\\n\\tuh.[User],\\n\\tuh.UserId,\\n\\tuh.[Hours],\\n\\tuh.AdministrativeHours,\\n\\tuh.InternalWorkHours,\\n\\tuh.NewBusinessHours,\\n\\tuh.BillableHours,\\n\\tuh.ClientHours,\\n\\tuh.NonWorkedHours,\\n\\tuc.WorkingHours AS Capacity,\\n\\tuc.Leaves AS Leaves,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[BillableHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationPercentage,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[NewBusinessHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationNonBillablePercentage\\nFROM \\n\\tUsersHours uh,\\n\\tUsersCapacity uc\\nWHERE\\n\\tuh.UserId = uc.UserId\\n\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\",\"Company\",\"ProductCode\"]}}]","DashboardComponentType":{"Id":"3c1da83b-efe9-4b70-87d0-c3813a512774","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Per_Company_Department_User/execute","Configuration":"{\"grouping\":{\"autoExpandAll\":true},\"columnResizingMode\":\"widget\",\"allowColumnResizing\":\"true\",\"allowFiltering\":true,\"columnAutoWidth\":\"true\",\"searchPanel\":{\"visible\":true},\"selection\":{\"mode\":\"single\"},\"onSelectionChanged\":\"function (selectedItems) {      var data = selectedItems.selectedRowsData[0];      if(data) {          SW.setDashboardFilter('userId', data.UserId);    }  }\",\"height\":\"300\",\"scrolling\":{\"mode\":\"virtual\"},\"columnMinWidth\":\"80\",\"columns\":[{\"visible\":false,\"dataField\":\"Company\",\"caption\":\"Company\",\"width\":120},{\"dataField\":\"Department\",\"caption\":\"Department\",\"width\":120,\"groupIndex\":0},{\"dataField\":\"UserTypologyGroup\",\"name\":\"Typology Group\",\"caption\":\"Typology\",\"width\":120},{\"dataField\":\"UserId\",\"name\":\"Picture\",\"caption\":\"Picture\",\"width\":30,\"alignment\":\"left\",\"cellTemplate\":\"function(e, i) {        SW.showImage(e, 'user', 'small', i.text, i.data.User);      }\"},{\"dataField\":\"User\",\"name\":\"User\",\"caption\":\"User\",\"width\":120},{\"dataField\":\"Capacity\",\"caption\":\"Capacity\",\"alignment\":\"right\",\"format\":\"#,##0\"},{\"dataField\":\"UtilizationNonBillablePercentage\",\"caption\":\"Non Billable %\",\"name\":\"UtilizationNonBillable\",\"alignment\":\"right\",\"format\":\"#,##0\",\"cellTemplate\":\"function(e, i) { SW.setRAG(e, (i.value * 100.0).toFixed(1) + '%', i.value >= 1.2, i.value < 0.8, (i.value >= 0.8 && i.value < 1.2), true); }\"},{\"dataField\":\"UtilizationPercentage\",\"caption\":\"Billable %\",\"name\":\"Utilization\",\"alignment\":\"right\",\"format\":\"#,##0\",\"cellTemplate\":\"function(e, i) { SW.setRAG(e, (i.value * 100.0).toFixed(1) + '%', i.value >= 1.2, i.value < 0.8, (i.value >= 0.8 && i.value < 1.2), true); }\"},{\"dataField\":\"Leaves\",\"caption\":\"Leaves\",\"alignment\":\"right\",\"format\":\"#,##0\"},{\"dataField\":\"NewBusinessHours\",\"caption\":\"Non-Billable\",\"name\":\"NonBillable\",\"alignment\":\"right\",\"format\":\"#,##0\"},{\"dataField\":\"AdministrativeHours\",\"caption\":\"Admin\",\"name\":\"Admin\",\"alignment\":\"right\",\"format\":\"#,##0\"},{\"dataField\":\"BillableHours\",\"caption\":\"Billable\",\"alignment\":\"right\",\"format\":\"#,##0\"}],\"sortByGroupSummaryInfo\":[{\"summaryItem\":\"count\"}],\"summary\":{\"totalItems\":[{\"column\":\"Capacity\",\"summaryType\":\"sum\",\"valueFormat\":\"#,##0\",\"displayFormat\":\"{0}\",\"alignment\":\"right\"},{\"column\":\"Leaves\",\"summaryType\":\"sum\",\"valueFormat\":\"#,##0\",\"displayFormat\":\"{0}\",\"alignment\":\"right\"},{\"column\":\"NewBusinessHours\",\"summaryType\":\"sum\",\"valueFormat\":\"#,##0\",\"displayFormat\":\"{0}\",\"alignment\":\"right\"},{\"column\":\"AdministrativeHours\",\"summaryType\":\"sum\",\"valueFormat\":\"#,##0\",\"displayFormat\":\"{0}\",\"alignment\":\"right\"},{\"column\":\"BillableHours\",\"summaryType\":\"sum\",\"valueFormat\":\"#,##0\",\"displayFormat\":\"{0}\",\"alignment\":\"right\"}]}}","DashboardDefinitionId":"8f1b9b6c-1245-41f7-9064-f45e8a94d2b8"},{"Id":"1d24b82c-863d-4e1c-b448-35a4d16695d1","Name":"Utilization by Project Type ","Active":true,"UseQuery":false,"Query":null,"Size":3,"Order":5,"Parameters":"[{\"WidgetSubTitle\":\"Time spent on the different Project Types\",\"WidgetType\":\"pie\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#dddddd\",\"WidgetXPosition\":18,\"WidgetYPosition\":6,\"WidgetRows\":12,\"WidgetColumns\":12,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":true,\"metricName\":\"# Planned\",\"metricFieldValue\":\"PlannedTimeGrandTotal\"}]},\"showSubTitle\":false,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"select\\tv.ProjectTypeName,\\r\\n\\t\\t(v.[Hours] / IIF(v.[TotalHours] > 0, v.[TotalHours], 1.0)) as UtilizationPercentage\\r\\nfrom\\t(\\r\\n\\t\\t\\tselect\\tv.ProjectTypeName,\\t\\r\\n\\t\\t\\t\\t\\tSUM(v.ActualTime) as [Hours],\\r\\n\\t\\t\\t\\t\\tSUM(SUM(v.ActualTime)) OVER () as [TotalHours]\\r\\n\\t\\t\\tfrom\\tAnalytics.Timesheet(@CurrentUserId) v, Project prj, CommercialClientProduct_UserFields pro\\r\\n\\t\\t\\twhere\\tprj.Oid = v.ProjectId and\\r\\n\\t\\t\\t\\t\\tpro.Oid = prj.Product and\\r\\n                    (cast(LongviewCode as nvarchar) = @ProductCode or @ProductCode = '') and \\r\\n\\t\\t\\t\\t\\t(v.CompanyId = @Company or @Company = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\t\\t\\t\\t/*[DateFilter]*/ AND v.[Date] between @FromDate and @ToDate  /*[/DateFilter]*/\\r\\n\\t\\t\\tgroup by v.ProjectTypeName\\r\\n\\t\\t) v\\r\\n\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\",\"Company\",\"ProductCode\"]}}]","DashboardComponentType":{"Id":"3c1da83b-efe9-4b70-87d0-c3813a512774","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Totals/execute","Configuration":"{\n    \"commonSeriesSettings\": {\n        \"type\": \"doughnut\",\n        \"ignoreEmptyPoints\": true,\n        \"smallValuesGrouping\": {\n            \"mode\": \"topN\",\n            \"topCount\": 8,\n            \"groupName\": \"Others\"\n        }\n    },\n    \"size\": {\n        \"height\": 200\n    },\n    \"tooltip\": {\n        \"format\": \"percent\"\n    },\n    \"argumentAxis\": {\n        \"label\": {\n            \"font\": {\n                \"size\": 8\n            }\n        }\n    },\n    \"valueAxis\": {\n        \"label\": {\n            \"format\": \"percent\"\n        }\n    },\n    \"series\": [\n        {\n            \"argumentField\": \"ProjectTypeName\",\n            \"valueField\": \"UtilizationPercentage\",\n            \"label\": {\n                \"visible\": true,\n                \"format\": \"fixedPoint\",\n                \"position\": \"inside\",\n                \"showForZeroValues\": false,\n                \"font\": {\n                    \"family\": \"Varela Round\",\n                    \"weight\": 800\n                },\n                \"customizeText\": \"function(arg) { return arg.percentText; }\"\n            }\n        }\n    ],\n    \"legend\": {\n        \"visible\": true,\n        \"horizontalAlignment\": \"left\",\n        \"verticalAlignment\": \"middle\",\n        \"itemTextPosition\": \"right\",\n        \"paddingLeftRight\": 0,\n        \"font\": {\n            \"family\": \"Varela Round\",\n            \"weight\": 800,\n            \"size\": 8\n        }\n    },\n    \"resolveLabelOverlapping\": \"shift\"\n}","DashboardDefinitionId":"8f1b9b6c-1245-41f7-9064-f45e8a94d2b8"},{"Id":"5f2edf3d-8315-4a99-9ea1-70f97ed5ea73","Name":"Utilization by Client  Group","Active":true,"UseQuery":false,"Query":null,"Size":6,"Order":3,"Parameters":"[{\"WidgetSubTitle\":\"Time spent on Clients per Company\",\"WidgetType\":\"chart\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#dddddd\",\"WidgetXPosition\":0,\"WidgetYPosition\":6,\"WidgetRows\":12,\"WidgetColumns\":18,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":true,\"metricName\":\"# Planned\",\"metricFieldValue\":\"PlannedTimeGrandTotal\"}]},\"showSubTitle\":false,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"select\\ttop 15 v.ClientGroup,\\r\\n\\t\\t(v.[Hours] / iif(v.[TotalHours] > 0, v.[TotalHours], 1.0)) as UtilizationPercentage\\r\\nfrom\\t(\\r\\n\\t\\t\\tselect\\tv.ClientGroup,\\t\\r\\n\\t\\t\\t\\t\\tsum(v.ActualTime) as [Hours],\\r\\n\\t\\t\\t\\t\\tsum(sum(v.ActualTime)) over() as [TotalHours]\\r\\n\\t\\t\\tfrom\\tAnalytics.Timesheet(@CurrentUserId) v, Project prj, CommercialClientProduct_UserFields pro\\r\\n\\t\\t\\twhere\\tprj.Oid = v.ProjectId and\\r\\n\\t\\t\\t\\t\\tpro.Oid = prj.Product and\\r\\n\\t\\t\\t\\t\\t(cast(LongviewCode as nvarchar) = @ProductCode or @ProductCode = '') and \\r\\n\\t\\t\\t\\t\\t(v.CompanyId = @Company or @Company = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\t\\t\\t\\t/*[DateFilter]*/ AND v.[Date] between @FromDate and @ToDate  /*[/DateFilter]*/\\r\\n\\t\\t\\tgroup by v.ClientGroup\\r\\n\\t\\t) v\\r\\nwhere\\t(v.[Hours] / iif(v.[TotalHours] > 0, v.[TotalHours], 1.0)) > 0.005\\r\\norder by 2 desc\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\",\"Company\",\"ProductCode\"]}}]","DashboardComponentType":{"Id":"3c1da83b-efe9-4b70-87d0-c3813a512774","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Totals/execute","Configuration":"{\n    \"scrollBar\": {\n        \"visible\": true\n    },\n    \"zoomAndPan\": {\n        \"argumentAxis\": \"both\"\n    },\n    \"barWidth\": 0.3,\n    \"commonSeriesSettings\": {\n        \"type\": \"bar\",\n        \"ignoreEmptyPoints\": true,\n        \"cornerRadius\": \"2px\",\n        \"label\": {\n            \"visible\": true,\n            \"showForZeroValues\": false,\n            \"format\": \"percent\",\n            \"font\": {\n                \"family\": \"Varela Round\",\n                \"weight\": 800\n            }\n        }\n    },\n    \"size\": {\n        \"height\": 200\n    },\n    \"tooltip\": {\n        \"format\": \"percent\"\n    },\n    \"argumentAxis\": {\n        \"label\": {\n            \"font\": {\n                \"family\": \"Varela Round\",\n                \"size\": 8,\n                \"weight\": 400\n            }\n        }\n    },\n    \"valueAxis\": {\n        \"label\": {\n            \"format\": \"percent\",\n            \"font\": {\n                \"family\": \"Varela Round\",\n                \"weight\": 800\n            }\n        }\n    },\n    \"series\": [\n        {\n            \"name\": \"ClientGroup\",\n            \"argumentField\": \"ClientGroup\",\n            \"valueField\": \"UtilizationPercentage\",\n            \"label\": {\n                \"visible\": true,\n                \"format\": \"percent\",\n                \"font\": {\n                    \"family\": \"Varela Round\",\n                    \"weight\": 800\n                }\n            }\n        }\n    ],\n    \"legend\": {\n        \"visible\": false,\n        \"horizontalAlignment\": \"left\",\n        \"verticalAlignment\": \"middle\",\n        \"itemTextPosition\": \"right\",\n        \"paddingLeftRight\": 0,\n        \"font\": {\n            \"family\": \"Varela Round\",\n            \"size\": 8,\n            \"weight\": 800\n        }\n    },\n    \"resolveLabelOverlapping\": \"shift\",\n    \"dataPrepareSettings\": {\n        \"sortingMethod\": false\n    }\n}","DashboardDefinitionId":"8f1b9b6c-1245-41f7-9064-f45e8a94d2b8"},{"Id":"ab7d4ee0-5090-4af9-b0c0-aee3036233e9","Name":"Company and Client Group","Active":true,"UseQuery":false,"Query":null,"Size":12,"Order":0,"Parameters":"[{\"WidgetSubTitle\":\"Choose a Company or Client Group\",\"WidgetType\":\"form\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#efefef\",\"WidgetXPosition\":0,\"WidgetYPosition\":0,\"WidgetRows\":2,\"WidgetColumns\":48,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":false,\"metricName\":\"# Forecast\",\"metricFieldValue\":\"TimeGrandTotal\"},{\"visible\":false,\"metricName\":\"# Actual\",\"metricFieldValue\":\"UtilizationPercentGrandTotal\"}]},\"showSubTitle\":false,\"showTitle\":false},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"SELECT 1;\"}},\"Filters\":{},\"QueryConfiguration\":{}}]","DashboardComponentType":{"Id":"3c1da83b-efe9-4b70-87d0-c3813a512774","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Per_Company_Department_User/execute","Configuration":"{\n    \"rowCount\": 1,\n    \"colCount\": 3,\n    \"items\": [\n        {\n            \"dataField\": \"Year\",\n            \"editorType\": \"dxNumberBox\",\n            \"editorOptions\": {\n                \"showSpinButtons\": true,\n                \"value\": 2019,\n                \"width\": 65,\n                \"placeholder\": \"year\",\n                \"onContentReady\": \"function(e) { setTimeout(function() { SkillsWorkflow.setDashboardFilter('Year', 2019); \n                                                                        SkillsWorkflow.setDashboardFilter('Company', '00000000-0000-0000-0000-000000000000'); \n                                                                        SkillsWorkflow.setDashboardFilter('ClientGroupOid', '00000000-0000-0000-0000-000000000000'); \n                                                                        SkillsWorkflow.setDashboardFilter('ProductCode', '');\n            },\n            1000)\n        }\",\n                \"onValueChanged\": \"function(e){ if(e.value != null) { SkillsWorkflow.setDashboardFilter('Year', e.value); } }\"\n    },\n    \"noDataText\": \"Please wait...\"\n},\n{\n    \"name\": \"Company\",\n    \"dataField\": \"CompanyId\",\n    \"editorType\": \"dxSelectBox\",\n    \"editorOptions\": {\n        \"width\": 250,\n        \"searchEnabled\": true,\n        \"dataSource\": {\n            \"load\": \"function(loadOptions){ \n                                    var searchValue = (\n                                    loadOptions.searchValue != null ? loadOptions.searchValue : ''); \n                                    var searchTake = (loadOptions.searchValue != null && loadOptions.searchValue != '' ? 10 : 100); \n                                    return SkillsWorkflow.executeAPI('GET', 'companies/lookup',\n            null,\n            {}).then(function(res){ res.push({Id: '00000000-0000-0000-0000-000000000000', Name:'All companies'\n                });return res;\n            })\n        }\",\n                    \"byKey\": \"function(key) { return SW.executeAPI('GET','companies/'+key+'/lookup',null,{}).then( result =>  { return Promise.resolve(result);}) }\"\n    },\n    \"placeholder\": \"All companies\",\n    \"displayExpr\": \"Name\",\n    \"valueExpr\": \"Id\",\n    \"onValueChanged\": \"function(e){ \n                                        if( e.value != null && e.value != '') {\n                                            SkillsWorkflow.setDashboardFilter('Company', e.value);\n    } else {\n                                            SkillsWorkflow.setDashboardFilter('Company', '00000000-0000-0000-0000-000000000000');\n    }\n}\"\n}\n},\n{\n\"name\": \"Product\",\n\"dataField\": \"ProductCode\",\n\"editorType\": \"dxSelectBox\",\n\"editorOptions\": {\n\"width\": 250,\n\"showClearButton\": true,\n\"onInitialized\": \"function(e) { SW.setDashboardFilter('ProductCode', ''); }\",\n\"dataSource\": {\n    \"load\": \"function(loadOptions) { \n                    var query = `select distinct cast(puf.LongviewCode as nvarchar) ProductCode from CommercialClientProduct_UserFields puf order by 1`; \n                    return SW.executeAPI('POST', 'analytics/query/execute',\n    null,\n    {'query': query, 'parameters': {}\n    }).then(function(res){ return res.Data;\n    });\n}\",\n                \"byKey\": \"function(key) { }\"\n},\n\"value\": \"\",\n\"onValueChanged\": \"function(e) { \n                if(e.value != null) \n                    SW.setDashboardFilter('ProductCode', e.value); \n                else\n                    SW.setDashboardFilter('ProductCode', '');\n}\",\n            \"valueExpr\": \"ProductCode\",\n\"displayExpr\": \"ProductCode\"\n}\n}\n]\n}","DashboardDefinitionId":"8f1b9b6c-1245-41f7-9064-f45e8a94d2b8"},{"Id":"70efab31-6655-4a9e-9d14-d264fe5d79fe","Name":"Period Selector","Active":true,"UseQuery":false,"Query":null,"Size":12,"Order":2,"Parameters":"[\r\n    {\r\n        \"WidgetSubTitle\": \"Closed and In Progress Tickets\",\r\n        \"WidgetType\": \"rangeselector\",\r\n        \"WidgetFilterField\": \"\",\r\n        \"WidgetColor\": \"#efefef\",\r\n        \"WidgetXPosition\": 0,\r\n        \"WidgetYPosition\": 2,\r\n        \"WidgetRows\": 4,\r\n        \"WidgetColumns\": 48,\r\n        \"WidgetHeader\": {\r\n            \"WidgetPeriodChooser\": {\r\n                \"startDate\": \"2019-01-01\",\r\n                \"endDate\": \"2019-12-31\",\r\n                \"type\": \"year\",\r\n                \"visible\": false\r\n            },\r\n            \"showSubTitle\": false,\r\n            \"showTitle\": false\r\n        },\r\n        \"WidgetDataSources\": {\r\n            \"main\": {\r\n                \"type\": \"querytext\",\r\n                \"value\": \"SELECT  SUM(v.[Hours]) as [Hours],\\r\\n        v.[Month] \\r\\nFROM\\r\\n(\\r\\n        SELECT  SUM(v.ActualTime) as [Hours],\\r\\n                DATEFROMPARTS(v.[Year], v.[Month], 1) as [Month]\\r\\n        FROM    Analytics.Timesheet(@CurrentUserId) v\\r\\n        WHERE\\t(v.CompanyId = @CompanyId or @CompanyId = '00000000-0000-0000-0000-000000000000') and\\r\\n                v.Year = @Year\\r\\n        GROUP BY DATEFROMPARTS(v.[Year], v.[Month], 1)\\r\\n        UNION ALL\\r\\n        SELECT  SUM(v.[Hours]) as [Hours],\\r\\n                DATEFROMPARTS(v.[Year], v.[Month], 1) as [Month]\\r\\n        FROM    Analytics.Leave(@CurrentUserId) v\\r\\n        WHERE\\t(v.CompanyId = @CompanyId or @CompanyId = '00000000-0000-0000-0000-000000000000') and\\r\\n                v.Year = @Year\\r\\n        GROUP BY DATEFROMPARTS(v.[Year], v.[Month], 1)\\r\\n        UNION ALL\\r\\n        SELECT  SUM(v.[Hours]) as [Hours],\\r\\n                DATEFROMPARTS(v.[Year], v.[Month], 1) as [Month]\\r\\n        FROM    Analytics.Holiday(@CurrentUserId) v\\r\\n        WHERE\\t(v.CompanyId = @CompanyId or @CompanyId = '00000000-0000-0000-0000-000000000000') and\\r\\n                v.Year = @Year\\r\\n        GROUP BY DATEFROMPARTS(v.[Year], v.[Month], 1)\\r\\n) v\\r\\nGROUP BY v.[Month]\\r\\n\",\r\n                \"mapping\": \"\"\r\n            }\r\n        },\r\n        \"Filters\": {},\r\n        \"QueryConfiguration\": {\r\n            \"RequiredFilters\": [\r\n                \"Year\",\r\n                \"Company\"\r\n            ]\r\n        }\r\n    }\r\n]","DashboardComponentType":{"Id":"3c1da83b-efe9-4b70-87d0-c3813a512774","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Range_Selector/execute","Configuration":"{\"size\":{\"height\":100},\"containerBackgroundColor\":\"#e0e0e0\",\"selectedRangeColor\":\"#f5564a\",\"chart\":{\"commonSeriesSettings\":{\"type\":\"steparea\",\"argumentField\":\"Month\"},\"series\":[{\"valueField\":\"Hours\"}]},\"scale\":{\"minorTickInterval\":\"month\",\"tickInterval\":\"month\",\"valueType\":\"datetime\",\"label\":{\"font\":{\"family\":\"Varela Round\",\"weight\":800}}},\"sliderMarker\":{\"format\":\"monthAndDay\",\"color\":\"#da5859\",\"font\":{\"family\":\"Varela Round\",\"weight\":800}},\"value\":{\"startValue\":\"2019-01-01\",\"endValue\":\"2020-01-01\",\"length\":{\"months\":1}}}","DashboardDefinitionId":"8f1b9b6c-1245-41f7-9064-f45e8a94d2b8"},{"Id":"0fc66669-a225-49cd-a5a2-dd5868ecb2e4","Name":"User Projects","Active":true,"UseQuery":false,"Query":null,"Size":6,"Order":7,"Parameters":"[{\"WidgetSubTitle\":\"Different Projects the User was or is involved in\",\"WidgetType\":\"grid\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"\",\"WidgetXPosition\":24,\"WidgetYPosition\":18,\"WidgetRows\":16,\"WidgetColumns\":24,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":false,\"metricName\":\"# Forecast\",\"metricFieldValue\":\"TimeGrandTotal\"},{\"visible\":false,\"metricName\":\"# Actual\",\"metricFieldValue\":\"UtilizationPercentGrandTotal\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"WITH UsersCapacity AS\\n(\\n\\tSELECT \\n\\t\\tu.Oid AS UserId,\\n\\t\\t(\\n\\t\\t\\t(\\n\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\t(DATEDIFF(dd, @FromDate, @ToDate) + 1)\\n\\t\\t\\t\\t\\t-(DATEDIFF(wk, @FromDate, @ToDate) * 2)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @FromDate) = 'Sunday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @ToDate) = 'Saturday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t) + 1 \\n\\t\\t\\t)\\n\\t\\t\\t-\\n\\t\\t\\t(\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t\\t+\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t)\\n\\t\\t) * u.RequiredHours AS WorkingHours,\\n\\t\\t(SELECT ISNULL(SUM(dl.[Hours]), 0.0) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate) AS Leaves,\\n\\t\\t(SELECT ISNULL(SUM(dh.[Hours]), 0.0) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate) as Holidays\\n\\tFROM\\n\\t\\t[User] u\\n\\tWHERE\\n\\t\\tu.Oid = @UserId\\n),\\nUsersHours AS\\n(\\n\\tSELECT\\n\\t\\tdt.ClientGroup,\\n\\t\\tdt.Client,\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User],\\n\\t\\tdt.ProjectClassificationName,\\n\\t\\tdt.ProjectTypeName,\\n\\t\\tSUM(dt.ActualTime) AS [Hours],\\n\\t\\tSUM(dt.AdministrativeTime) AS [AdministrativeHours],\\n\\t\\tSUM(ISNULL(dt.InternalWorkTime, 0.0)) AS [InternalWorkHours],\\n\\t\\tSUM(dt.NewBusinessTime) AS [NewBusinessHours],\\n\\t\\tSUM(dt.BillableTime) AS [BillableHours],\\n\\t\\tSUM(ISNULL(dt.BillableTime, 0.0) - ISNULL(dt.[InternalWorkTime], 0.0)) as [ClientHours],\\n\\t\\tSUM(ISNULL(dt.[ActualTime] - (dt.[AdministrativeTime] + dt.[NewBusinessTime] + dt.[BillableTime]), 0.0)) as [NonWorkedHours]\\n\\tFROM \\n\\t\\tAnalytics.Timesheet(@CurrentUserId) dt\\n\\tWHERE\\n\\t\\tdt.[Date] BETWEEN @FromDate AND @ToDate\\n\\t\\tAND dt.UserId = @UserId\\n\\tGROUP BY\\n\\t\\tdt.ClientGroup,\\n\\t\\tdt.Client,\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User],\\n\\t\\tdt.ProjectClassificationName,\\n\\t\\tdt.ProjectTypeName\\n)\\nSELECT \\n\\tuh.ClientGroup,\\n\\tuh.Client,\\n\\tuh.[User],\\n\\tuh.ProjectClassificationName,\\n\\tuh.ProjectTypeName,\\n\\tuh.[Hours],\\n\\tuh.AdministrativeHours,\\n\\tuh.InternalWorkHours,\\n\\tuh.NewBusinessHours,\\n\\tuh.BillableHours,\\n\\tuh.ClientHours,\\n\\tuh.NonWorkedHours,\\n\\tuc.WorkingHours AS Capacity,\\n\\tuc.Leaves AS Leaves,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[BillableHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationPercentage,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[NewBusinessHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationNonBillablePercentage\\nFROM \\n\\tUsersHours uh,\\n\\tUsersCapacity uc\\nWHERE\\n\\tuh.UserId = uc.UserId\\n\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\",\"userId\",\"Company\",\"ProductCode\"]}}]","DashboardComponentType":{"Id":"3c1da83b-efe9-4b70-87d0-c3813a512774","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Per_Company_Department_User/execute","Configuration":"{\n  \"columnResizingMode\": \"widget\",\n  \"allowColumnResizing\": true,\n  \"allowFiltering\": true,\n  \"columnAutoWidth\": true,\n  \"grouping\": {\n    \"autoExpandAll\": true\n  },\n  \"searchPanel\": {\n    \"visible\": true\n  },\n  \"height\": 300,\n  \"scrolling\": {\n    \"mode\": \"virtual\"\n  },\n  \"selection\": {\n    \"mode\": \"none\"\n  },\n  \"columnMinWidth\": 80,\n  \"columns\": [\n    {\n      \"dataField\": \"Client\",\n      \"caption\": \"Client\",\n      \"width\": 120\n    },\n    {\n      \"dataField\": \"ProjectClassificationName\",\n      \"name\": \"ProjectClassificationName\",\n      \"caption\": \"Classification\",\n      \"width\": 120\n    },\n    {\n      \"dataField\": \"ProjectTypeName\",\n      \"name\": \"ProjectTypeName\",\n      \"caption\": \"Type\",\n      \"width\": 120,\n      \"groupIndex\": 0\n    },\n    {\n      \"dataField\": \"ClientHours\",\n      \"caption\": \"Client \",\n      \"name\": \"ClientHours\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n    {\n      \"dataField\": \"NewBusinessHours\",\n      \"caption\": \"Non-Billable\",\n      \"name\": \"NonBillable\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n    {\n      \"dataField\": \"BillableHours\",\n      \"caption\": \"Billable\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n        {\n          \"dataField\": \"UtilizationPercentage\",\n          \"caption\": \"Billable %\",\n          \"name\": \"Utilization\",\n          \"alignment\": \"right\",\n          \"format\": \"#,##0\",\n          \"cellTemplate\": \"function(e, i) {\n          SK.setRAG(e, (i.value * 100.0).toFixed(1), i.value >= 1.2 , i.value < 0.8, (i.value >= 0.8 && i.value < 1.2), true);\n        }\"\n      },\n      {\n        \"dataField\": \"UtilizationNonBillablePercentage\",\n        \"caption\": \"Non Billable %\",\n        \"name\": \"UtilizationNonBillable\",\n        \"alignment\": \"right\",\n        \"format\": \"#,##0\",\n        \"cellTemplate\": \"function(e, i) {\n          SK.setRAG(e, (i.value * 100.0).toFixed(1), i.value >= 1.2, i.value < 0.8, (i.value >= 0.8 && i.value < 1.2), true);\n      }\"\n}\n],\n\"sortByGroupSummaryInfo\": [\n{\n  \"summaryItem\": \"count\"\n}\n],\n\"summary\": {\n\"totalItems\": [\n  {\n    \"column\": \"Capacity\",\n    \"summaryType\": \"sum\",\n    \"valueFormat\": \"#,##0\",\n    \"displayFormat\": \"{0}\",\n    \"alignment\": \"right\"\n  },\n  {\n    \"column\": \"Leaves\",\n    \"summaryType\": \"sum\",\n    \"valueFormat\": \"#,##0\",\n    \"displayFormat\": \"{0}\",\n    \"alignment\": \"right\"\n  }\n]\n}\n}","DashboardDefinitionId":"8f1b9b6c-1245-41f7-9064-f45e8a94d2b8"}]}
