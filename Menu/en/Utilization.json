{
  "DashboardDefinitionRoles": [],
  "Id": "348304be-9130-4718-9177-9ad7c5b669bd",
  "Name": "Utilization",
  "Active": true,
  "Location": 0,
  "DocumentId": "00000000-0000-0000-0000-000000000000",
  "DocumentName": "",
  "DocumentsConfiguration": "{\"type\":\"\",\"operations\":{\"read\":{\"endpoint\":\"\"},\"update\":{\"endpoint\":\"\",\"model\":{}},\"create\":{\"endpoint\":\"\",\"model\":{}},\"remove\":{\"endpoint\":\"\"}},\"layout\":{\"create\":{},\"read\":{}},\"customDocument\":{\"mainColor\":\"\",\"secondaryColor\":\"\",\"imageClass\":\"\",\"namePlural\":\"\",\"name\":\"\",\"systemNames\":\"\"},\"availableOptions\":{\"feed\":false,\"info\":true,\"files\":false,\"userfields\":false,\"dashboard\":false}}",
  "Templates": [],
  "DashboardDefinitionComponents": [
    {
      "Id": "7e7c7efd-2718-4a60-a267-49b96a17369a",
      "Name": "Period Selector",
      "Active": true,
      "UseQuery": false,
      "Query": null,
      "Size": 8,
      "Order": 2,
      "Parameters": "[\r\n    {\r\n        \"WidgetSubTitle\": \"Closed and In Progress Tickets\",\r\n        \"WidgetType\": \"rangeselector\",\r\n        \"WidgetFilterField\": \"\",\r\n        \"WidgetColor\": \"#efefef\",\r\n        \"WidgetHeight\": \"\",\r\n        \"WidgetHeader\": {\r\n            \"WidgetPeriodChooser\": {\r\n                \"startDate\": \"2019-01-01\",\r\n                \"endDate\": \"2019-12-31\",\r\n                \"type\": \"year\",\r\n                \"visible\": false\r\n            },\r\n            \"showSubTitle\": false,\r\n            \"showTitle\": true\r\n        },\r\n        \"WidgetDataSources\": {\r\n            \"main\": {\r\n                \"type\": \"queryText\",\r\n                \"value\": \"SELECT\\r\\n\\tSUM(v.[Hours]) as [Hours],\\r\\n\\tv.[Month]\\r\\nFROM\\r\\n(\\r\\n\\tSELECT \\r\\n\\t\\tSUM(v.ActualTime) as [Hours],\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1) as [Month]\\r\\n\\tFROM\\r\\n\\t\\tAnalytics.Timesheet(@CurrentUserId) v\\r\\n\\tWHERE\\t\\r\\n\\t\\tv.[Date] between DateAdd(mm, -12, getdate()) and getdate()\\r\\n\\tGROUP BY\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1)\\r\\n\\tUNION ALL\\r\\n\\tSELECT \\r\\n\\t\\tSUM(v.[Hours]) as [Hours],\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1) as [Month]\\r\\n\\tFROM\\r\\n\\t\\tAnalytics.Leave(@CurrentUserId) v\\r\\n\\tWHERE\\t\\r\\n\\t\\tv.[Date] between DateAdd(mm, -12, getdate()) and getdate()\\r\\n\\tGROUP BY\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1)\\r\\n\\tUNION ALL\\r\\n\\tSELECT \\r\\n\\t\\tSUM(v.[Hours]) as [Hours],\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1) as [Month]\\r\\n\\tFROM\\r\\n\\t\\tAnalytics.Holiday(@CurrentUserId) v\\r\\n\\tWHERE\\t\\r\\n\\t\\tv.[Date] between DateAdd(mm, -12, getdate()) and getdate()\\r\\n\\tGROUP BY\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1)\\r\\n) v\\r\\nGROUP BY\\r\\n\\tv.[Month]\\r\\n\",\r\n                \"mapping\": \"\"\r\n            }\r\n        },\r\n        \"Filters\": {},\r\n        \"QueryConfiguration\": {}\r\n    }\r\n]",
      "DashboardComponentType": {
        "Id": "c666ba5e-8578-4132-86a5-0f96c665000d",
        "Name": "Generic Dashboard",
        "ComponentTypeNumber": 42
      },
      "AnalyticsApiUrl": "globalQuery/Analytics_Utilization_Range_Selector/execute",
      "Configuration": "{\n \"size\": {\n  \"height\": 200\n},\n  \"containerBackgroundColor\":\"#e0e0e0\",\n  \"selectedRangeColor\": \"#f5564a\",\n  \"chart\": {\n    \"commonSeriesSettings\": {\n      \"type\": \"steparea\",\n      \"argumentField\": \"Month\"\n    },\n    \"series\": [\n      {\n        \"valueField\": \"Hours\"\n      }\n    ]\n  },\n  \"scale\": {\n    \"minorTickInterval\": \"month\",\n    \"tickInterval\": \"month\",\n    \"valueType\": \"datetime\"\n  },\n  \"sliderMarker\": {\n    \"format\": \"monthAndDay\",\n    \"color\": \"#da5859\"\n  },\n  \"value\": {\n    \"startValue\": \"2019-08-01\",\n    \"endValue\": \"2019-9-01\",\n    \"length\": {\n      \"months\": 1\n    }\n  }\n}",
      "DashboardDefinitionId": "348304be-9130-4718-9177-9ad7c5b669bd"
    },
    {
      "Id": "6d5ef919-b143-4af3-9d32-65f689d0a75b",
      "Name": "Utilization per Project Type ",
      "Active": true,
      "UseQuery": false,
      "Query": null,
      "Size": 6,
      "Order": 4,
      "Parameters": "[\r\n    {\r\n        \"WidgetSubTitle\": \"Actual Hours per Project Type in % of Total\",\r\n        \"WidgetType\": \"chart\",\r\n        \"WidgetFilterField\": \"\",\r\n        \"WidgetColor\": \"#dddddd\",\r\n        \"WidgetHeight\": 0,\r\n        \"WidgetHeader\": {\r\n            \"showContextInfo\": false,\r\n            \"WidgetPeriodChooser\": {\r\n                \"type\": \"year\",\r\n                \"visible\": false\r\n            },\r\n            \"WidgetMetrics\": {\r\n                \"visible\": false,\r\n                \"Metrics\": [\r\n                    {\r\n                        \"visible\": true,\r\n                        \"metricName\": \"# Planned\",\r\n                        \"metricFieldValue\": \"PlannedTimeGrandTotal\"\r\n                    }\r\n                ]\r\n            },\r\n            \"showSubTitle\": true,\r\n            \"showTitle\": true\r\n        },\r\n        \"WidgetDataSources\": {\r\n            \"main\": {\r\n                \"type\": \"querytext\",\r\n                \"value\": \"\\t\\tSELECT\\t\\r\\n\\t\\t\\tv.ProjectTypeName,\\r\\n\\t\\t\\t(v.[Hours] / IIF(v.[TotalHours] > 0, v.[TotalHours], 1.0)) as UtilizationPercentage\\r\\n\\t\\tFROM\\t\\r\\n\\t\\t(\\r\\n\\t\\t\\tSELECT\\r\\n\\t\\t\\t\\tv.ProjectTypeName,\\t\\r\\n\\t\\t\\t\\tSUM(v.ActualTime) as [Hours],\\r\\n\\t\\t\\t\\tSUM(SUM(v.ActualTime)) OVER () as [TotalHours]\\r\\n\\t\\t\\tFROM\\r\\n\\t\\t\\t\\tAnalytics.Timesheet(@CurrentUserId) v\\r\\n\\t\\t\\tWHERE\\t\\r\\n\\t\\t\\t\\t(1 = 1)\\r\\n\\t\\t\\t\\tAND v.CompanyId = @CompanyOid\\r\\n\\t\\t\\t\\tAND (@DivisionOid = '00000000-0000-0000-0000-000000000000' OR v.DepartmentId IN (SELECT Oid FROM Department WHERE Division = @DivisionOid))\\r\\n\\t\\t\\t\\tAND (@DepartmentOid = '00000000-0000-0000-0000-000000000000' OR v.DepartmentId = @DepartmentOid)\\r\\n\\t\\t\\t\\t/*[DateFilter]*/ AND v.[Date] between @FromDate and @ToDate  /*[/DateFilter]*/\\r\\n\\t\\t\\tGROUP BY\\r\\n\\t\\t\\t\\tv.ProjectTypeName\\r\\n\\t\\t) v\\r\\n\",\r\n                \"mapping\": \"\"\r\n            }\r\n        },\r\n        \"Filters\": {},\r\n        \"QueryConfiguration\": {\r\n            \"RequiredFilters\": [\r\n                \"startDate\",\r\n                \"endDate\",\r\n                \"companyOid\",\r\n                \"divisionOid\",\r\n                \"departmentOid\"\r\n            ]\r\n        }\r\n    }\r\n]",
      "DashboardComponentType": {
        "Id": "c666ba5e-8578-4132-86a5-0f96c665000d",
        "Name": "Generic Dashboard",
        "ComponentTypeNumber": 42
      },
      "AnalyticsApiUrl": "globalQuery/Analytics_Utilization_Totals/execute",
      "Configuration": "{\n  \"commonSeriesSettings\": {\n    \"type\": \"bar\",\n    \"ignoreEmptyPoints\": true,\n    \"cornerRadius\": \"2px\",\n    \"label\": {\n      \"visible\": true,\n      \"showForZeroValues\": false,\n      \"format\": \"percent\"\n    },\n    \"argumentField\": \"ProjectTypeName\",\n    \"valueField\": \"UtilizationPercentage\"\n  },\n  \"size\": {\n    \"height\": 150\n  },\n  \"tooltip\": {\n    \"format\": \"percent\"\n  },\n  \"argumentAxis\": {\n    \"label\": {\n      \"font\": {\n        \"size\": 8\n      }\n    }\n  },\n  \"valueAxis\": {\n    \"label\": {\n      \"format\": \"percent\"\n    }\n  },\n  \"series\": [\n    {\n      \"label\": {\n        \"visible\": false,\n        \"format\": \"percent\"\n      }\n    }\n  ],\n  \"seriesTemplate\": {\n    \"nameField\": \"ProjectTypeName\"\n  },\n  \"legend\": {\n    \"visible\": false,\n    \"horizontalAlignment\": \"left\",\n    \"verticalAlignment\": \"middle\",\n    \"itemTextPosition\": \"right\",\n    \"paddingLeftRight\": 0,\n    \"font\": {\n      \"size\": 8\n    }\n  },\n  \"resolveLabelOverlapping\": \"shift\"\n}",
      "DashboardDefinitionId": "348304be-9130-4718-9177-9ad7c5b669bd"
    },
    {
      "Id": "e9a8693e-83da-4abc-a546-7b54c3332779",
      "Name": "Utilization per User",
      "Active": true,
      "UseQuery": false,
      "Query": null,
      "Size": 6,
      "Order": 5,
      "Parameters": "[\r\n    {\r\n        \"WidgetSubTitle\": \"Billable and Non-Billable Actual Hours in % of User Capacity\",\r\n        \"WidgetType\": \"grid\",\r\n        \"WidgetFilterField\": \"\",\r\n        \"WidgetColor\": \"\",\r\n        \"WidgetHeight\": 100,\r\n        \"WidgetHeader\": {\r\n            \"showContextInfo\": false,\r\n            \"WidgetPeriodChooser\": {\r\n                \"type\": \"year\",\r\n                \"visible\": false\r\n            },\r\n            \"WidgetMetrics\": {\r\n                \"visible\": false,\r\n                \"Metrics\": [\r\n                    {\r\n                        \"visible\": false,\r\n                        \"metricName\": \"# Forecast\",\r\n                        \"metricFieldValue\": \"TimeGrandTotal\"\r\n                    },\r\n                    {\r\n                        \"visible\": false,\r\n                        \"metricName\": \"# Actual\",\r\n                        \"metricFieldValue\": \"UtilizationPercentGrandTotal\"\r\n                    }\r\n                ]\r\n            },\r\n            \"showSubTitle\": true,\r\n            \"showTitle\": true\r\n        },\r\n        \"WidgetDataSources\": {\r\n            \"main\": {\r\n                \"type\": \"querytext\",\r\n                \"value\": \"WITH UsersCapacity AS\\n(\\n\\tSELECT \\n\\t\\tu.Oid AS UserId,\\n\\t\\t(\\n\\t\\t\\t(\\n\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\t(DATEDIFF(dd, @FromDate, @ToDate) + 1)\\n\\t\\t\\t\\t\\t-(DATEDIFF(wk, @FromDate, @ToDate) * 2)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @FromDate) = 'Sunday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @ToDate) = 'Saturday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t) + 1 \\n\\t\\t\\t)\\n\\t\\t\\t-\\n\\t\\t\\t(\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t\\t+\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t)\\n\\t\\t) * u.RequiredHours AS WorkingHours,\\n\\t\\t(SELECT ISNULL(SUM(dl.[Hours]), 0.0) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate) AS Leaves,\\n\\t\\t(SELECT ISNULL(SUM(dh.[Hours]), 0.0) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate) as Holidays\\n\\tFROM\\n\\t\\t[User] u\\n\\tWHERE\\n\\t\\tu.Company = @CompanyOid\\n),\\nUsersHours AS\\n(\\n\\tSELECT\\n\\t\\tdt.Department,\\n\\t\\tdt.UserTypologyGroup,\\t\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User],\\n\\t\\tSUM(dt.ActualTime) AS [Hours],\\n\\t\\tSUM(dt.AdministrativeTime) AS [AdministrativeHours],\\n\\t\\tSUM(ISNULL(dt.InternalWorkTime, 0.0)) AS [InternalWorkHours],\\n\\t\\tSUM(dt.NewBusinessTime) AS [NewBusinessHours],\\n\\t\\tSUM(dt.BillableTime) AS [BillableHours],\\n\\t\\tSUM(ISNULL(dt.BillableTime, 0.0) - ISNULL(dt.[InternalWorkTime], 0.0)) as [ClientHours],\\n\\t\\tSUM(ISNULL(dt.[ActualTime] - (dt.[AdministrativeTime] + dt.[NewBusinessTime] + dt.[BillableTime]), 0.0)) as [NonWorkedHours]\\n\\tFROM \\n\\t\\tAnalytics.Timesheet(@CurrentUserId) dt\\n\\tWHERE\\n\\t\\tdt.[Date] BETWEEN @FromDate AND @ToDate\\n\\t\\tAND dt.CompanyId = @CompanyOid\\n\\t\\tAND (@DivisionOid = '00000000-0000-0000-0000-000000000000' OR dt.DepartmentId IN (SELECT Oid FROM Department WHERE Division = @DivisionOid))\\n\\t\\tAND (@DepartmentOid = '00000000-0000-0000-0000-000000000000' OR dt.DepartmentId = @DepartmentOid)\\n\\tGROUP BY\\n\\t\\tdt.Department,\\n\\t\\tdt.UserTypologyGroup,\\t\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User]\\n)\\nSELECT \\n\\tuh.Department,\\n\\tuh.UserTypologyGroup,\\n\\tuh.[User],\\n\\tut.[Name] as UserType,\\n\\tuh.UserId,\\n\\tuh.[Hours],\\n\\tuh.AdministrativeHours,\\n\\tuh.InternalWorkHours,\\n\\tuh.NewBusinessHours,\\n\\tuh.BillableHours,\\n\\tuh.ClientHours,\\n\\tuh.NonWorkedHours,\\n\\tuc.WorkingHours AS Capacity,\\n\\tuc.Leaves AS Leaves,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[BillableHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationPercentage,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[NewBusinessHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationNonBillablePercentage\\nFROM \\n\\tUsersHours uh,\\n\\tUsersCapacity uc,\\n\\t[User] u\\n\\tLEFT OUTER JOIN UserType ut ON (ut.Oid = u.UserType)\\nWHERE\\n\\tuh.UserId = uc.UserId\\n\\tAND u.Oid = uc.UserId\\n\"\r\n            }\r\n        },\r\n        \"Filters\": {},\r\n        \"QueryConfiguration\": {\r\n            \"RequiredFilters\": [\r\n                \"startDate\",\r\n                \"endDate\",\r\n                \"companyOid\",\r\n                \"divisionOid\",\r\n                \"departmentOid\"\r\n            ]\r\n        }\r\n    }\r\n]",
      "DashboardComponentType": {
        "Id": "c666ba5e-8578-4132-86a5-0f96c665000d",
        "Name": "Generic Dashboard",
        "ComponentTypeNumber": 42
      },
      "AnalyticsApiUrl": "globalQuery/Analytics_Utilization_Per_Company_Department_User/execute",
      "Configuration": "{\n  \"headerFilter\": {\n    \"visible\": true\n  },\n  \"grouping\" : {\n    \"autoExpandAll\" : true\n  },\n  \"columnResizingMode\": \"widget\",\n  \"allowColumnResizing\": true,\n  \"allowFiltering\": true,\n  \"columnAutoWidth\": true,\n  \"searchPanel\": {\n    \"visible\": true\n  },\n  \"selection\": {\n    \"mode\": \"single\"\n  },\n\"onSelectionChanged\": \"function (selectedItems) {\n            var data = selectedItems.selectedRowsData[0];\n            if(data) {\n                SkillsWorkflow.setDashboardFilter('userOid', data.UserId);\n          }\n  }\",\n  \"height\": \"100%\",\n  \"scrolling\": {\n    \"mode\": \"virtual\"\n  },\n  \"columnMinWidth\": 80,\n  \"columns\": [\n    {\n      \"dataField\": \"Department\",\n      \"caption\": \"Department\",\n      \"width\": 120,\n      \"groupIndex\": 0\n    },\n    {\n      \"dataField\": \"UserTypologyGroup\",\n      \"name\": \"Typology Group\",\n      \"caption\": \"Typology\",\n      \"width\": 120\n    },\n    {\n      \"dataField\": \"UserId\",\n      \"name\": \"Picture\",\n      \"caption\": \"Picture\",\n      \"width\": 30,\n      \"alignment\": \"left\",\n      \"cellTemplate\": \"function(e, i) {\n        console.log(i.text);\n        console.log(i.data.User);\n        SK.showImage(e, 'user', 'small', i.text, i.data.User);\n    }\"\n  },\n    {\n      \"dataField\": \"User\",\n      \"name\": \"User\",\n      \"caption\": \"User\",\n      \"width\": 120\n    },\n    {\n      \"dataField\": \"UserType\",\n      \"name\": \"UserType\",\n      \"caption\": \"User Type\",\n      \"width\": 120\n    },\n    {\n      \"dataField\": \"Capacity\",\n      \"caption\": \"Capacity\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n    {\n      \"dataField\": \"Leaves\",\n      \"caption\": \"Leaves\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n    {\n      \"dataField\": \"NewBusinessHours\",\n      \"caption\": \"Non-Billable\",\n      \"name\": \"NonBillable\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n    {\n      \"dataField\": \"AdministrativeHours\",\n      \"caption\": \"Admin\",\n      \"name\": \"Admin\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n    {\n      \"dataField\": \"BillableHours\",\n      \"caption\": \"Billable\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n    {\n      \"caption\": \"Utilization\",\n              \"alignment\": \"center\",\n              \"columns\": [\n            {\n              \"dataField\": \"UtilizationNonBillablePercentage\",\n              \"caption\": \"Non Billable %\",\n              \"name\": \"UtilizationNonBillable\",\n              \"alignment\": \"right\",\n              \"format\": \"#,##0\",\n              \"cellTemplate\": \"function(e, i) {\n                  SkillsWorkflow.setRAG(e, (i.value * 100.0).toFixed(1) + '%', i.value >= 1.2, i.value < 0.8, (i.value >= 0.8 && i.value < 1.2), true);\n            }\n              \"\n          },\n          {\n            \"dataField\": \"UtilizationPercentage\",\n            \"caption\": \"Billable %\",\n            \"name\": \"Utilization\",\n            \"alignment\": \"right\",\n            \"format\": \"#,##0\",\n            \"cellTemplate\": \"function(e, i) {\n                  SkillsWorkflow.setRAG(e, (i.value * 100.0).toFixed(1) + '%', i.value >= 1.2, i.value < 0.8, (i.value >= 0.8 && i.value < 1.2), true);\n          }\n              \"\n        }\n      ]\n    }\n  ],\n  \"sortByGroupSummaryInfo\": [\n    {\n      \"summaryItem\": \"count\"\n    }\n  ],\n  \"summary\": {\n    \"totalItems\": [\n      {\n        \"column\": \"Capacity\",\n        \"summaryType\": \"sum\",\n        \"valueFormat\": \"#,##0\",\n        \"displayFormat\": \"{0}\",\n        \"alignment\": \"right\"\n      },\n      {\n        \"column\": \"Leaves\",\n        \"summaryType\": \"sum\",\n        \"valueFormat\": \"#,##0\",\n        \"displayFormat\": \"{0}\",\n        \"alignment\": \"right\"\n      }\n    ]\n  }\n}",
      "DashboardDefinitionId": "348304be-9130-4718-9177-9ad7c5b669bd"
    },
    {
      "Id": "c45328c3-47ea-4dd5-9582-7ecae636c782",
      "Name": "User Projects",
      "Active": true,
      "UseQuery": false,
      "Query": null,
      "Size": 6,
      "Order": 6,
      "Parameters": "[{\"WidgetSubTitle\":\"Different Projects the User was or is involved in\",\"WidgetType\":\"grid\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"\",\"WidgetHeight\":100,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":false,\"metricName\":\"# Forecast\",\"metricFieldValue\":\"TimeGrandTotal\"},{\"visible\":false,\"metricName\":\"# Actual\",\"metricFieldValue\":\"UtilizationPercentGrandTotal\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"WITH UsersCapacity AS\\n(\\n\\tSELECT \\n\\t\\tu.Oid AS UserId,\\n\\t\\t(\\n\\t\\t\\t(\\n\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\t(DATEDIFF(dd, @FromDate, @ToDate) + 1)\\n\\t\\t\\t\\t\\t-(DATEDIFF(wk, @FromDate, @ToDate) * 2)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @FromDate) = 'Sunday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @ToDate) = 'Saturday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t) + 1 \\n\\t\\t\\t)\\n\\t\\t\\t-\\n\\t\\t\\t(\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t\\t+\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t)\\n\\t\\t) * u.RequiredHours AS WorkingHours,\\n\\t\\t(SELECT ISNULL(SUM(dl.[Hours]), 0.0) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate) AS Leaves,\\n\\t\\t(SELECT ISNULL(SUM(dh.[Hours]), 0.0) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate) as Holidays\\n\\tFROM\\n\\t\\t[User] u\\n\\tWHERE\\n\\t\\tu.Oid = @UserOid\\n),\\nUsersHours AS\\n(\\n\\tSELECT\\n\\t\\tdt.ClientGroup,\\n\\t\\tdt.Client,\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User],\\n\\t\\tdt.ProjectClassificationName,\\n\\t\\tdt.ProjectTypeName,\\n\\t\\tSUM(dt.ActualTime) AS [Hours],\\n\\t\\tSUM(dt.AdministrativeTime) AS [AdministrativeHours],\\n\\t\\tSUM(ISNULL(dt.InternalWorkTime, 0.0)) AS [InternalWorkHours],\\n\\t\\tSUM(dt.NewBusinessTime) AS [NewBusinessHours],\\n\\t\\tSUM(dt.BillableTime) AS [BillableHours],\\n\\t\\tSUM(ISNULL(dt.BillableTime, 0.0) - ISNULL(dt.[InternalWorkTime], 0.0)) as [ClientHours],\\n\\t\\tSUM(ISNULL(dt.[ActualTime] - (dt.[AdministrativeTime] + dt.[NewBusinessTime] + dt.[BillableTime]), 0.0)) as [NonWorkedHours]\\n\\tFROM \\n\\t\\tAnalytics.Timesheet(@CurrentUserId) dt\\n\\tWHERE\\n\\t\\tdt.[Date] BETWEEN @FromDate AND @ToDate\\n\\t\\tAND dt.UserId = @UserOid\\n\\tGROUP BY\\n\\t\\tdt.ClientGroup,\\n\\t\\tdt.Client,\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User],\\n\\t\\tdt.ProjectClassificationName,\\n\\t\\tdt.ProjectTypeName\\n)\\nSELECT \\n\\tuh.ClientGroup,\\n\\tuh.Client,\\n\\tuh.[User],\\n\\tuh.ProjectClassificationName,\\n\\tuh.ProjectTypeName,\\n\\tuh.[Hours],\\n\\tuh.AdministrativeHours,\\n\\tuh.InternalWorkHours,\\n\\tuh.NewBusinessHours,\\n\\tuh.BillableHours,\\n\\tuh.ClientHours,\\n\\tuh.NonWorkedHours,\\n\\tuc.WorkingHours AS Capacity,\\n\\tuc.Leaves AS Leaves,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[BillableHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationPercentage,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[NewBusinessHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationNonBillablePercentage\\nFROM \\n\\tUsersHours uh,\\n\\tUsersCapacity uc\\nWHERE\\n\\tuh.UserId = uc.UserId\\n\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\",\"userOid\"]}}]",
      "DashboardComponentType": {
        "Id": "c666ba5e-8578-4132-86a5-0f96c665000d",
        "Name": "Generic Dashboard",
        "ComponentTypeNumber": 42
      },
      "AnalyticsApiUrl": "globalQuery/Analytics_Utilization_Per_Company_Department_User/execute",
      "Configuration": "{\n  \"headerFilter\": {\n    \"visible\": true\n  },\n  \"columnResizingMode\": \"widget\",\n  \"allowColumnResizing\": true,\n  \"allowFiltering\": true,\n  \"columnAutoWidth\": true,\n  \"grouping\": {\n    \"autoExpandAll\": true\n  },\n  \"searchPanel\": {\n    \"visible\": true\n  },\n  \"height\": \"100%\",\n  \"scrolling\": {\n    \"mode\": \"virtual\"\n  },\n  \"selection\": {\n    \"mode\": \"none\"\n  },\n  \"columnMinWidth\": 80,\n  \"columns\": [\n    {\n      \"dataField\": \"Client\",\n      \"caption\": \"Client\",\n      \"width\": 120\n    },\n    {\n      \"dataField\": \"ProjectClassificationName\",\n      \"name\": \"ProjectClassificationName\",\n      \"caption\": \"Classification\",\n      \"width\": 120\n    },\n    {\n      \"dataField\": \"ProjectTypeName\",\n      \"name\": \"ProjectTypeName\",\n      \"caption\": \"Type\",\n      \"width\": 120,\n      \"groupIndex\": 0\n    },\n    {\n      \"dataField\": \"ClientHours\",\n      \"caption\": \"Client \",\n      \"name\": \"ClientHours\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n    {\n      \"dataField\": \"NewBusinessHours\",\n      \"caption\": \"Non-Billable\",\n      \"name\": \"NonBillable\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n    {\n      \"dataField\": \"BillableHours\",\n      \"caption\": \"Billable\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\"\n    },\n    {\n      \"caption\": \"Utilization\",\n      \"alignment\": \"center\",\n      \"columns\": [\n        {\n          \"dataField\": \"UtilizationPercentage\",\n          \"caption\": \"Billable %\",\n          \"name\": \"Utilization\",\n          \"alignment\": \"right\",\n          \"format\": \"#,##0\",\n          \"cellTemplate\": \"function(e, i) {\n          SK.setRAG(e, (i.value * 100.0).toFixed(1), i.value >= 1.2, i.value < 0.8, (i.value >= 0.8 && i.value < 1.2), true);\n        }\n      \"\n      },\n      {\n        \"dataField\": \"UtilizationNonBillablePercentage\",\n        \"caption\": \"Non Billable %\",\n        \"name\": \"UtilizationNonBillable\",\n        \"alignment\": \"right\",\n        \"format\": \"#,##0\",\n        \"cellTemplate\": \"function(e, i) {\n          SK.setRAG(e, (i.value * 100.0).toFixed(1), i.value >= 1.2, i.value < 0.8, (i.value >= 0.8 && i.value < 1.2), true);\n      }\n      \"\n    }\n  ]\n}\n],\n\"sortByGroupSummaryInfo\": [\n{\n  \"summaryItem\": \"count\"\n}\n],\n\"summary\": {\n\"totalItems\": [\n  {\n    \"column\": \"Capacity\",\n    \"summaryType\": \"sum\",\n    \"valueFormat\": \"#,##0\",\n    \"displayFormat\": \"{0}\",\n    \"alignment\": \"right\"\n  },\n  {\n    \"column\": \"Leaves\",\n    \"summaryType\": \"sum\",\n    \"valueFormat\": \"#,##0\",\n    \"displayFormat\": \"{0}\",\n    \"alignment\": \"right\"\n  }\n]\n}\n}",
      "DashboardDefinitionId": "348304be-9130-4718-9177-9ad7c5b669bd"
    },
    {
      "Id": "7b0a0b96-6b56-4daa-82dc-81610b9f4958",
      "Name": "Company and Client Group",
      "Active": true,
      "UseQuery": false,
      "Query": null,
      "Size": 4,
      "Order": 0,
      "Parameters": "[{\"WidgetSubTitle\":\"Choose a Company or Client Group\",\"WidgetType\":\"form\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#efefef\",\"WidgetHeight\":0,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":false,\"metricName\":\"# Forecast\",\"metricFieldValue\":\"TimeGrandTotal\"},{\"visible\":false,\"metricName\":\"# Actual\",\"metricFieldValue\":\"UtilizationPercentGrandTotal\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"SELECT 1;\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[]}}]",
      "DashboardComponentType": {
        "Id": "c666ba5e-8578-4132-86a5-0f96c665000d",
        "Name": "Generic Dashboard",
        "ComponentTypeNumber": 42
      },
      "AnalyticsApiUrl": "globalQuery/Analytics_Utilization_Per_Company_Department_User/execute",
      "Configuration": "{\n  \"height\": 172,\n  \"size\": {\n    \"height\": 172\n  },\n  \"colCount\": 1,\n  \"formData\": {\n    \"company\": \"Company\",\n    \"clientGroup\": \"Client Group\"\n  },\n  \"dataSource\": {\n    \"company\": \"Company\",\n    \"clientGroup\": \"Client Group\"\n  },\n  \"items\": [\n    {\n      \"name\": \"Company\",\n      \"dataField\": \"company\",\n      \"editorType\": \"dxSelectBox\",\n      \"editorOptions\": {\n        \"searchEnabled\": true,\n        \"dataSource\": {\n            \"load\": \"function(loadOptions){ var query = 'SELECT DISTINCT c.Oid as Id, c.[Name] FROM Company c, SkillUsersCompanies suc where suc.Company = c.Oid and suc.[User] = @CurrentUserId ORDER BY c.[Name]'; return SW.executeAPI('POST', 'analytics/query/execute', null, {'query': query, 'parameters': {}}).then(function(res){ return res.Data; }); }\",\n            \"byKey\": \"function(key) { console.log('byKey'); }\"\n        },\n        \"value\": \"\",\n        \"onValueChanged\": \"function(e){ console.log('Value:' + e.value); if(e.value != null) { SW.setDashboardFilter('divisionOid', '00000000-0000-0000-0000-000000000000'); SW.setDashboardFilter('departmentOid', '00000000-0000-0000-0000-000000000000'); SW.setDashboardFilter('companyOid', e.value);} }\",\n        \"valueExpr\": \"Id\",\n        \"displayExpr\": \"Name\"\n      },\n      \"noDataText\": \"Please wait...\"\n    },\n    {\n      \"name\": \"Division\",\n      \"dataField\": \"division\",\n      \"editorType\": \"dxSelectBox\",\n      \"editorOptions\": {\n        \"searchEnabled\": true,\n        \"dataSource\": {\n          \"load\": \"function(loadOptions){ var query = 'SELECT Id, [Name] FROM (SELECT \\\\'00000000-0000-0000-0000-000000000000\\\\' as Id, \\\\'\\\\' as [Name] UNION ALL SELECT DISTINCT dv.Oid as Id, dv.[Name] FROM Division dv, SkillUsersCompaniesDivisions sudv where sudv.Division = dv.Oid and sudv.[User] = @CurrentUserId) v ORDER BY v.[Name]'; return SW.executeAPI('POST', 'analytics/query/execute', null, {'query': query, 'parameters': {}}).then(function(res){ return res.Data; }); }\",\n          \"byKey\": \"function(key) { console.log('byKey'); }\"\n        },\n        \"value\": \"\",\n        \"onValueChanged\": \"function(e){ console.log('Value:' + e.value); if(e.value != null) { SW.setDashboardFilter('departmentOid', '00000000-0000-0000-0000-000000000000'); SW.setDashboardFilter('divisionOid', e.value); } }\",\n        \"valueExpr\": \"Id\",\n        \"displayExpr\": \"Name\"\n      },\n      \"noDataText\": \"Please wait...\"\n    },\n    {\n      \"name\": \"Department\",\n      \"dataField\": \"department\",\n      \"editorType\": \"dxSelectBox\",\n      \"editorOptions\": {\n        \"searchEnabled\": true,\n        \"dataSource\": {\n          \"load\": \"function(loadOptions){ var query = 'SELECT Id, [Name] FROM (SELECT \\\\'00000000-0000-0000-0000-000000000000\\\\' as Id, \\\\'\\\\' as [Name] UNION ALL SELECT DISTINCT dp.Oid as Id, dp.[Name] FROM Department dp, SkillUsersCompaniesDivisionsDepartments sudp where sudp.Department = dp.Oid and sudp.[User] = @CurrentUserId) v ORDER BY v.[Name]'; return SW.executeAPI('POST', 'analytics/query/execute', null, {'query': query, 'parameters': {}}).then(function(res){ return res.Data; }); }\",\n          \"byKey\": \"function(key) { console.log('byKey'); }\"\n        },\n        \"value\": \"\",\n        \"onValueChanged\": \"function(e){ console.log('Value:' + e.value); if(e.value != null) { SW.setDashboardFilter('departmentOid', e.value); } }\",\n        \"valueExpr\": \"Id\",\n        \"displayExpr\": \"Name\"\n      },\n      \"noDataText\": \"Please wait...\"\n    },\n    {\n      \"name\": \"Client Group\",\n      \"dataField\": \"clientGroup\",\n      \"editorType\": \"dxSelectBox\",\n      \"editorOptions\": {\n        \"searchEnabled\": true,\n        \"minSearchLength\": 0,\n        \"dataSource\": {\n          \"load\": \"function(loadOptions){ var query = 'SELECT cg.Oid as Id, cg.[Name] FROM CLientGroup cg ORDER BY cg.[Name]'; return SW.executeAPI('POST', 'analytics/query/execute', null, {'query': query, 'parameters': {}}).then(function(res){ return res.Data; }); }\",\n          \"byKey\": \"function(key) { console.log('byKey'); }\"\n        },\n        \"value\": \"\",\n        \"onValueChanged\": \"function(e){ console.log('Value:' + e.value); if(e.value != null) { SW.setDashboardFilter('clientGroupId', e.value); } }\",\n        \"valueExpr\": \"Id\",\n        \"displayExpr\": \"Name\"\n      },\n      \"noDataText\": \"Please wait...\"\n    }\n  ]\n}",
      "DashboardDefinitionId": "348304be-9130-4718-9177-9ad7c5b669bd"
    },
    {
      "Id": "2eec60e3-cbd0-4174-9ddc-989832016857",
      "Name": "Utilization per Client  ",
      "Active": true,
      "UseQuery": false,
      "Query": null,
      "Size": 6,
      "Order": 3,
      "Parameters": "[\r\n    {\r\n        \"WidgetSubTitle\": \"Actual Hours per Client in % of Total\",\r\n        \"WidgetType\": \"chart\",\r\n        \"WidgetFilterField\": \"\",\r\n        \"WidgetColor\": \"#dddddd\",\r\n        \"WidgetHeight\": 0,\r\n        \"WidgetHeader\": {\r\n            \"showContextInfo\": false,\r\n            \"WidgetPeriodChooser\": {\r\n                \"type\": \"year\",\r\n                \"visible\": false\r\n            },\r\n            \"WidgetMetrics\": {\r\n                \"visible\": false,\r\n                \"Metrics\": [\r\n                    {\r\n                        \"visible\": true,\r\n                        \"metricName\": \"# Planned\",\r\n                        \"metricFieldValue\": \"PlannedTimeGrandTotal\"\r\n                    }\r\n                ]\r\n            },\r\n            \"showSubTitle\": true,\r\n            \"showTitle\": true\r\n        },\r\n        \"WidgetDataSources\": {\r\n            \"main\": {\r\n                \"type\": \"querytext\",\r\n                \"value\": \"\\t\\tSELECT\\t\\r\\n\\t\\t\\tv.Client,\\r\\n\\t\\t\\t(v.[Hours] / IIF(v.[TotalHours] > 0, v.[TotalHours], 1.0)) as UtilizationPercentage\\r\\n\\t\\tFROM\\t\\r\\n\\t\\t(\\r\\n\\t\\t\\tSELECT\\r\\n\\t\\t\\t\\tv.Client,\\t\\r\\n\\t\\t\\t\\tSUM(v.ActualTime) as [Hours],\\r\\n\\t\\t\\t\\tSUM(SUM(v.ActualTime)) OVER () as [TotalHours]\\r\\n\\t\\t\\tFROM\\r\\n\\t\\t\\t\\tAnalytics.Timesheet(@CurrentUserId) v\\r\\n\\t\\t\\tWHERE\\t\\r\\n\\t\\t\\t\\tv.CompanyId = @CompanyOid\\r\\n\\t\\t\\t\\tAND (@DivisionOid = '00000000-0000-0000-0000-000000000000' OR v.DepartmentId IN (SELECT Oid FROM Department WHERE Division = @DivisionOid))\\r\\n\\t\\t\\t\\tAND (@DepartmentOid = '00000000-0000-0000-0000-000000000000' OR v.DepartmentId = @DepartmentOid)\\r\\n\\t\\t\\t\\t/*[DateFilter]*/ AND v.[Date] between @FromDate and @ToDate  /*[/DateFilter]*/\\r\\n\\t\\t\\tGROUP BY\\r\\n\\t\\t\\t\\tv.Client\\r\\n\\t\\t) v\\r\\n\\t\\tORDER BY (v.[Hours] / IIF(v.[TotalHours] > 0, v.[TotalHours], 1.0)) DESC\\r\\n\",\r\n                \"mapping\": \"\"\r\n            }\r\n        },\r\n        \"Filters\": {},\r\n        \"QueryConfiguration\": {\r\n            \"RequiredFilters\": [\r\n                \"startDate\",\r\n                \"endDate\",\r\n                \"companyOid\",\r\n                \"divisionOid\",\r\n                \"departmentOid\"\r\n            ]\r\n        }\r\n    }\r\n]",
      "DashboardComponentType": {
        "Id": "c666ba5e-8578-4132-86a5-0f96c665000d",
        "Name": "Generic Dashboard",
        "ComponentTypeNumber": 42
      },
      "AnalyticsApiUrl": "globalQuery/Analytics_Utilization_Totals/execute",
      "Configuration": "{\n  \"commonSeriesSettings\": {\n    \"type\": \"bar\",\n    \"ignoreEmptyPoints\": true,\n    \"cornerRadius\": \"2px\",\n    \"label\": {\n      \"visible\": true,\n      \"showForZeroValues\": false,\n      \"format\": \"percent\"\n    }\n  },\n  \"size\": {\n    \"height\": 150\n  },\n  \"tooltip\": {\n    \"format\": \"percent\"\n  },\n  \"argumentAxis\": {\n    \"label\": {\n      \"font\": {\n        \"size\": 8\n      }\n    }\n  },\n  \"valueAxis\": {\n    \"label\": {\n      \"format\": \"percent\"\n    }\n  },\n  \"series\": [\n    {\n      \"name\":\"Client\",\n      \"argumentField\": \"Client\",\n      \"valueField\": \"UtilizationPercentage\",\n      \"label\": {\n        \"visible\": false,\n        \"format\": \"percent\"\n      }\n    }\n  ],\n  \"legend\": {\n    \"visible\": false,\n    \"horizontalAlignment\": \"left\",\n    \"verticalAlignment\": \"middle\",\n    \"itemTextPosition\": \"right\",\n    \"paddingLeftRight\": 0,\n    \"font\": {\n      \"size\": 8\n    }\n  },\n  \"resolveLabelOverlapping\": \"shift\",\n  \"dataPrepareSettings\": {\n    \"sortingMethod\": false\n  }\n}",
      "DashboardDefinitionId": "348304be-9130-4718-9177-9ad7c5b669bd"
    }
  ]
}
