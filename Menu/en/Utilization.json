{"DashboardDefinitionRoles":[{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"5c2e7024-eaf4-43fa-96d3-9ad61b011657","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Finance Profile"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"4a6dc5d0-7bc1-4501-9cf3-e49288a8e5f1","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Finance Confidential Profile"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"5c2e7024-eaf4-43fa-96d3-9ad61b011657","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Finance Profile"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"4a6dc5d0-7bc1-4501-9cf3-e49288a8e5f1","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Finance Confidential Profile"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"5c2e7024-eaf4-43fa-96d3-9ad61b011657","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Finance Profile"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"d3e36f3b-993f-4b56-8664-bc616956b733","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Maintenance Profile"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"5c2e7024-eaf4-43fa-96d3-9ad61b011657","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Finance Profile"},{"AccessRoleId":"5c2e7024-eaf4-43fa-96d3-9ad61b011657","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Finance Profile"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"5c2e7024-eaf4-43fa-96d3-9ad61b011657","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Finance Profile"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"d3e36f3b-993f-4b56-8664-bc616956b733","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Maintenance Profile"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"5c2e7024-eaf4-43fa-96d3-9ad61b011657","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Finance Profile"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"9192b3d9-3b6b-469a-bcf4-01accd8ec5b4","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Administrator"},{"AccessRoleId":"5c2e7024-eaf4-43fa-96d3-9ad61b011657","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","AccessRoleName":"Finance Profile"}],"Id":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14","Name":"Utilization","Active":true,"Location":0,"DocumentId":"00000000-0000-0000-0000-000000000000","DocumentName":"","DocumentsConfiguration":"{\"type\":\"\",\"operations\":{\"read\":{\"endpoint\":\"\"},\"update\":{\"endpoint\":\"\",\"model\":{}},\"create\":{\"endpoint\":\"\",\"model\":{}},\"remove\":{\"endpoint\":\"\"}},\"layout\":{\"create\":{},\"read\":{}},\"customDocument\":{\"mainColor\":\"\",\"secondaryColor\":\"\",\"imageClass\":\"\",\"namePlural\":\"\",\"name\":\"\",\"systemNames\":\"\"},\"availableOptions\":{\"feed\":false,\"info\":true,\"files\":false,\"userfields\":false,\"dashboard\":false}}","Templates":[],"DashboardDefinitionComponents":[{"Id":"8f1c5cf8-ba54-447c-a82d-17158d22f87b","Name":"Period Selector","Active":true,"UseQuery":false,"Query":null,"Size":12,"Order":2,"Parameters":"[{\"WidgetSubTitle\":\"Closed and In Progress Tickets\",\"WidgetType\":\"rangeselector\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#efefef\",\"WidgetHeight\":50,\"WidgetHeader\":{\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"showSubTitle\":false,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"with userType as (\\r\\n\\tSELECT\\r\\n\\t\\tv.Oid,\\r\\n\\t\\tv.UserTypeId\\r\\n\\tFROM \\r\\n\\t\\tAnalytics.DatamartUser v\\r\\n\\tGROUP BY\\r\\n\\t\\tv.Oid,\\r\\n\\t\\tv.UserTypeId\\r\\n)\\r\\nSELECT\\r\\n\\tSUM(v.[Hours]) as [Hours],\\r\\n\\tv.[Month]\\r\\nFROM\\r\\n(\\r\\n\\tSELECT \\r\\n\\t\\tSUM(v.ActualTime) as [Hours],\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1) as [Month]\\r\\n\\tFROM\\r\\n\\t\\tAnalytics.Timesheet(@CurrentUserId) v, userType ut\\r\\n\\tWHERE\\t\\r\\n\\t\\tYear(v.[Date]) = @year\\r\\n\\t\\tand (v.CompanyId = @CompanyOid or @CompanyOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tand (v.DivisionId = @DivisionOid or @DivisionOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tand (v.DepartmentId = @DepartmentOid or @DepartmentOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tand v.UserId = ut.Oid \\r\\n\\t\\tand (ut.UserTypeId = @UserType or @UserType = '00000000-0000-0000-0000-000000000000')\\r\\n\\tGROUP BY\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1)\\r\\n\\tUNION ALL\\r\\n\\tSELECT \\r\\n\\t\\tSUM(v.[Hours]) as [Hours],\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1) as [Month]\\r\\n\\tFROM\\r\\n\\t\\tAnalytics.Leave(@CurrentUserId) v, userType ut\\r\\n\\tWHERE\\t\\r\\n\\t\\tYear(v.[Date]) = @year\\r\\n\\t\\tand (v.CompanyId = @CompanyOid or @CompanyOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tand (v.DivisionId = @DivisionOid or @DivisionOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tand (v.DepartmentId = @DepartmentOid or @DepartmentOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tand v.UserId = ut.Oid \\r\\n\\t\\tand (ut.UserTypeId = @UserType or @UserType = '00000000-0000-0000-0000-000000000000')\\r\\n\\tGROUP BY\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1)\\r\\n\\tUNION ALL\\r\\n\\tSELECT \\r\\n\\t\\tSUM(v.[Hours]) as [Hours],\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1) as [Month]\\r\\n\\tFROM\\r\\n\\t\\tAnalytics.Holiday(@CurrentUserId) v, userType ut\\r\\n\\tWHERE\\t\\r\\n\\t\\tYear(v.[Date]) = @year\\r\\n\\t\\tand (v.CompanyId = @CompanyOid or @CompanyOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tand (@DivisionOid = '00000000-0000-0000-0000-000000000000' or v.DepartmentId = (select d.Division from Department d where d.Oid = @DepartmentOid))\\r\\n\\t\\tand (v.DepartmentId = @DepartmentOid or @DepartmentOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tand v.UserId = ut.Oid \\r\\n\\t\\tand (ut.UserTypeId = @UserType or @UserType = '00000000-0000-0000-0000-000000000000')\\r\\n\\tGROUP BY\\r\\n\\t\\tDATEFROMPARTS(v.[Year], v.[Month], 1)\\r\\n) v\\r\\nGROUP BY\\r\\n\\tv.[Month]\\r\\n\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"year\",\"CompanyOid\",\"DivisionOid\",\"DepartmentOid\",\"UserType\"]}}]","DashboardComponentType":{"Id":"c666ba5e-8578-4132-86a5-0f96c665000d","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Range_Selector/execute","Configuration":"{\r\n    \"containerBackgroundColor\": \"#e0e0e0\",\r\n    \"selectedRangeColor\": \"#f5564a\",\r\n    \"size\": {\r\n        \"height\": 150\r\n    },\r\n    \"chart\": {\r\n        \"commonSeriesSettings\": {\r\n            \"type\": \"steparea\",\r\n            \"argumentField\": \"Month\"\r\n        },\r\n        \"series\": [\r\n            {\r\n                \"valueField\": \"Hours\"\r\n            }\r\n        ]\r\n    },\r\n    \"scale\": {\r\n        \"minorTickInterval\": \"month\",\r\n        \"tickInterval\": \"month\",\r\n        \"valueType\": \"datetime\"\r\n    },\r\n    \"sliderMarker\": {\r\n        \"customizeText\": \"function (e) {                         var bla = SW.getComponent('rangeSelector');                                    if(bla === null)                                                return;                                    var endDate = bla._slidersController._sliders[1]._value;                                    if(endDate === e.value) {                                                var aux = new Date(endDate);                                    aux.setDate(aux.getDate()-1);                                                var blo = aux.toLocaleDateString(undefined, {month: 'long'}) + ' ' + aux.toLocaleDateString(undefined,{day:'numeric'});                                    return blo;                                   } else {                                return e.valueText;                        }            }\",\r\n        \"format\": \"monthAndDay\",\r\n        \"color\": \"#da5859\"\r\n    },\r\n    \"value\": {\r\n        \"length\": {\r\n            \"months\": 1\r\n        }\r\n    },\r\n    \"disabled\": false,\r\n    \"onDrawn\": \"function bla(e) {\\r\\n  ;\\r\\n    SW.saveComponent(e.component, 'rangeSelector');\\r\\n}\"\r\n}","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14"},{"Id":"3442b1b3-fd38-4d5d-b4ab-33f3cdeb6afd","Name":"Utilization per Client  ","Active":true,"UseQuery":false,"Query":null,"Size":4,"Order":3,"Parameters":"[{\"WidgetSubTitle\":\"Actual Hours per Client in % of Total\",\"WidgetType\":\"chart\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#dddddd\",\"WidgetHeight\":125,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":true,\"metricName\":\"# Planned\",\"metricFieldValue\":\"PlannedTimeGrandTotal\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"with userType as (\\r\\n\\tSELECT\\r\\n\\t\\tv.Oid,\\r\\n\\t\\tv.UserTypeId\\r\\n\\tFROM \\r\\n\\t\\tAnalytics.DatamartUser v\\r\\n\\tGROUP BY\\r\\n\\t\\tv.Oid,\\r\\n\\t\\tv.UserTypeId\\r\\n)\\r\\nSELECT\\t\\r\\n\\t\\tv.Client,\\r\\n\\t\\t(v.[Hours] / IIF(v.[TotalHours] > 0, v.[TotalHours], 1.0)) as UtilizationPercentage\\r\\nFROM\\t\\r\\n(\\r\\n\\tSELECT\\r\\n\\t\\t\\tv.Client,\\t\\r\\n\\t\\t\\tSUM(v.BillableTime) as [Hours],\\r\\n\\t\\t\\tSUM(SUM(v.BillableTime)) OVER () as [TotalHours]\\r\\n\\tFROM\\r\\n\\t\\t\\tAnalytics.Timesheet(@CurrentUserId) v, userType ut\\r\\n\\tWHERE\\t\\r\\n\\t\\t\\t(v.CompanyId = @CompanyOid or @CompanyOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\t\\tAND (v.DivisionId = @DivisionOid or @DivisionOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\t\\tAND (v.DepartmentId = @DepartmentOid or @DepartmentOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\t\\tAND v.UserId = ut.Oid \\r\\n\\t\\t\\tAND (ut.UserTypeId = @UserType or @UserType = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\t\\tAND v.[Date] between @FromDate and @ToDate\\r\\n\\tGROUP BY\\r\\n\\t\\t\\tv.Client\\r\\n) v\\r\\nORDER BY (v.[Hours] / IIF(v.[TotalHours] > 0, v.[TotalHours], 1.0)) desc\\r\\n\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\",\"CompanyOid\",\"DivisionOid\",\"DepartmentOid\",\"UserType\"]}}]","DashboardComponentType":{"Id":"c666ba5e-8578-4132-86a5-0f96c665000d","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Totals/execute","Configuration":"{\n    \"commonSeriesSettings\": {\n        \"type\": \"bar\",\n        \"ignoreEmptyPoints\": true,\n        \"cornerRadius\": \"2px\",\n        \"label\": {\n            \"visible\": true,\n            \"showForZeroValues\": false,\n            \"format\": \"percent\"\n        }\n    },\n    \"size\": {\n        \"height\": 150\n    },\n    \"tooltip\": {\n        \"format\": \"percent\"\n    },\n    \"argumentAxis\": {\n        \"label\": {\n            \"overlappingBehavior\": \"stagger\",\n            \"font\": {\n                \"size\": 8\n            }\n        }\n    },\n    \"valueAxis\": {\n        \"label\": {\n            \"format\": \"percent\"\n        }\n    },\n    \"series\": [\n        {\n            \"name\": \"Client\",\n            \"argumentField\": \"Client\",\n            \"valueField\": \"UtilizationPercentage\",\n            \"label\": {\n                \"visible\": false,\n                \"format\": \"percent\"\n            }\n        }\n    ],\n    \"legend\": {\n        \"visible\": false,\n        \"horizontalAlignment\": \"left\",\n        \"verticalAlignment\": \"middle\",\n        \"itemTextPosition\": \"right\",\n        \"paddingLeftRight\": 0,\n        \"font\": {\n            \"size\": 8\n        }\n    },\n    \"resolveLabelOverlapping\": \"stack\"\n}","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14"},{"Id":"6158b51d-7f32-4571-ab05-78d7d8d5675b","Name":"","Active":true,"UseQuery":false,"Query":"","Size":12,"Order":0,"Parameters":"[{\"WidgetSubTitle\":\"\",\"WidgetType\":\"form\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#e0e0e0\",\"WidgetHeight\":30,\"WidgetHeader\":{\"showTitle\":false,\"showSubTitle\":false,\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[]},\"WidgetPeriodChooser\":{\"visible\":false,\"type\":\"\",\"startDate\":null,\"endDate\":null}},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"PreviousPeriod\":{\"Show\":false,\"KeyFieldName\":\"\",\"Type\":0},\"RequiredFilters\":[]}}]","DashboardComponentType":{"Id":"c666ba5e-8578-4132-86a5-0f96c665000d","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"","Configuration":"{\r\n    \"colCount\": 5,\r\n    \"items\": [\r\n        {\r\n            \"name\": \"Year\",\r\n            \"dataField\": \"Year\",\r\n            \"editorType\": \"dxNumberBox\",\r\n            \"editorOptions\": {\r\n                \"showSpinButtons\": true,\r\n                \"value\": 2019,\r\n                \"width\": 65,\r\n                \"placeholder\": \"year\",\r\n                \"onContentReady\": \"function(e){ setTimeout(function() { SkillsWorkflow.setDashboardFilter('year', 2019); SkillsWorkflow.setDashboardFilter('CompanyOid', '00000000-0000-0000-0000-000000000000'); SkillsWorkflow.setDashboardFilter('DivisionOid', '00000000-0000-0000-0000-000000000000'); SkillsWorkflow.setDashboardFilter('DepartmentOid', '00000000-0000-0000-0000-000000000000'); SkillsWorkflow.setDashboardFilter('UserType', '00000000-0000-0000-0000-000000000000');}, 500) }\",\r\n                \"onValueChanged\": \"function(e){ if(e.value != null) { SkillsWorkflow.setDashboardFilter('year', e.value); } }\"\r\n            },\r\n            \"noDataText\": \"Please wait...\"\r\n        },\r\n        {\r\n            \"dataField\": \"CompanyId\",\r\n            \"label\": {\r\n                \"text\": \"Company\"\r\n            },\r\n            \"editorType\": \"dxSelectBox\",\r\n            \"editorOptions\": {\r\n                \"width\": 200,\r\n                \"searchEnabled\": true,\r\n                \"dataSource\": {\r\n                    \"load\": \"function(loadOptions){ \r\n                            var searchValue = (\r\n                            loadOptions.searchValue != null ? loadOptions.searchValue : ''); \r\n                            var searchTake = (loadOptions.searchValue != null && loadOptions.searchValue != '' ? 10 : 100); \r\n                            return SkillsWorkflow.executeAPI('GET', 'companies/lookup',\r\n                    null,\r\n                    {}).then(function(res){ res.push({Id: '00000000-0000-0000-0000-000000000000', Name:'All companies'\r\n                        });return res;\r\n                    })\r\n                }\",\r\n                    \"byKey\": \"function(key) { return SW.executeAPI('GET','companies/'+key+'/lookup',null,{}).then( result =>  { return Promise.resolve(result);}) }\"\r\n            },\r\n            \"placeholder\": \"All companies\",\r\n            \"displayExpr\": \"Name\",\r\n            \"valueExpr\": \"Id\",\r\n            \"onValueChanged\": \"function(e){ \r\n                if( e.value != null && e.value != '') {\r\n                    SkillsWorkflow.setDashboardFilter('CompanyOid', e.value);\r\n            } else {\r\n                    SkillsWorkflow.setDashboardFilter('CompanyOid', '00000000-0000-0000-0000-000000000000');\r\n            }\r\n                SW.setComponentByValue(e.previousValue, e.value, 'DivisionId');\r\n        }\",\r\n            \"onInitialized\": \"function(e){ SW.saveComponent(e.component,'CompanyId');}\"\r\n    }\r\n},\r\n{\r\n    \"dataField\": \"DivisionId\",\r\n    \"label\": {\r\n        \"text\": \"Division\"\r\n    },\r\n    \"editorType\": \"dxSelectBox\",\r\n    \"editorOptions\": {\r\n        \"width\": 200,\r\n        \"searchEnabled\": true,\r\n        \"dataSource\": {\r\n            \"load\": \"function(loadOptions){ \r\n                            let searchValue = (loadOptions.searchValue != null ? loadOptions.searchValue : ''); \r\n                            let skip = loadOptions.skip || 0; \r\n                            let take = loadOptions.take || 20; \r\n                            var param = { name:searchValue, skip: skip, take: take\r\n            }; \r\n                            var companyId = SW.getValueFromComponent('CompanyId'); \r\n                            if (companyId == '00000000-0000-0000-0000-000000000000') {\r\n                                return SkillsWorkflow.executeAPI('GET', 'divisions/lookup',\r\n                null,\r\n                {}).then(function(res){ res.push({Id: '00000000-0000-0000-0000-000000000000', Name:'All divisions'\r\n                    });return res;\r\n                })\r\n            } else if (companyId != null) { \r\n                                param['companyId'\r\n                ] = companyId;\r\n                                return SkillsWorkflow.executeAPI('GET', 'divisions/lookup',param,\r\n                {}).then(function(res){ res.push({Id: '00000000-0000-0000-0000-000000000000', Name:'All divisions'\r\n                    });return res;\r\n                })\r\n            }\r\n        }\",\r\n                \"byKey\": \"function(key) { return SW.executeAPI('GET','divisions/'+key+'/lookup',null,{}).then( result =>  { return Promise.resolve(result);})}\"\r\n    },\r\n    \"placeholder\": \"All divisions\",\r\n    \"onValueChanged\": \"function(e){ \r\n                if (e.value != null && e.value != '') {\r\n                    SkillsWorkflow.setDashboardFilter('DivisionOid', e.value);\r\n    } else {\r\n                    SkillsWorkflow.setDashboardFilter('DivisionOid', '00000000-0000-0000-0000-000000000000');\r\n    }\r\n                SW.setComponentByValue(e.previousValue, e.value, 'DepartmentId');\r\n}\",\r\n        \"onInitialized\": \"function(e){ SW.saveComponent(e.component, 'DivisionId'); }\",\r\n\"displayExpr\": \"Name\",\r\n\"valueExpr\": \"Id\",\r\n\"disabled\": true\r\n}\r\n},\r\n{\r\n\"dataField\": \"DepartmentId\",\r\n\"label\": {\r\n\"text\": \"Department\"\r\n},\r\n\"editorType\": \"dxSelectBox\",\r\n\"editorOptions\": {\r\n\"width\": 200,\r\n\"searchEnabled\": true,\r\n\"dataSource\": {\r\n    \"load\": \"function(loadOptions){ \r\n                    let searchValue = (loadOptions.searchValue != null ? loadOptions.searchValue : ''); \r\n                    let skip = loadOptions.skip || 0; \r\n                    let take = loadOptions.take || 20;\r\n                    var param = { name: searchValue, skip: skip, take: take\r\n    }; \r\n                    var divisionId = SW.getValueFromComponent('DivisionId'); \r\n                    var companyId = SW.getValueFromComponent('CompanyId'); \r\n                    if (divisionId != null && divisionId != '00000000-0000-0000-0000-000000000000' && companyId != null && companyId != '00000000-0000-0000-0000-000000000000') { \r\n                        param['divisionId'\r\n        ] = divisionId;\r\n                        param['companyId'\r\n        ] = companyId;\r\n    } else if (divisionId != null && divisionId != '00000000-0000-0000-0000-000000000000' && (companyId == null || companyId == '00000000-0000-0000-0000-000000000000')) {\r\n                        param['divisionId'\r\n        ] = divisionId;\r\n    }\r\n                    return SkillsWorkflow.executeAPI('GET', 'departments',param,\r\n    {}).then(function(res){ res.push({Id: '00000000-0000-0000-0000-000000000000', Name:'All departments'\r\n        });return res;\r\n    })\r\n}\",\r\n        \"byKey\": \"function(key) { return SW.executeAPI('GET', 'departments/' + key, null, {}).then( result =>  { return Promise.resolve(result); } ) }\"\r\n},\r\n\"placeholder\": \"All departments\",\r\n\"onValueChanged\": \"function(e){ \r\n            if(e.value != null && e.value != '') {\r\n                    SkillsWorkflow.setDashboardFilter('DepartmentOid', e.value);\r\n} else {\r\n                    SkillsWorkflow.setDashboardFilter('DepartmentOid', '00000000-0000-0000-0000-000000000000');\r\n}\r\n}\",\r\n    \"onInitialized\": \"function(e){ SW.saveComponent(e.component, 'DepartmentId'); }\",\r\n\"displayExpr\": \"Name\",\r\n\"valueExpr\": \"Id\",\r\n\"disabled\": true\r\n}\r\n},\r\n{\r\n\"dataField\": \"UserTypeId\",\r\n\"label\": {\r\n\"text\": \"User Type\"\r\n},\r\n\"editorType\": \"dxSelectBox\",\r\n\"editorOptions\": {\r\n\"width\": 200,\r\n\"searchEnabled\": true,\r\n\"dataSource\": {\r\n\"load\": \"function(loadOptions){ \r\n                                    let searchValue = (loadOptions.searchValue != null ? loadOptions.searchValue : ''); \r\n                                    let skip = loadOptions.skip || 0; \r\n                                    let take = loadOptions.take || 20;\r\n                                    var param = { name: searchValue, skip: skip, take: take\r\n};\r\n                                    return SkillsWorkflow.executeAPI('GET', 'usertypes',param,\r\n{}).then(function(res){ res.push({Id: '00000000-0000-0000-0000-000000000000', Name:'All User Types'\r\n});return res;\r\n});\r\n}\",\r\n            \"byKey\": \"function(key) { return SW.executeAPI('GET', 'usertypes/' + key, null, {}).then( result =>  { return Promise.resolve(result); } ) }\"\r\n},\r\n\"placeholder\": \"All User Types\",\r\n\"onValueChanged\": \"function(e){ \r\n                                if(e.value != null && e.value != '') {\r\n                                    SkillsWorkflow.setDashboardFilter('UserType', e.value);\r\n} else {\r\n                                    SkillsWorkflow.setDashboardFilter('UserType', '00000000-0000-0000-0000-000000000000');\r\n}\r\n}\",\r\n        \"onInitialized\": \"function(e){ SW.saveComponent(e.component, 'UserTypeId'); }\",\r\n\"displayExpr\": \"Name\",\r\n\"valueExpr\": \"Id\",\r\n\"disabled\": false\r\n}\r\n}\r\n]\r\n}","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14"},{"Id":"4c7bbd28-c8cd-4ee8-ae98-7f6fe8d70d49","Name":"User Projects","Active":true,"UseQuery":false,"Query":null,"Size":6,"Order":7,"Parameters":"[{\"WidgetSubTitle\":\"Different Projects the User was or is involved in\",\"WidgetType\":\"grid\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"\",\"WidgetHeight\":450,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":false,\"metricName\":\"# Forecast\",\"metricFieldValue\":\"TimeGrandTotal\"},{\"visible\":false,\"metricName\":\"# Actual\",\"metricFieldValue\":\"UtilizationPercentGrandTotal\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"WITH UsersCapacity AS\\n(\\n\\tSELECT \\n\\t\\tu.Oid AS UserId,\\n\\t\\t(\\n\\t\\t\\t(\\n\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\t(DATEDIFF(dd, @FromDate, @ToDate) + 1)\\n\\t\\t\\t\\t\\t-(DATEDIFF(wk, @FromDate, @ToDate) * 2)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @FromDate) = 'Sunday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @ToDate) = 'Saturday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t) + 1 \\n\\t\\t\\t)\\n\\t\\t\\t-\\n\\t\\t\\t(\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t\\t+\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t)\\n\\t\\t) * u.RequiredHours AS WorkingHours,\\n\\t\\t(SELECT ISNULL(SUM(dl.[Hours]), 0.0) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate) AS Leaves,\\n\\t\\t(SELECT ISNULL(SUM(dh.[Hours]), 0.0) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate) as Holidays\\n\\tFROM\\n\\t\\t[User] u\\n\\tWHERE\\n\\t\\tu.Oid = @UserOid\\n),\\nUsersHours AS\\n(\\n\\tSELECT\\n\\t\\tdt.ClientGroup,\\n\\t\\tdt.Client,\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User],\\n\\t\\tdt.Project,\\n\\t\\tdt.ProjectClassificationName,\\n\\t\\tdt.ProjectTypeName,\\n\\t\\tdt.[Job],\\n\\t\\tSUM(dt.ActualTime) AS [Hours],\\n\\t\\tSUM(dt.AdministrativeTime) AS [AdministrativeHours],\\n\\t\\tSUM(ISNULL(dt.InternalWorkTime, 0.0)) AS [InternalWorkHours],\\n\\t\\tSUM(dt.NewBusinessTime) AS [NewBusinessHours],\\n\\t\\tSUM(dt.BillableTime) AS [BillableHours],\\n\\t\\tSUM(ISNULL(dt.BillableTime, 0.0) - ISNULL(dt.[InternalWorkTime], 0.0)) as [ClientHours],\\n\\t\\tSUM(ISNULL(dt.[ActualTime] - (dt.[AdministrativeTime] + dt.[NewBusinessTime] + dt.[BillableTime]), 0.0)) as [NonWorkedHours]\\n\\tFROM \\n\\t\\tAnalytics.Timesheet(@CurrentUserId) dt\\n\\tWHERE\\n\\t\\tdt.[Date] BETWEEN @FromDate AND @ToDate - 1\\n\\t\\tAND dt.UserId = @UserOid\\n\\tGROUP BY\\n\\t\\tdt.ClientGroup,\\n\\t\\tdt.Client,\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User],\\n\\t\\tdt.Project,\\n\\t\\tdt.ProjectClassificationName,\\n\\t\\tdt.ProjectTypeName,\\n        dt.[Job]\\n)\\nSELECT \\n\\tuh.ClientGroup,\\n\\tuh.Client,\\n\\tuh.[User],\\n\\tuh.Project,\\n\\tuh.ProjectClassificationName,\\n\\tIIF(uh.ProjectTypeName = '', 'Admin', uh.ProjectTypeName) as ProjectTypeName,\\n\\tuh.Job,\\n\\tuh.[Hours],\\n\\tuh.AdministrativeHours,\\n\\tuh.InternalWorkHours,\\n\\tuh.NewBusinessHours,\\n\\tuh.BillableHours,\\n\\tuh.ClientHours,\\n\\tuh.NonWorkedHours,\\n\\t0 AS Capacity,\\n\\t0 AS Leaves,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[BillableHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationPercentage,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[NewBusinessHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationNonBillablePercentage\\nFROM \\n\\tUsersHours uh,\\n\\tUsersCapacity uc\\nWHERE\\n\\tuh.UserId = uc.UserId\\nUNION ALL\\nSELECT \\n\\t'' as ClientGroup,\\n\\t'' as Client,\\n\\t'' as [User],\\n\\t'' as Project,\\n\\t'' as ProjectClassificationName,\\n\\t'Leave' as ProjectTypeName,\\n\\t'' as Job,\\n\\tuc.Leaves as [Hours],\\n\\t0 as AdministrativeHours,\\n\\t0 as InternalWorkHours,\\n\\t0 as NewBusinessHours,\\n\\t0 as BillableHours,\\n\\t0 as ClientHours,\\n\\t0 as NonWorkedHours,\\n\\tuc.WorkingHours AS Capacity,\\n\\tuc.Leaves AS Leaves,\\n\\t0 as UtilizationPercentage,\\n\\t0 as UtilizationNonBillablePercentage\\nFROM \\n\\tUsersCapacity uc\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\",\"userOid\"]}}]","DashboardComponentType":{"Id":"c666ba5e-8578-4132-86a5-0f96c665000d","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Per_Company_Department_User/execute","Configuration":"{\r\n    \"headerFilter\": {\r\n        \"visible\": true\r\n    },\r\n    \"stateStoring\": {\r\n        \"enabled\": false\r\n    },\r\n    \"columnResizingMode\": \"widget\",\r\n    \"allowColumnResizing\": \"true\",\r\n    \"allowFiltering\": true,\r\n    \"columnAutoWidth\": \"true\",\r\n    \"grouping\": {\r\n        \"autoExpandAll\": true\r\n    },\r\n    \"searchPanel\": {\r\n        \"visible\": true\r\n    },\r\n    \"height\": \"450\",\r\n    \"scrolling\": {\r\n        \"mode\": \"virtual\"\r\n    },\r\n    \"selection\": {\r\n        \"mode\": \"none\"\r\n    },\r\n    \"columnMinWidth\": \"80\",\r\n    \"columns\": [\r\n        {\r\n            \"dataField\": \"Project\",\r\n            \"name\": \"Project\",\r\n            \"caption\": \"Project Name\",\r\n            \"width\": 175\r\n        },\r\n        {\r\n            \"dataField\": \"Job\",\r\n            \"caption\": \"Job\",\r\n            \"width\": 150\r\n        },\r\n        {\r\n            \"dataField\": \"Client\",\r\n            \"caption\": \"Client\",\r\n            \"width\": 120\r\n        },\r\n        {\r\n            \"dataField\": \"ProjectClassificationName\",\r\n            \"name\": \"ProjectClassificationName\",\r\n            \"caption\": \"Project Classification\",\r\n            \"width\": 150,\r\n            \"visible\": false\r\n        },\r\n        {\r\n            \"dataField\": \"ProjectTypeName\",\r\n            \"name\": \"ProjectTypeName\",\r\n            \"caption\": \"Type\",\r\n            \"width\": 120,\r\n            \"groupIndex\": 0\r\n        },\r\n        {\r\n            \"dataField\": \"NewBusinessHours\",\r\n            \"caption\": \"Non-Billable\",\r\n            \"name\": \"NonBillable\",\r\n            \"alignment\": \"right\",\r\n            \"format\": \"#,##0\"\r\n        },\r\n        {\r\n            \"dataField\": \"BillableHours\",\r\n            \"caption\": \"Billable\",\r\n            \"alignment\": \"right\",\r\n            \"format\": \"#,##0\"\r\n        },\r\n        {\r\n            \"caption\": \"Utilization\",\r\n            \"alignment\": \"center\",\r\n            \"columns\": [\r\n                {\r\n                    \"dataField\": \"UtilizationNonBillablePercentage\",\r\n                    \"caption\": \"Non Billable %\",\r\n                    \"name\": \"UtilizationNonBillable\",\r\n                    \"alignment\": \"right\",\r\n                    \"format\": \"#,##0\",\r\n                    \"cellTemplate\": \"function(e, i) {                  SkillsWorkflow.setRAG(e, (i.value * 100.0).toFixed(1) + '%', i.value >= 1.2, (i.value >= 0.8 && i.value < 1.2), i.value < 0.8, true);            }\"\r\n                },\r\n                {\r\n                    \"dataField\": \"UtilizationPercentage\",\r\n                    \"caption\": \"Billable %\",\r\n                    \"name\": \"Utilization\",\r\n                    \"alignment\": \"right\",\r\n                    \"format\": \"#,##0\",\r\n                    \"cellTemplate\": \"function(e, i) {                  SkillsWorkflow.setRAG(e, (i.value * 100.0).toFixed(1) + '%', i.value >= 1.2, (i.value >= 0.8 && i.value < 1.2), i.value < 0.8, true);            }\"\r\n                }\r\n            ]\r\n        },\r\n        {\r\n            \"dataField\": \"Hours\",\r\n            \"caption\": \"Hours\",\r\n            \"alignment\": \"right\",\r\n            \"format\": \"#,##0\"\r\n        }\r\n    ],\r\n    \"sortByGroupSummaryInfo\": [\r\n        {\r\n            \"summaryItem\": \"count\"\r\n        }\r\n    ],\r\n    \"summary\": {\r\n        \"calculateCustomSummary\": \"function (options) {            if (options.name === 'NonBillablePercentage') {                switch(options.summaryProcess) {                    case 'start':                    options.totalValue = [0,0];                    break;                    case 'calculate':                    options.totalValue[0] = options.totalValue[0] + options.value.NewBusinessHours;                    options.totalValue[1] = options.totalValue[1] + options.value.Capacity;                        break;                    case 'finalize':                    if(Number(options.totalValue[1]) > 0)                    options.totalValue = (options.totalValue[0] / options.totalValue[1]);                    else                            options.totalValue = 0;                    break;                }            }            if (options.name === 'BillablePercentage') {                        switch(options.summaryProcess) {                    case 'start':                        options.totalValue = [0,0];                        break;                        case 'calculate':                        options.totalValue[0] = options.totalValue[0] + options.value.BillableHours;                        options.totalValue[1] = options.totalValue[1] + options.value.Capacity;                        break;                    case 'finalize':                        if(Number(options.totalValue[1]) > 0)                            options.totalValue = (options.totalValue[0] / options.totalValue[1]);                        else                            options.totalValue = 0;                            break;                }            }        }\",\r\n        \"totalItems\": [\r\n            {\r\n                \"name\": \"BillablePercentage\",\r\n                \"showInColumn\": \"Billable %\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"valueFormat\": {\r\n                    \"type\": \"percent\",\r\n                    \"precision\": 1\r\n                },\r\n                \"summaryType\": \"custom\",\r\n                \"alignment\": \"right\"\r\n            },\r\n            {\r\n                \"name\": \"NonBillablePercentage\",\r\n                \"showInColumn\": \"Non Billable %\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"valueFormat\": {\r\n                    \"type\": \"percent\",\r\n                    \"precision\": 1\r\n                },\r\n                \"summaryType\": \"custom\",\r\n                \"alignment\": \"right\"\r\n            },\r\n            {\r\n                \"column\": \"Hours\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"alignment\": \"right\"\r\n            },\r\n            {\r\n                \"column\": \"Non-Billable\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"alignment\": \"right\"\r\n            },\r\n            {\r\n                \"column\": \"Billable\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"alignment\": \"right\"\r\n            }\r\n        ],\r\n        \"groupItems\": [\r\n            {\r\n                \"name\": \"BillablePercentage\",\r\n                \"showInColumn\": \"Billable %\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"valueFormat\": {\r\n                    \"type\": \"percent\",\r\n                    \"precision\": 1\r\n                },\r\n                \"summaryType\": \"custom\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            },\r\n            {\r\n                \"name\": \"NonBillablePercentage\",\r\n                \"showInColumn\": \"Non Billable %\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"valueFormat\": {\r\n                    \"type\": \"percent\",\r\n                    \"precision\": 1\r\n                },\r\n                \"summaryType\": \"custom\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            },\r\n            {\r\n                \"column\": \"Hours\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            },\r\n            {\r\n                \"column\": \"Non-Billable\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            },\r\n            {\r\n                \"column\": \"Billable\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            }\r\n        ]\r\n    }\r\n}","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14"},{"Id":"99b57db7-3bb2-4fc6-80a7-851d8429e0c4","Name":"Utilization per Project Type ","Active":true,"UseQuery":false,"Query":null,"Size":4,"Order":5,"Parameters":"[{\"WidgetSubTitle\":\"Actual Hours per Project Type in % of Total\",\"WidgetType\":\"chart\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#dddddd\",\"WidgetHeight\":125,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":true,\"metricName\":\"# Planned\",\"metricFieldValue\":\"PlannedTimeGrandTotal\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"with userType as (\\r\\n\\tSELECT\\r\\n\\t\\tv.Oid,\\r\\n\\t\\tv.UserTypeId\\r\\n\\tFROM \\r\\n\\t\\tAnalytics.DatamartUser v\\r\\n\\tGROUP BY\\r\\n\\t\\tv.Oid,\\r\\n\\t\\tv.UserTypeId\\r\\n)\\r\\nSELECT\\t\\r\\n\\t\\tIIF(v.ProjectTypeName = '', 'Admin Hours',v.ProjectTypeName) as ProjectTypeName,\\r\\n\\t\\t(v.[Hours] / IIF(v.[TotalHours] > 0, v.[TotalHours], 1.0)) as UtilizationPercentage\\r\\nFROM\\t\\r\\n(\\r\\n\\tSELECT\\r\\n\\t\\tv.ProjectTypeName,\\t\\r\\n\\t\\tSUM(v.BillableTime) as [Hours],\\r\\n\\t\\tSUM(SUM(v.BillableTime)) OVER () as [TotalHours]\\r\\n\\tFROM\\r\\n\\t\\tAnalytics.Timesheet(@CurrentUserId) v, userType ut\\r\\n\\tWHERE\\t\\r\\n\\t\\t(v.CompanyId = @CompanyOid or @CompanyOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tAND (v.DivisionId = @DivisionOid or @DivisionOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tAND (v.DepartmentId = @DepartmentOid or @DepartmentOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tAND v.UserId = ut.Oid \\r\\n\\t\\tAND (ut.UserTypeId = @UserType or @UserType = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tAND v.[Date] between @FromDate and @ToDate\\r\\n\\tGROUP BY\\r\\n\\t\\tv.ProjectTypeName\\r\\n) v\\r\\norder by (v.[Hours] / IIF(v.[TotalHours] > 0, v.[TotalHours], 1.0)) desc\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\",\"CompanyOid\",\"DivisionOid\",\"DepartmentOid\",\"UserType\"]}}]","DashboardComponentType":{"Id":"c666ba5e-8578-4132-86a5-0f96c665000d","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Totals/execute","Configuration":"{\n    \"commonSeriesSettings\": {\n        \"type\": \"bar\",\n        \"ignoreEmptyPoints\": true,\n        \"cornerRadius\": \"2px\",\n        \"label\": {\n            \"visible\": true,\n            \"showForZeroValues\": false,\n            \"format\": \"percent\"\n        },\n        \"argumentField\": \"ProjectTypeName\",\n        \"valueField\": \"UtilizationPercentage\"\n    },\n    \"size\": {\n        \"height\": 150\n    },\n    \"tooltip\": {\n        \"format\": \"percent\"\n    },\n    \"argumentAxis\": {\n        \"label\": {\n            \"overlappingBehavior\": \"stagger\",\n            \"font\": {\n                \"size\": 8\n            }\n        }\n    },\n    \"valueAxis\": {\n        \"label\": {\n            \"format\": \"percent\"\n        }\n    },\n    \"series\": [\n        {\n            \"name\": \"Project Type\",\n            \"argumentField\": \"ProjectTypeName\",\n            \"valueField\": \"UtilizationPercentage\",\n            \"label\": {\n                \"visible\": false,\n                \"format\": \"percent\"\n            }\n        }\n    ],\n    \"seriesTemplate\": {\n        \"nameField\": \"ProjectTypeName\"\n    },\n    \"legend\": {\n        \"visible\": false,\n        \"horizontalAlignment\": \"left\",\n        \"verticalAlignment\": \"middle\",\n        \"itemTextPosition\": \"right\",\n        \"paddingLeftRight\": 0,\n        \"font\": {\n            \"size\": 8\n        }\n    },\n    \"resolveLabelOverlapping\": \"shift\"\n}","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14"},{"Id":"6cf10abc-9b35-41b4-91f9-b014be4f2392","Name":"Utilization per Department","Active":true,"UseQuery":false,"Query":null,"Size":4,"Order":4,"Parameters":"[{\"WidgetSubTitle\":\"Actual Hours per Department in % of Total\",\"WidgetType\":\"chart\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#dddddd\",\"WidgetHeight\":125,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":true,\"metricName\":\"# Planned\",\"metricFieldValue\":\"PlannedTimeGrandTotal\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"with userType as (\\r\\n\\tSELECT\\r\\n\\t\\tv.Oid,\\r\\n\\t\\tv.UserTypeId\\r\\n\\tFROM \\r\\n\\t\\tAnalytics.DatamartUser v\\r\\n\\tGROUP BY\\r\\n\\t\\tv.Oid,\\r\\n\\t\\tv.UserTypeId\\r\\n)\\r\\nSELECT\\t\\r\\n\\t\\tv.Department,\\r\\n\\t\\t(v.[Hours] / IIF(v.[TotalHours] > 0, v.[TotalHours], 1.0)) as UtilizationPercentage\\r\\nFROM\\t\\r\\n(\\r\\n\\tSELECT\\r\\n\\t\\tv.Department,\\t\\r\\n\\t\\tSUM(v.BillableTime) as [Hours],\\r\\n\\t\\tSUM(SUM(v.BillableTime)) OVER () as [TotalHours]\\r\\n\\tFROM\\r\\n\\t\\tAnalytics.Timesheet(@CurrentUserId) v, userType ut\\r\\n\\tWHERE\\t\\r\\n        (v.CompanyId = @CompanyOid or @CompanyOid = '00000000-0000-0000-0000-000000000000')\\r\\n        AND (v.DivisionId = @DivisionOid or @DivisionOid = '00000000-0000-0000-0000-000000000000')\\r\\n        AND (v.DepartmentId = @DepartmentOid or @DepartmentOid = '00000000-0000-0000-0000-000000000000')\\r\\n\\t\\tAND v.UserId = ut.Oid \\r\\n\\t\\tAND (ut.UserTypeId = @UserType or @UserType = '00000000-0000-0000-0000-000000000000')\\r\\n        AND v.[Date] between @FromDate and @ToDate\\r\\n\\tGROUP BY\\r\\n\\t\\tv.Department\\r\\n) v\\r\\nORDER BY (v.[Hours] / IIF(v.[TotalHours] > 0, v.[TotalHours], 1.0)) DESC\\r\\n\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\",\"CompanyOid\",\"DivisionOid\",\"DepartmentOid\",\"UserType\"]}}]","DashboardComponentType":{"Id":"c666ba5e-8578-4132-86a5-0f96c665000d","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Totals/execute","Configuration":"{\n    \"commonSeriesSettings\": {\n        \"type\": \"bar\",\n        \"ignoreEmptyPoints\": true,\n        \"cornerRadius\": \"2px\",\n        \"label\": {\n            \"visible\": true,\n            \"showForZeroValues\": false,\n            \"format\": \"percent\"\n        }\n    },\n    \"size\": {\n        \"height\": 150\n    },\n    \"tooltip\": {\n        \"format\": \"percent\"\n    },\n    \"argumentAxis\": {\n        \"label\": {\n            \"overlappingBehavior\": \"stagger\",\n            \"font\": {\n                \"size\": 8\n            }\n        }\n    },\n    \"valueAxis\": {\n        \"label\": {\n            \"format\": \"percent\"\n        }\n    },\n    \"series\": [\n        {\n            \"name\": \"Department\",\n            \"argumentField\": \"Department\",\n            \"valueField\": \"UtilizationPercentage\",\n            \"label\": {\n                \"visible\": false,\n                \"format\": \"percent\"\n            }\n        }\n    ],\n    \"legend\": {\n        \"visible\": false,\n        \"horizontalAlignment\": \"left\",\n        \"verticalAlignment\": \"middle\",\n        \"itemTextPosition\": \"right\",\n        \"paddingLeftRight\": 0,\n        \"font\": {\n            \"size\": 8\n        }\n    },\n    \"resolveLabelOverlapping\": \"shift\"\n}","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14"},{"Id":"053f3f67-82d3-4997-805b-c99250efb2f9","Name":"Utilization per User","Active":true,"UseQuery":false,"Query":null,"Size":6,"Order":6,"Parameters":"[{\"WidgetSubTitle\":\"Billable and Non-Billable Actual Hours in % of User Capacity\",\"WidgetType\":\"grid\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"\",\"WidgetHeight\":450,\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":false,\"Metrics\":[{\"visible\":false,\"metricName\":\"# Forecast\",\"metricFieldValue\":\"TimeGrandTotal\"},{\"visible\":false,\"metricName\":\"# Actual\",\"metricFieldValue\":\"UtilizationPercentGrandTotal\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"WITH UsersCapacity AS\\n(\\n\\tSELECT \\n\\t\\tu.Oid AS UserId,\\n\\t\\tu.[Name] as [User], \\n\\t\\t(\\n\\t\\t\\t(\\n\\t\\t\\t\\t(\\n\\t\\t\\t\\t\\t(DATEDIFF(dd, @FromDate, @ToDate) + 1)\\n\\t\\t\\t\\t\\t-(DATEDIFF(wk, @FromDate, @ToDate) * 2)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @FromDate) = 'Sunday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t\\t-(CASE WHEN DATENAME(dw, @ToDate) = 'Saturday' THEN 1 ELSE 0 END)\\n\\t\\t\\t\\t) + 1 \\n\\t\\t\\t)\\n\\t\\t\\t-\\n\\t\\t\\t(\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t\\t+\\n\\t\\t\\t\\t(SELECT COUNT(*) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate)\\n\\t\\t\\t)\\n\\t\\t) * u.RequiredHours AS WorkingHours,\\n\\t\\t(SELECT ISNULL(SUM(dl.[Hours]), 0.0) FROM Analytics.DatamartLeave dl WHERE dl.UserId = u.Oid AND dl.[Date] BETWEEN @FromDate AND @ToDate) AS Leaves,\\n\\t\\t(SELECT ISNULL(SUM(dh.[Hours]), 0.0) FROM Analytics.DatamartHoliday dh WHERE dh.UserId = u.Oid AND dh.[Date] BETWEEN @FromDate AND @ToDate) as Holidays\\n\\tFROM\\n\\t\\t[User] u\\n\\tWHERE\\n\\t\\t(u.Company = @CompanyOid or @CompanyOid = '00000000-0000-0000-0000-000000000000')\\n\\t\\tAND (u.Division = @DivisionOid or @DivisionOid = '00000000-0000-0000-0000-000000000000')\\n\\t\\tAND (u.Department = @DepartmentOid or @DepartmentOid = '00000000-0000-0000-0000-000000000000')\\n),\\nUsersHours AS\\n(\\n\\tSELECT\\n\\t\\tdt.Department,\\n\\t\\tdt.UserTypologyGroup,\\t\\n\\t\\tdt.[UserId],\\n\\t\\tSUM(dt.ActualTime) AS [Hours],\\n\\t\\tSUM(dt.AdministrativeTime) AS [AdministrativeHours],\\n\\t\\tSUM(ISNULL(dt.InternalWorkTime, 0.0)) AS [InternalWorkHours],\\n\\t\\tSUM(dt.NewBusinessTime) AS [NewBusinessHours],\\n\\t\\tSUM(dt.BillableTime) AS [BillableHours],\\n\\t\\tSUM(ISNULL(dt.BillableTime, 0.0) - ISNULL(dt.[InternalWorkTime], 0.0)) as [ClientHours],\\n\\t\\tSUM(ISNULL(dt.[ActualTime] - (dt.[AdministrativeTime] + dt.[NewBusinessTime] + dt.[BillableTime]), 0.0)) as [NonWorkedHours]\\n\\tFROM \\n\\t\\tAnalytics.Timesheet(@CurrentUserId) dt\\n\\tWHERE\\n        dt.[Date] between @FromDate and @ToDate - 1\\n\\t\\tAND (dt.CompanyId = @CompanyOid or @CompanyOid = '00000000-0000-0000-0000-000000000000')\\n\\t\\tAND (dt.DivisionId = @DivisionOid or @DivisionOid = '00000000-0000-0000-0000-000000000000')\\n\\t\\tAND (dt.DepartmentId = @DepartmentOid or @DepartmentOid = '00000000-0000-0000-0000-000000000000')\\n\\tGROUP BY\\n\\t\\tdt.Department,\\n\\t\\tdt.UserTypologyGroup,\\t\\n\\t\\tdt.[UserId],\\n\\t\\tdt.[User]\\n)\\nSELECT \\n\\tuh.Department,\\n\\tuh.UserTypologyGroup,\\n\\tuc.[User],\\n\\tut.[Name] as UserType,\\n\\tuh.UserId,\\n\\tuh.[Hours],\\n\\tuh.AdministrativeHours,\\n\\tuh.InternalWorkHours,\\n\\tuh.NewBusinessHours,\\n\\tuh.BillableHours,\\n\\tuh.ClientHours,\\n\\tuh.NonWorkedHours,\\n\\tuc.WorkingHours AS Capacity,\\n\\tuc.Leaves AS Leaves,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[BillableHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationPercentage,\\n\\tIIF(uc.WorkingHours > 0, ISNULL(uh.[NewBusinessHours], 0.0) / uc.WorkingHours, 1.0) as UtilizationNonBillablePercentage\\nFROM \\n\\tUsersHours uh,\\n\\tUsersCapacity uc,\\n\\t[User] u\\n\\tLEFT OUTER JOIN UserType ut ON (ut.Oid = u.UserType)\\nWHERE\\n\\tuh.UserId = uc.UserId\\n\\tAND u.Oid = uc.UserId\\n\\tAND (u.UserType = @UserType or @UserType = '00000000-0000-0000-0000-000000000000')\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\",\"CompanyOid\",\"DivisionOid\",\"DepartmentOid\"]}}]","DashboardComponentType":{"Id":"c666ba5e-8578-4132-86a5-0f96c665000d","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/Analytics_Utilization_Per_Company_Department_User/execute","Configuration":"{\r\n    \"headerFilter\": {\r\n        \"visible\": true\r\n    },\r\n    \"grouping\": {\r\n        \"autoExpandAll\": true\r\n    },\r\n    \"columnResizingMode\": \"widget\",\r\n    \"allowColumnResizing\": \"true\",\r\n    \"allowFiltering\": true,\r\n    \"columnAutoWidth\": \"true\",\r\n    \"searchPanel\": {\r\n        \"visible\": true\r\n    },\r\n    \"selection\": {\r\n        \"mode\": \"single\"\r\n    },\r\n    \"onSelectionChanged\": \"function (selectedItems) {            var data = selectedItems.selectedRowsData[0];            if(data) {                SkillsWorkflow.setDashboardFilter('userOid', data.UserId);          }  }\",\r\n    \"height\": \"500\",\r\n    \"scrolling\": {\r\n        \"mode\": \"virtual\"\r\n    },\r\n    \"columnMinWidth\": \"80\",\r\n    \"columns\": [\r\n        {\r\n            \"dataField\": \"Department\",\r\n            \"caption\": \"Department\",\r\n            \"width\": 120,\r\n            \"groupIndex\": 0\r\n        },\r\n        {\r\n            \"dataField\": \"UserTypologyGroup\",\r\n            \"name\": \"Typology Group\",\r\n            \"caption\": \"Typology\",\r\n            \"width\": 120\r\n        },\r\n        {\r\n            \"dataField\": \"UserId\",\r\n            \"name\": \"Picture\",\r\n            \"caption\": \"Picture\",\r\n            \"width\": 30,\r\n            \"alignment\": \"left\",\r\n            \"cellTemplate\": \"function(e, i) {        console.log(i.text);        console.log(i.data.User);        SK.showImage(e, 'user', 'small', i.text, i.data.User);    }\"\r\n        },\r\n        {\r\n            \"dataField\": \"User\",\r\n            \"name\": \"User\",\r\n            \"caption\": \"Name\",\r\n            \"width\": 120\r\n        },\r\n        {\r\n            \"dataField\": \"UserType\",\r\n            \"name\": \"UserType\",\r\n            \"caption\": \"User Type\",\r\n            \"width\": 120\r\n        },\r\n        {\r\n            \"dataField\": \"Capacity\",\r\n            \"caption\": \"Capacity\",\r\n            \"alignment\": \"right\",\r\n            \"format\": \"#,##0\"\r\n        },\r\n        {\r\n            \"dataField\": \"Leaves\",\r\n            \"caption\": \"Leaves\",\r\n            \"alignment\": \"right\",\r\n            \"format\": \"#,##0\"\r\n        },\r\n        {\r\n            \"dataField\": \"NewBusinessHours\",\r\n            \"caption\": \"Non-Billable\",\r\n            \"name\": \"NonBillable\",\r\n            \"alignment\": \"right\",\r\n            \"format\": \"#,##0\"\r\n        },\r\n        {\r\n            \"dataField\": \"AdministrativeHours\",\r\n            \"caption\": \"Admin\",\r\n            \"name\": \"Admin\",\r\n            \"alignment\": \"right\",\r\n            \"format\": \"#,##0\"\r\n        },\r\n        {\r\n            \"dataField\": \"BillableHours\",\r\n            \"caption\": \"Billable\",\r\n            \"alignment\": \"right\",\r\n            \"format\": \"#,##0\"\r\n        },\r\n        {\r\n            \"caption\": \"Utilization\",\r\n            \"alignment\": \"center\",\r\n            \"columns\": [\r\n                {\r\n                    \"dataField\": \"UtilizationNonBillablePercentage\",\r\n                    \"caption\": \"Non Billable %\",\r\n                    \"name\": \"UtilizationNonBillable\",\r\n                    \"alignment\": \"right\",\r\n                    \"format\": \"#,##0\",\r\n                    \"cellTemplate\": \"function(e, i) {                  SkillsWorkflow.setRAG(e, (i.value * 100.0).toFixed(1) + '%', i.value >= 1.2, (i.value >= 0.8 && i.value < 1.2), i.value < 0.8, true);            }\"\r\n                },\r\n                {\r\n                    \"dataField\": \"UtilizationPercentage\",\r\n                    \"caption\": \"Billable %\",\r\n                    \"name\": \"Utilization\",\r\n                    \"alignment\": \"right\",\r\n                    \"format\": \"#,##0\",\r\n                    \"cellTemplate\": \"function(e, i) {                  SkillsWorkflow.setRAG(e, (i.value * 100.0).toFixed(1) + '%', i.value >= 1.2, (i.value >= 0.8 && i.value < 1.2), i.value < 0.8, true);            }\"\r\n                }\r\n            ]\r\n        }\r\n    ],\r\n    \"sortByGroupSummaryInfo\": [\r\n        {\r\n            \"summaryItem\": \"count\"\r\n        }\r\n    ],\r\n    \"summary\": {\r\n        \"calculateCustomSummary\": \"function (options) {            if (options.name === 'NonBillablePercentage') {                switch(options.summaryProcess) {                    case 'start':                    options.totalValue = [0,0];                    break;                    case 'calculate':                    options.totalValue[0] = options.totalValue[0] + options.value.NewBusinessHours;                    options.totalValue[1] = options.totalValue[1] + options.value.Capacity;                        break;                    case 'finalize':                    if(Number(options.totalValue[1]) > 0)                    options.totalValue = (options.totalValue[0] / options.totalValue[1]);                    else                            options.totalValue = 0;                    break;                }            }            if (options.name === 'BillablePercentage') {                        switch(options.summaryProcess) {                    case 'start':                        options.totalValue = [0,0];                        break;                        case 'calculate':                        options.totalValue[0] = options.totalValue[0] + options.value.BillableHours;                        options.totalValue[1] = options.totalValue[1] + options.value.Capacity;                        break;                    case 'finalize':                        if(Number(options.totalValue[1]) > 0)                            options.totalValue = (options.totalValue[0] / options.totalValue[1]);                        else                            options.totalValue = 0;                            break;                }            }        }\",\r\n        \"totalItems\": [\r\n            {\r\n                \"name\": \"BillablePercentage\",\r\n                \"showInColumn\": \"Billable %\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"valueFormat\": {\r\n                    \"type\": \"percent\",\r\n                    \"precision\": 1\r\n                },\r\n                \"summaryType\": \"custom\",\r\n                \"alignment\": \"right\"\r\n            },\r\n            {\r\n                \"name\": \"NonBillablePercentage\",\r\n                \"showInColumn\": \"Non Billable %\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"valueFormat\": {\r\n                    \"type\": \"percent\",\r\n                    \"precision\": 1\r\n                },\r\n                \"summaryType\": \"custom\",\r\n                \"alignment\": \"right\"\r\n            },\r\n            {\r\n                \"column\": \"Capacity\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"alignment\": \"right\"\r\n            },\r\n            {\r\n                \"column\": \"Leaves\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"alignment\": \"right\"\r\n            },\r\n            {\r\n                \"column\": \"Non-Billable\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"alignment\": \"right\"\r\n            },\r\n            {\r\n                \"column\": \"Admin\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"alignment\": \"right\"\r\n            },\r\n            {\r\n                \"column\": \"Billable\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"alignment\": \"right\"\r\n            }\r\n        ],\r\n        \"groupItems\": [\r\n            {\r\n                \"name\": \"BillablePercentage\",\r\n                \"showInColumn\": \"Billable %\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"valueFormat\": {\r\n                    \"type\": \"percent\",\r\n                    \"precision\": 1\r\n                },\r\n                \"summaryType\": \"custom\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            },\r\n            {\r\n                \"name\": \"NonBillablePercentage\",\r\n                \"showInColumn\": \"Non Billable %\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"valueFormat\": {\r\n                    \"type\": \"percent\",\r\n                    \"precision\": 1\r\n                },\r\n                \"summaryType\": \"custom\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            },\r\n            {\r\n                \"column\": \"Capacity\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            },\r\n            {\r\n                \"column\": \"Leaves\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            },\r\n            {\r\n                \"column\": \"Non-Billable\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            },\r\n            {\r\n                \"column\": \"Admin\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            },\r\n            {\r\n                \"column\": \"Billable\",\r\n                \"summaryType\": \"sum\",\r\n                \"valueFormat\": \"#,##0\",\r\n                \"displayFormat\": \"{0}\",\r\n                \"showInGroupFooter\": false,\r\n                \"alignByColumn\": true\r\n            }\r\n        ]\r\n    },\r\n    \"stateStoring\": {\r\n        \"enabled\": false\r\n    }\r\n}","DashboardDefinitionId":"c5bca510-00a8-4b57-8a6d-68a7f7d75c14"}]}
