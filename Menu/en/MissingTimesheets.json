{"DashboardDefinitionRoles":[],"Id":"c0a04229-3105-4f08-8480-08dab8ed68d1","Name":"Missing Time Sheets Dashboard","Active":true,"Location":0,"DocumentId":"00000000-0000-0000-0000-000000000000","DocumentName":"","DocumentsConfiguration":null,"Templates":[],"DashboardDefinitionComponents":[{"Id":"73dc4fe4-ba6d-48d8-ac31-1f8bceb2b8b8","Name":"Timesheet Blocking Dashboard","Active":true,"UseQuery":false,"Query":null,"Size":5,"Order":3,"Parameters":"[\r\n    {\r\n        \"WidgetSubTitle\": \"Users' AD blocking log\",\r\n        \"WidgetType\": \"grid\",\r\n        \"WidgetFilterField\": \"\",\r\n        \"WidgetColor\": \"\",\r\n        \"WidgetHeight\": \"500\",\r\n        \"WidgetHeader\": {\r\n            \"showContextInfo\": false,\r\n            \"WidgetPeriodChooser\": {\r\n                \"type\": \"year\",\r\n                \"visible\": false\r\n            },\r\n            \"WidgetMetrics\": {\r\n                \"visible\": true,\r\n                \"Metrics\": [\r\n                    {\r\n                        \"visible\": true,\r\n                        \"metricName\": \"# Unblocked Users\",\r\n                        \"metricFieldValue\": \"GrandTotalUnblock\"\r\n                    },\r\n                    {\r\n                        \"visible\": true,\r\n                        \"metricName\": \"# Blocked Users\",\r\n                        \"metricFieldValue\": \"GrandTotalBlock\"\r\n                    }\r\n                ]\r\n            },\r\n            \"showSubTitle\": true,\r\n            \"showTitle\": true\r\n        },\r\n        \"WidgetDataSources\": {\r\n            \"main\": {\r\n                \"type\": \"queryText\",\r\n                \"value\": \"SELECT al.utcLogTime AS 'Date', ssu.oid as UserId, ssu.username AS 'UserName', al.OperationType, replace(al.[Description], ssu.oid, ssu.UserName) AS 'Description', al.Executed, al.Error, sum(iif(al.OperationType in ('Unblock', 'ADUnblock'),1,0)) over() as 'GrandTotalUnblock', sum(iif(al.OperationType in ('Block', 'ADBlock'),1,0)) over() as 'GrandTotalBlock' FROM assistantlog al, SecuritySystemUser ssu WHERE al.[user] = ssu.oid /*[DateFilter]*/ and al.utcLogTime >= @FromDate and al.utcLogTime <= @ToDate /*[/DateFilter]*/ ORDER BY DATE DESC\"\r\n            }\r\n        },\r\n        \"QueryConfiguration\": {\r\n            \"RequiredFilters\": [\r\n                \"startDate\",\r\n                \"endDate\"\r\n            ]\r\n        }\r\n    }\r\n]","DashboardComponentType":{"Id":"6f649e62-be82-4af7-8d64-06b32cf6c0ea","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/ADBlockerLog/execute","Configuration":"  {\n        \"height\": \"330\",\n        \"hoverStateEnabled\": \"true\",\n        \"allowSorting\": \"true\",\n        \"grouping\": {\n            \"autoExpandAll\": \"true\"\n        },\n                 \"scrolling\": {\n            \"mode\": \"infinite\"\n        },\n        \"columnAutoWidth\": \"true\",\n        \"searchPanel\": {\n            \"visible\": \"true\"\n        },\n        \"groupPanel\": {\n            \"visible\": \"true\"\n        },\n        \"export\": {\n            \"enabled\": \"true\",\n            \"fileName\": \"AssistantLog\"\n        },\n        \"sortByGroupSummaryInfo\": [\n            {\n                \"summaryItem\": \"count\"\n            }\n        ],\n        \"summary\": {\n            \"groupItems\": [\n                {\n                    \"summaryType\": \"count\",\n                    \"displayFormat\": \"{0} items\"\n                }\n            ],\n            \"totalItems\": [\n                {\n                    \"column\": \"Executed\",\n                    \"summaryType\": \"sum\",\n                    \"valueFormat\": \"#,##0\",\n                    \"displayFormat\": \"{0}\",\n                    \"alignment\": \"right\",\n                    \"cellTemplate\": \"function(e, i) {var h=e.append('<div>'+i.text+'</div>');if(i.value<0) {h.css('background-color','#f5564a').css('color','#ffffff')}}\"\n                }\n            ]\n        },\n        \"columns\": [\n\n{\n      \"allowHeaderFiltering\":false,\n      \"dataField\": \"UserId\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\",\n      \"width\": 50,\n      \"headerCellTemplate\" :\" \",\n      \"cellTemplate\": \"function(e, i) {if(i.text == '') return; var h=e.append('<div style=\\\"text-align:right\\\"><img height=\\\"16\\\" width=\\\"16\\\" style=\\\"border-radius: 40px;\\\" src=\\\"'+SkillsWorkflow.getUserImages([i.text])+'\\\" /></div>');}\"\n},       \n            {\n                \"dataField\": \"UserName\",\n                \"caption\": \"User\"\n            },\n             {\n                \"dataField\": \"OperationType\",\n                \"caption\": \"Type\",\n                \"alignment\": \"center\",\n                \"cellTemplate\": \"function(e, i) {var h=e.append('<div><span>'+i.text+'</span></div>');if(i.value=='Unblock'|| i.value=='AdUnblock') {h.children().css('background-color','#488cbf').css('color','#ffffff').css('display','inline-block').css('border-radius','2px').css('padding','3px 7px').css('font-weight','700').css('white-space','nowrap')};if(i.value== 'Block'|| i.value=='AdBlock'){h.children().css('background-color','#ffc720').css('color','#ffffff').css('display','inline-block').css('border-radius','2px').css('padding','3px 7px').css('font-weight','700').css('white-space','nowrap')};}\"\n            },\n            {\n                \"dataField\": \"Date\",\n                \"caption\": \"Date\",\n                \"dataType\": \"date\",\n                \"format\": \"dd/MM/yyyy HH:mm:ss\",\n                \"sortOrder\": \"desc\"\n            },\n            {\n                \"dataField\": \"Executed\",\n                \"caption\": \"Executed\"\n            }\n        ]\n    }","DashboardDefinitionId":"c0a04229-3105-4f08-8480-08dab8ed68d1"},{"Id":"97a1ea02-4a56-4127-b355-23e4c231b9f8","Name":"Select the desired range","Active":true,"UseQuery":false,"Query":null,"Size":12,"Order":4,"Parameters":"[\r\n    {\r\n        \"WidgetSubTitle\": \"Blocked and unblocked users\",\r\n        \"WidgetType\": \"rangeSelector\",\r\n        \"WidgetFilterField\": \"\",\r\n        \"WidgetColor\": \"#e0e0e0\",\r\n        \"WidgetHeight\": \"500\",\r\n        \"WidgetHeader\": {\r\n            \"showContextInfo\": false,\r\n            \"WidgetPeriodChooser\": {\r\n                \"startDate\": \"2019/04/01\",\r\n                \"endDate\": \"2019/08/30\",\r\n                \"type\": \"year\",\r\n                \"visible\": false\r\n            },\r\n            \"showSubTitle\": true,\r\n            \"showTitle\": true\r\n        },\r\n        \"WidgetDataSources\": {\r\n            \"main\": {\r\n                \"type\": \"queryText\",\r\n                \"value\": \"SELECT max(al.utcLogTime) AS 'Date', sum(iif(al.OperationType in ('Unblock', 'ADUnblock'), 1, 0)) as 'Unblock', sum(iif(al.OperationType in ('Block', 'ADBlock'), 1, 0)) as 'Block' FROM      AssistantLog al GROUP BY   datepart(yyyy, al.utcLogTime), datepart(mm, al.utcLogTime), datepart(dd, al.utcLogTime)\"\r\n            }\r\n        },\r\n        \"QueryConfiguration\": null\r\n    }\r\n]","DashboardComponentType":{"Id":"6f649e62-be82-4af7-8d64-06b32cf6c0ea","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/ADBlockerLogsCount/execute","Configuration":"{\n    \"height\": \"250\",\n    \"containerBackgroundColor\": \"#e0e0e0\",\n    \"selectedRangeColor\": \"#f5564a\",\n    \"chart\": {\n        \"commonSeriesSettings\": {\n            \"type\": \"steparea\",\n            \"argumentField\": \"Date\"\n        },\n        \"series\": [\n            {\n                \"valueField\": \"Unblock\"\n            },\n            {\n                \"valueField\": \"Block\"\n            }\n        ]\n    },\n    \"scale\": {\n        \"minorTickInterval\": \"day\",\n        \"tickInterval\": \"day\",\n        \"valueType\": \"datetime\"\n    },\n    \"sliderMarker\": {\n        \"format\": \"monthAndDay\",\n        \"color\": \"#da5859\"\n    },\n    \"value\": [\n        \"2019/05/28\",\n        \"2019/12/31\"\n    ]\n}","DashboardDefinitionId":"c0a04229-3105-4f08-8480-08dab8ed68d1"},{"Id":"9b7e8c41-fcd0-4f1a-bc6d-5eecf69dfae4","Name":"Users Missing Timesheets","Active":true,"UseQuery":false,"Query":null,"Size":7,"Order":2,"Parameters":"[\r\n    {\r\n        \"WidgetSubTitle\": \"Users' missing timesheets and AD status\",\r\n        \"WidgetType\": \"grid\",\r\n        \"WidgetFilterField\": \"\",\r\n        \"WidgetColor\": \"\",\r\n        \"WidgetHeight\": \"500\",\r\n        \"WidgetHeader\": {\r\n            \"showContextInfo\": false,\r\n            \"WidgetPeriodChooser\": {\r\n                \"type\": \"year\",\r\n                \"visible\": false\r\n            },\r\n            \"WidgetMetrics\": {\r\n                \"visible\": true,\r\n                \"Metrics\": [\r\n                    {\r\n                        \"visible\": true,\r\n                        \"metricName\": \"# Users missing hours\",\r\n                        \"metricFieldValue\": \"GrandTotalUsersMissingHours\"\r\n                    },\r\n                    {\r\n                        \"visible\": true,\r\n                        \"metricName\": \"# Missing hours\",\r\n                        \"metricFieldValue\": \"GrandTotalMissingHours\"\r\n                    }\r\n                ]\r\n            },\r\n            \"showSubTitle\": true,\r\n            \"showTitle\": true\r\n        },\r\n        \"WidgetDataSources\": {\r\n            \"main\": {\r\n                \"type\": \"queryText\",\r\n                \"value\": \"select t.UserId, ssu.UserName, u.AdUserName, u.TimesheetRequired , u.HasToFillTimesheets , u.IsBlockedInAd, ssu.IsActive, t.MissingDays, t.MissingHours, sum(t.MissingHours) over() as 'GrandTotalMissingHours', count(ssu.UserName) over() as 'GrandTotalUsersMissingHours' from ( select v.UserId, Name, Company, STRING_AGG(CONVERT(VARCHAR(10), Day, 111) , ', ') within group (order by Day asc) as MissingDays, round(sum(MissingHours), 2) as MissingHours from SkillTimesheetMissingReport v with(NOLOCK), UserUsers_CompanyCompanies uc with(NOLOCK) where   uc.Users = @CurrentUserId and uc.Companies = v.CompanyId group by v.UserId, v.Name, v.Company union all select v.UserId, Name, Company, STRING_AGG(CONVERT(VARCHAR(10), Day, 111) , ', ') within group (order by Day asc) as MissingDays, round(sum(MissingHours), 2) as MissingHours from SkillWeeklyTimesheetMissingReport v with(NOLOCK), UserUsers_CompanyCompanies uc with(NOLOCK) where   uc.Users = @CurrentUserId and uc.Companies = v.CompanyId group by v.UserId, v.Name, v.Company ) t, [User] u, SecuritySystemUser ssu where  u.Oid = ssu.Oid order by MissingDays desc\"\r\n            }\r\n        },\r\n        \"QueryConfiguration\": {}\r\n    }\r\n]","DashboardComponentType":{"Id":"6f649e62-be82-4af7-8d64-06b32cf6c0ea","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/ADBlockerTimesheetDashboard/execute","Configuration":"{\n\"height\": \"330\",\n        \"hoverStateEnabled\": \"true\",\n        \"allowSorting\": \"true\",\n        \"grouping\": {\n            \"autoExpandAll\": \"true\"\n        },\n        \"columnAutoWidth\": \"true\",\n        \"searchPanel\": {\n            \"visible\": \"true\"\n        },\n        \"scrolling\": {\n            \"mode\": \"infinite\"\n        },\n        \"groupPanel\": {\n            \"visible\": \"true\"\n        },\n        \"export\": {\n            \"enabled\": \"true\",\n            \"fileName\": \"AssistantLog\"\n           },\n        \"sortByGroupSummaryInfo\": [\n            {\n                \"summaryItem\": \"count\"\n            }\n        ],\n        \"allowColumnResizing\": true,\n         \"summary\": {\n            \"groupItems\": [\n                {\n                    \"summaryType\": \"count\",\n                    \"displayFormat\": \"{0} items\"\n                }\n            ],\n            \"totalItems\": [\n                {\n                    \"column\": \"MissingHours\",\n                    \"summaryType\": \"sum\",\n                    \"valueFormat\": \"#,##0\",\n                    \"displayFormat\": \"{0}\",\n                    \"alignment\": \"right\",\n                    \"cellTemplate\": \"function(e, i) {var h=e.append('<div>'+i.text+'</div>');if(i.value<0) {h.css('background-color','#f5564a').css('color','#ffffff')}}\"\n                }\n            ]\n        },\n    \"columns\": [{\n      \"allowHeaderFiltering\":false,\n      \"dataField\": \"UserId\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\",\n      \"width\": 10,\n      \"headerCellTemplate\" :\" \",\n      \"cellTemplate\": \"function(e, i) {if(i.text == '') return; var h=e.append('<div style=\\\"text-align:right\\\"><img height=\\\"16\\\" width=\\\"16\\\" style=\\\"border-radius: 40px;\\\" src=\\\"'+SkillsWorkflow.getUserImages([i.text])+'\\\" /></div>');}\"\n},        \n{\n            \"dataField\": \"UserName\",\n            \"caption\": \"Username\"\n        },\n        {\n            \"dataField\": \"AdUserName\",\n            \"caption\": \"Ad Username\"\n        },\n        {\n            \"dataField\": \"TimesheetRequired\",\n            \"caption\": \"Timesheet Required\",\n            \"visible\":\"false\"\n        },\n        {\n            \"dataField\": \"HasToFillTimesheets\",\n            \"caption\": \"Blocked in Skills\"\n        },\n        {\n            \"dataField\": \"IsBlockedInAd\",\n            \"caption\": \"Blocked In Ad\"\n        },\n        {\n            \"dataField\": \"MissingHours\",\n            \"caption\": \"? Missing Hours\"\n        },\n        {\n            \"alignment\":\"center\",\n            \"caption\": \"Missing Days\",\n            \"dataField\":\"MissingDays\",\n            \"cellTemplate\": \"function(container, options) { container.append('<div data-id=\\\"' + options.data.MissingDays + '\\\" \nonClick=alert(this.attributes[\\\"data-id\\\"].value); class=\\\"dx-button dx-button-normal dx-button-mode-contained dx-widget dx-button-has-text\\\" role=\\\"button\\\"> <div class=\\\"dx-button-content\\\"><span class=\\\"dx-button-text\\\">View</span></div></div>');}\"\n        }\n \n   ]\n}","DashboardDefinitionId":"c0a04229-3105-4f08-8480-08dab8ed68d1"}]}