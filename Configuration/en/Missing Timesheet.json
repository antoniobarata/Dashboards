{"DashboardDefinitionRoles":[{"AccessRoleId":"0e42c6ba-e4fb-4ff6-9c37-a300da73a0e5","DashboardDefinitionId":"40e850fe-962e-4cef-a758-9b2af3b05924","AccessRoleName":"Administrator"}],"Id":"40e850fe-962e-4cef-a758-9b2af3b05924","Name":"Missing Timesheet","Active":true,"Location":2,"DocumentId":"00000000-0000-0000-0000-000000000000","DocumentName":"","DocumentsConfiguration":"{\"entity\":\"\",\"operations\":{\"read\":{\"endpoint\":\"\"},\"update\":{\"endpoint\":\"\",\"model\":{}},\"create\":{\"endpoint\":\"\",\"model\":{}},\"patch\":{\"endpoint\":\"\",\"model\":[{\"field\":\"\",\"caption\":\"\",\"type\":\"\"}]},\"remove\":{\"endpoint\":\"\"},\"lookup\":{\"endpoint\":\"\"},\"lookupById\":{\"endpoint\":\"\"}},\"layout\":{\"create\":{},\"read\":{},\"patch\":{}},\"customDocument\":{\"useCustomStyle\":false,\"mainColor\":\"\",\"secondaryColor\":\"\",\"imageClass\":\"\",\"namePlural\":\"\",\"name\":\"\",\"systemName\":\"\"},\"availableOptions\":{\"feed\":false,\"info\":true,\"files\":false,\"userfields\":false,\"dashboard\":false}}","Templates":[],"DashboardDefinitionComponents":[{"Id":"1c1ecf3c-9600-4050-843c-0e2fd3e4c026","Name":"Select the desired range","Active":true,"UseQuery":false,"Query":null,"Size":12,"Order":4,"Parameters":"[{\"WidgetSubTitle\":\"Blocked and unblocked users\",\"WidgetType\":\"rangeselector\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"#e0e0e0\",\"WidgetHeight\":\"500\",\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"startDate\":\"2019/04/01\",\"endDate\":\"2019/08/30\",\"type\":\"year\",\"visible\":false},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"SELECT    max(al.utcLogTime) AS 'Date', \\n          sum(iif(al.OperationType in ('Unblock', 'ADUnblock'), 1, 0)) as 'Unblock',\\n          sum(iif(al.OperationType in ('Block', 'ADBlock'), 1, 0)) as 'Block'\\nFROM      AssistantLog al\\nGROUP BY   datepart(yyyy, al.utcLogTime), datepart(mm, al.utcLogTime), datepart(dd, al.utcLogTime)\"}},\"Filters\":{},\"QueryConfiguration\":{\"PreviousPeriod\":{\"Show\":false,\"KeyFieldName\":\"\",\"Type\":0},\"RequiredFilters\":[]}}]","DashboardComponentType":{"Id":"a4dd0131-76a0-4d78-89c5-ebe0e59d8878","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/ADBlockerLogsCount/execute","Configuration":"{\n    \"onDrawn\": \"function(s) {      \n        var yesterday = new Date();  \n        var today = new Date();\n        yesterday.setDate(today.getDate()-1);\n\n        yesterday.setHours(0,\n    0,\n    0,\n    0);      \n        today.setHours(23,\n    59,\n    59,\n    0);      \n        s.component.option('value',\n    [yesterday, today\n    ]);\n}\",\n    \"onDisposing\": \"function (e,c) {debugger; var test=new Date();};\",\n\"height\": \"250\",\n\"containerBackgroundColor\": \"#e0e0e0\",\n\"selectedRangeColor\": \"#f5564a\",\n\"chart\": {\n    \"commonSeriesSettings\": {\n        \"type\": \"steparea\",\n        \"argumentField\": \"Date\"\n    },\n    \"series\": [\n        {\n            \"valueField\": \"Unblock\"\n        },\n        {\n            \"valueField\": \"Block\"\n        }\n    ]\n},\n\"scale\": {\n    \"minorTickInterval\": \"day\",\n    \"tickInterval\": \"day\",\n    \"valueType\": \"datetime\"\n},\n\"sliderMarker\": {\n    \"format\": \"monthAndDay\",\n    \"color\": \"#da5859\"\n},\n\"value\": [\n    \"2019/05/13\",\n    \"2019/05/20\"\n]\n}","DashboardDefinitionId":"40e850fe-962e-4cef-a758-9b2af3b05924"},{"Id":"fd1315ea-bd88-4473-b984-368244c2b227","Name":"Timesheet Blocking Dashboard","Active":true,"UseQuery":false,"Query":null,"Size":5,"Order":3,"Parameters":"[{\"WidgetSubTitle\":\"Users' AD blocking log\",\"WidgetType\":\"grid\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"\",\"WidgetHeight\":\"\",\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":true,\"Metrics\":[{\"visible\":true,\"metricName\":\"? Unblocked Users\",\"metricFieldValue\":\"GrandTotalUnblock\"},{\"visible\":true,\"metricName\":\"? Blocked Users\",\"metricFieldValue\":\"GrandTotalBlock\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"SELECT al.utcLogTime AS 'Date',\\n    ssu.oid as UserId,\\n    ssu.username AS 'UserName',\\n    al.OperationType,\\n    case \\n        when al.OperationType in ('Block') then 'Blocked'\\n        when al.OperationType in ('Unblock') then 'Unblocked'\\n        end as [Type],\\n    replace(al.[Description], ssu.oid, ssu.UserName) AS 'Description',\\n    al.Executed,\\n    al.Error,\\n    sum(iif(al.OperationType in ('Unblock'),1,0)) over() as 'GrandTotalUnblock',\\n    sum(iif(al.OperationType in ('Block'),1,0)) over() as 'GrandTotalBlock'\\nFROM assistantlog al,\\n    SecuritySystemUser ssu\\n    WHERE \\n    al.[user] = ssu.oid and\\n        ssu.username not in ('Internal Process', 'Support') and\\n    al.OperationType in ('Unblock','Block')\\n    /*[DateFilter]*/ and al.utcLogTime >= @FromDate and al.utcLogTime <= @ToDate /*[/DateFilter]*/\\nORDER BY DATE DESC\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{\"RequiredFilters\":[\"startDate\",\"endDate\"]}}]","DashboardComponentType":{"Id":"a4dd0131-76a0-4d78-89c5-ebe0e59d8878","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/ADBlockerLog/execute","Configuration":"  {\n        \"height\": \"330\",\n        \"hoverStateEnabled\": \"true\",\n        \"allowSorting\": \"true\",\n        \"grouping\": {\n            \"autoExpandAll\": \"true\"\n        },\n                 \"scrolling\": {\n            \"mode\": \"infinite\"\n        },\n        \"columnAutoWidth\": \"true\",\n        \"searchPanel\": {\n            \"visible\": \"true\"\n        },\n        \"groupPanel\": {\n            \"visible\": \"true\"\n        },\n        \"export\": {\n            \"enabled\": \"true\",\n            \"fileName\": \"AssistantLog\"\n        },\n        \"sortByGroupSummaryInfo\": [\n            {\n                \"summaryItem\": \"count\"\n            }\n        ],\n        \"summary\": {\n            \"groupItems\": [\n                {\n                    \"summaryType\": \"count\",\n                    \"displayFormat\": \"{0} items\"\n                }\n            ],\n            \"totalItems\": [\n                {\n                    \"column\": \"Executed\",\n                    \"summaryType\": \"sum\",\n                    \"valueFormat\": \"#,##0\",\n                    \"displayFormat\": \"{0}\",\n                    \"alignment\": \"right\",\n                    \"cellTemplate\": \"function(e, i) {var h=e.append('<div>'+i.text+'</div>');if(i.value<0) {h.css('background-color','#f5564a').css('color','#ffffff')}}\"\n                }\n            ]\n        },\n        \"columns\": [\n\n\n{\n      \"allowHeaderFiltering\":false,\n      \"dataField\": \"UserId\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\",\n      \"width\": 50,\n      \"headerCellTemplate\" :\" \",\n      \"cellTemplate\": \"function(e, i) {if(i.text == '') return; \n          \n                var h = document.createElement('DIV'); \n                    e.appendChild(h);\n                    h.style['text-align'] = 'center'; \n                    var img = document.createElement('img'); \n                    h.appendChild(img);\n                    img.src = SkillsWorkflow.getUserImages([i.text]);\n                    img.style['border-radius'] = '40px'; \n                    img.height='16';\n                    img.width='16';}\"\n},       \n            {\n                \"dataField\": \"UserName\",\n                \"caption\": \"User\"\n            },\n             {\n                \"alignment\":\"center\",\n                \"dataField\": \"Type\",\n                \"caption\": \"Type\",\n                \"alignment\": \"center\",\n                \"cellTemplate\": \"function(e, i) {\ndebugger;\n                    var h = document.createElement('DIV'); \n                    e.appendChild(h);\n                    var span = document.createElement('span'); \n                    h.appendChild(span);\n                    span.innerHTML = i.text; \n                    span.classList.add('dx-button-mode-contained');\n                    span.setAttribute('style',' color: #ffffff; display : inline-block ; border-radius : 2px ; padding: 3px 7px; font-weight: 700; white-space : nowrap');\n                    if(i.value=='Unblocked'|| i.value=='ADUnblocked') {\n                        span.style['background-color']=' #488cbf';\n                        }\n                     if(i.value=='Blocked'|| i.value=='ADBlocked') {\n                        span.style['background-color']=' #da5859';\n                    }\n;}\"\n            },\n            {\n                \"dataField\": \"Date\",\n                \"caption\": \"Date\",\n                \"dataType\": \"date\",\n                \"format\": \"dd/MM/yyyy HH:mm:ss\",\n                \"sortOrder\": \"desc\"\n            },\n            {\n                \"dataField\": \"Executed\",\n                \"caption\": \"Executed\"\n            }\n        ]\n    }","DashboardDefinitionId":"40e850fe-962e-4cef-a758-9b2af3b05924"},{"Id":"91086c5a-e98b-4ad0-bab8-855053e21164","Name":"Users Missing Timesheets","Active":true,"UseQuery":false,"Query":null,"Size":7,"Order":2,"Parameters":"[{\"WidgetSubTitle\":\"Users' missing timesheets and AD status\",\"WidgetType\":\"grid\",\"WidgetFilterField\":\"\",\"WidgetColor\":\"\",\"WidgetHeight\":\"500\",\"WidgetHeader\":{\"showContextInfo\":false,\"WidgetPeriodChooser\":{\"type\":\"year\",\"visible\":false},\"WidgetMetrics\":{\"visible\":true,\"Metrics\":[{\"visible\":true,\"metricName\":\"? Users missing hours\",\"metricFieldValue\":\"GrandTotalUsersMissingHours\"},{\"visible\":true,\"metricName\":\"? Missing hours\",\"metricFieldValue\":\"GrandTotalMissingHours\"}]},\"showSubTitle\":true,\"showTitle\":true},\"WidgetDataSources\":{\"main\":{\"type\":\"querytext\",\"value\":\"select t.UserId,\\n    ssu.UserName, \\n    u.AdUserName, \\n    u.TimesheetRequired , \\n    u.HasToFillTimesheets , \\n    u.IsBlockedInAd, \\n    ssu.IsActive, \\n\\tt.MissingDays,\\n\\tt.MissingHours,\\nsum(t.MissingHours) over() as 'GrandTotalMissingHours',\\ncount(ssu.UserName) over() as 'GrandTotalUsersMissingHours'\\nfrom\\n    (   \\n          select\\n            v.UserId,\\n            Name,\\n            Company,\\n            --cast(MissingHours as float) as MissingHours,\\n\\t\\t\\tSTRING_AGG(CONVERT(VARCHAR(10), Day, 111) , ', ') within group (order by Day asc) as MissingDays,\\n\\t\\t\\tround(sum(MissingHours), 2) as MissingHours\\n        from SkillTimesheetMissingReport v with(NOLOCK), UserUsers_CompanyCompanies uc with(NOLOCK)\\n        where   uc.Users = @CurrentUserId\\n           and uc.Companies = v.CompanyId\\n\\t\\tgroup by v.UserId, v.Name, v.Company\\n         -- and ( v.ResponsibleId = @CurrentUserId or v.UserId = @CurrentUserId)\\n\\n         union all\\n      \\n          select\\n            v.UserId,\\n            Name,\\n            Company,\\n            --cast(MissingHours as float) as MissingHours,\\n\\t\\t\\tSTRING_AGG(CONVERT(VARCHAR(10), Day, 111) , ', ') within group (order by Day asc) as MissingDays,\\n\\t\\t\\tround(sum(MissingHours), 2) as MissingHours\\n        from SkillWeeklyTimesheetMissingReport v with(NOLOCK), UserUsers_CompanyCompanies uc with(NOLOCK)\\n        where   uc.Users = @CurrentUserId\\n           and uc.Companies = v.CompanyId\\n\\t\\tgroup by v.UserId, v.Name, v.Company\\n         -- and ( v.ResponsibleId = @CurrentUserId or v.UserId = @CurrentUserId)\\n\\n    ) t, [User] u, SecuritySystemUser ssu\\nwhere  u.Oid = ssu.Oid \\n   --and u.IsBlockedInAd = 1 \\n   -- and u.HasToFillTimesheets = 1\\n    --and u.TimesheetRequired = 1 \\n   and t.UserId = u.Oid \\n   -- and t.UserId = ssu.Oid\\n--group by t.UserId, t.Name, ssu.UserName, u.AdUserName, u.TimesheetRequired , u.HasToFillTimesheets , u.IsBlockedInAd, ssu.IsActive\\norder by MissingDays desc\",\"mapping\":\"\"}},\"Filters\":{},\"QueryConfiguration\":{}}]","DashboardComponentType":{"Id":"a4dd0131-76a0-4d78-89c5-ebe0e59d8878","Name":"Generic Dashboard","ComponentTypeNumber":42},"AnalyticsApiUrl":"globalQuery/ADBlockerTimesheetDashboard/execute","Configuration":"{\n\"height\": \"330\",\n        \"hoverStateEnabled\": \"true\",\n        \"allowSorting\": \"true\",\n        \"grouping\": {\n            \"autoExpandAll\": \"true\"\n        },\n        \"columnAutoWidth\": \"true\",\n        \"searchPanel\": {\n            \"visible\": \"true\"\n        },\n        \"scrolling\": {\n            \"mode\": \"infinite\"\n        },\n        \"groupPanel\": {\n            \"visible\": \"true\"\n        },\n        \"export\": {\n            \"enabled\": \"true\",\n            \"fileName\": \"AssistantLog\"\n           },\n        \"sortByGroupSummaryInfo\": [\n            {\n                \"summaryItem\": \"count\"\n            }\n        ],\n        \"allowColumnResizing\": true,\n         \"summary\": {\n            \"groupItems\": [\n                {\n                    \"summaryType\": \"count\",\n                    \"displayFormat\": \"{0} items\"\n                }\n            ],\n            \"totalItems\": [\n                {\n                    \"column\": \"MissingHours\",\n                    \"summaryType\": \"sum\",\n                    \"valueFormat\": \"#,##0\",\n                    \"displayFormat\": \"{0}\",\n                    \"alignment\": \"right\",\n                    \"cellTemplate\": \"function(e, i) {var h=e.append('<div>'+i.text+'</div>');if(i.value<0) {h.css('background-color','#f5564a').css('color','#ffffff')}}\"\n                }\n            ]\n        },\n    \"columns\": [{\n      \"allowHeaderFiltering\":false,\n      \"dataField\": \"UserId\",\n      \"alignment\": \"right\",\n      \"format\": \"#,##0\",\n      \"width\": 10,\n      \"headerCellTemplate\" :\" \",\n\"cellTemplate\": \"function(e, i) {  if(i.text == '') return; \n          \n                var h = document.createElement('DIV'); \n                    e.appendChild(h);\n                    h.style['text-align'] = 'center'; \n                    var img = document.createElement('img'); \n                    h.appendChild(img);\n                    img.src = SkillsWorkflow.getUserImages([i.text]);\n                    img.style['border-radius'] = '40px'; \n                    img.height='16';\n                    img.width='16';}\"\n},        \n{\n            \"dataField\": \"UserName\",\n            \"caption\": \"Username\"\n        },\n        {\n            \"dataField\": \"AdUserName\",\n            \"caption\": \"Ad Username\"\n        },\n        {\n            \"dataField\": \"TimesheetRequired\",\n            \"caption\": \"Timesheet Required\",\n            \"visible\":\"false\"\n        },\n        {\n            \"dataField\": \"HasToFillTimesheets\",\n            \"caption\": \"Blocked in Skills\"\n        },\n        {\n            \"dataField\": \"IsBlockedInAd\",\n            \"caption\": \"Blocked In Ad\"\n        },\n        {\n            \"dataField\": \"MissingHours\",\n            \"caption\": \"? Missing Hours\"\n        },\n        {\n            \"alignment\":\"center\",\n            \"caption\": \"Missing Days\",\n            \"dataField\":\"MissingDays\",\n            \"cellTemplate\": \"function(container, options) { var h = document.createElement('DIV'); \n                container.appendChild(h);\n                h.dataset['id'] = options.data.MissingDays;\n                h.onclick = function(e) {alert(this.attributes['data-id'].value)};\n                h.setAttribute('class', 'dx-button dx-button-normal dx-button-mode-contained dx-widget dx-button-has-text');\n                var h1 = document.createElement('DIV'); \n                h.appendChild(h1);\n                h1.classList.add('dx-button-content');\n                var span = document.createElement('span'); \n                h1.appendChild(span);\n                span.classList.add('dx-button-text');\n                span.innerHTML = 'View'; debugger;}\"\n        }\n \n   ]\n}","DashboardDefinitionId":"40e850fe-962e-4cef-a758-9b2af3b05924"}]}